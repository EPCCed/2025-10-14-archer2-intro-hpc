<!DOCTYPE html>
<!-- START: inst/pkgdown/templates/layout.html --><!-- Generated by pkgdown: do not edit by hand --><html lang="en" data-bs-theme="auto">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<title>ARCHER2 Introduction to HPC: All in One View</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<script src="assets/themetoggle.js"></script><link rel="stylesheet" type="text/css" href="assets/styles.css">
<script src="assets/scripts.js" type="text/javascript"></script><!-- mathjax --><script type="text/x-mathjax-config">
    MathJax.Hub.Config({
      config: ["MMLorHTML.js"],
      jax: ["input/TeX","input/MathML","output/HTML-CSS","output/NativeMML", "output/PreviewHTML"],
      extensions: ["tex2jax.js","mml2jax.js","MathMenu.js","MathZoom.js", "fast-preview.js", "AssistiveMML.js", "a11y/accessibility-menu.js"],
      TeX: {
        extensions: ["AMSmath.js","AMSsymbols.js","noErrors.js","noUndefined.js"]
      },
      tex2jax: {
        inlineMath: [['\\(', '\\)']],
        displayMath: [ ['$$','$$'], ['\\[', '\\]'] ],
        processEscapes: true
      }
    });
    </script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><!-- Responsive Favicon for The Carpentries --><link rel="apple-touch-icon" sizes="180x180" href="favicons/incubator/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="favicons/incubator/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="favicons/incubator/favicon-16x16.png">
<link rel="manifest" href="favicons/incubator/site.webmanifest">
<link rel="mask-icon" href="favicons/incubator/safari-pinned-tab.svg" color="#5bbad5">
<meta name="msapplication-TileColor" content="#da532c">
<meta name="theme-color" media="(prefers-color-scheme: light)" content="white">
<meta name="theme-color" media="(prefers-color-scheme: dark)" content="black">
</head>
<body>
    <header id="top" class="navbar navbar-expand-md top-nav incubator"><svg xmlns="http://www.w3.org/2000/svg" class="d-none"><symbol id="check2" viewbox="0 0 16 16"><path d="M13.854 3.646a.5.5 0 0 1 0 .708l-7 7a.5.5 0 0 1-.708 0l-3.5-3.5a.5.5 0 1 1 .708-.708L6.5 10.293l6.646-6.647a.5.5 0 0 1 .708 0z"></path></symbol><symbol id="circle-half" viewbox="0 0 16 16"><path d="M8 15A7 7 0 1 0 8 1v14zm0 1A8 8 0 1 1 8 0a8 8 0 0 1 0 16z"></path></symbol><symbol id="moon-stars-fill" viewbox="0 0 16 16"><path d="M6 .278a.768.768 0 0 1 .08.858 7.208 7.208 0 0 0-.878 3.46c0 4.021 3.278 7.277 7.318 7.277.527 0 1.04-.055 1.533-.16a.787.787 0 0 1 .81.316.733.733 0 0 1-.031.893A8.349 8.349 0 0 1 8.344 16C3.734 16 0 12.286 0 7.71 0 4.266 2.114 1.312 5.124.06A.752.752 0 0 1 6 .278z"></path><path d="M10.794 3.148a.217.217 0 0 1 .412 0l.387 1.162c.173.518.579.924 1.097 1.097l1.162.387a.217.217 0 0 1 0 .412l-1.162.387a1.734 1.734 0 0 0-1.097 1.097l-.387 1.162a.217.217 0 0 1-.412 0l-.387-1.162A1.734 1.734 0 0 0 9.31 6.593l-1.162-.387a.217.217 0 0 1 0-.412l1.162-.387a1.734 1.734 0 0 0 1.097-1.097l.387-1.162zM13.863.099a.145.145 0 0 1 .274 0l.258.774c.115.346.386.617.732.732l.774.258a.145.145 0 0 1 0 .274l-.774.258a1.156 1.156 0 0 0-.732.732l-.258.774a.145.145 0 0 1-.274 0l-.258-.774a1.156 1.156 0 0 0-.732-.732l-.774-.258a.145.145 0 0 1 0-.274l.774-.258c.346-.115.617-.386.732-.732L13.863.1z"></path></symbol><symbol id="sun-fill" viewbox="0 0 16 16"><path d="M8 12a4 4 0 1 0 0-8 4 4 0 0 0 0 8zM8 0a.5.5 0 0 1 .5.5v2a.5.5 0 0 1-1 0v-2A.5.5 0 0 1 8 0zm0 13a.5.5 0 0 1 .5.5v2a.5.5 0 0 1-1 0v-2A.5.5 0 0 1 8 13zm8-5a.5.5 0 0 1-.5.5h-2a.5.5 0 0 1 0-1h2a.5.5 0 0 1 .5.5zM3 8a.5.5 0 0 1-.5.5h-2a.5.5 0 0 1 0-1h2A.5.5 0 0 1 3 8zm10.657-5.657a.5.5 0 0 1 0 .707l-1.414 1.415a.5.5 0 1 1-.707-.708l1.414-1.414a.5.5 0 0 1 .707 0zm-9.193 9.193a.5.5 0 0 1 0 .707L3.05 13.657a.5.5 0 0 1-.707-.707l1.414-1.414a.5.5 0 0 1 .707 0zm9.193 2.121a.5.5 0 0 1-.707 0l-1.414-1.414a.5.5 0 0 1 .707-.707l1.414 1.414a.5.5 0 0 1 0 .707zM4.464 4.465a.5.5 0 0 1-.707 0L2.343 3.05a.5.5 0 1 1 .707-.707l1.414 1.414a.5.5 0 0 1 0 .708z"></path></symbol></svg><a class="visually-hidden-focusable skip-link" href="#main-content">Skip to main content</a>
  <div class="container-fluid top-nav-container">
    <div class="col-md-8">
      <div class="large-logo">
        <img id="incubator-logo" alt="Carpentries Incubator" src="assets/images/incubator-logo.svg"><span class="badge text-bg-info">
          <abbr title="This lesson is in the beta phase, which means that it is ready for teaching by instructors outside of the original author team.">
            <a href="https://docs.carpentries.org/resources/curriculum/lesson-life-cycle.html" class="external-link alert-link">
              <i aria-hidden="true" class="icon" data-feather="alert-circle" style="border-radius: 5px"></i>
              Beta
            </a>
            <span class="visually-hidden">This lesson is in the beta phase, which means that it is ready for teaching by instructors outside of the original author team.</span>
          </abbr>
        </span>

      </div>
    </div>
    <div class="selector-container">
      <div id="theme-selector">
        <li class="nav-item dropdown" id="theme-button-list">
          <button class="btn btn-link nav-link px-0 px-lg-2 dropdown-toggle d-flex align-items-center" id="bd-theme" type="button" aria-expanded="false" data-bs-toggle="dropdown" data-bs-display="static" aria-label="Toggle theme (auto)">
            <svg class="bi my-1 theme-icon-active"><use href="#circle-half"></use></svg><i data-feather="chevron-down"></i>
          </button>
          <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="bd-theme-text">
<li>
              <button type="button" class="btn dropdown-item d-flex align-items-center" data-bs-theme-value="light" aria-pressed="false">
                <svg class="bi me-2 theme-icon"><use href="#sun-fill"></use></svg>
                Light
                <svg class="bi ms-auto d-none"><use href="#check2"></use></svg></button>
            </li>
            <li>
              <button type="button" class="btn dropdown-item d-flex align-items-center" data-bs-theme-value="dark" aria-pressed="false">
                <svg class="bi me-2 theme-icon"><use href="#moon-stars-fill"></use></svg>
                Dark
                <svg class="bi ms-auto d-none"><use href="#check2"></use></svg></button>
            </li>
            <li>
              <button type="button" class="btn dropdown-item d-flex align-items-center active" data-bs-theme-value="auto" aria-pressed="true">
                <svg class="bi me-2 theme-icon"><use href="#circle-half"></use></svg>
                Auto
                <svg class="bi ms-auto d-none"><use href="#check2"></use></svg></button>
            </li>
          </ul>
</li>
      </div>

      <div class="dropdown" id="instructor-dropdown">
        <button class="btn btn-secondary dropdown-toggle bordered-button" type="button" id="dropdownMenu1" data-bs-toggle="dropdown" aria-expanded="false">
          <i aria-hidden="true" class="icon" data-feather="eye"></i> Learner View <i data-feather="chevron-down"></i>
        </button>
        <ul class="dropdown-menu" aria-labelledby="dropdownMenu1">
<li><button class="dropdown-item" type="button" onclick="window.location.href='instructor/aio.html';">Instructor View</button></li>
        </ul>
</div>
    </div>
  </div>
  <hr></header><nav class="navbar navbar-expand-xl bottom-nav incubator" aria-label="Main Navigation"><div class="container-fluid nav-container">
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle Navigation">
      <span class="navbar-toggler-icon"></span>
      <span class="menu-title">Menu</span>
    </button>
    <div class="nav-logo">
      <img class="small-logo" alt="Carpentries Incubator" src="assets/images/incubator-logo-sm.svg">
</div>
    <div class="lesson-title-md">
      ARCHER2 Introduction to HPC
    </div>
    <div class="search-icon-sm">
      <!-- TODO: do not show until we have search
        <i role="img" aria-label="Search the All In One page" data-feather="search"></i>
      -->
    </div>
    <div class="desktop-nav">
      <ul class="navbar-nav me-auto mb-2 mb-lg-0">
<li class="nav-item">
          <span class="lesson-title">
            ARCHER2 Introduction to HPC
          </span>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="key-points.html">Key Points</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="reference.html#glossary">Glossary</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="profiles.html">Learner Profiles</a>
        </li>
        <li class="nav-item dropdown">
          <button class="nav-link dropdown-toggle" id="navbarDropdown" data-bs-toggle="dropdown" aria-expanded="false">
            More <i data-feather="chevron-down"></i>
          </button>
          <ul class="dropdown-menu" aria-labelledby="navbarDropdown">
<li><a class="dropdown-item" href="reference.html">Glossary</a></li>
          </ul>
</li>
      </ul>
</div>
    <!--
    <form class="d-flex col-md-2 search-form">
      <fieldset disabled>
      <input class="form-control me-2 searchbox" type="search" placeholder="" aria-label="">
        <button class="btn btn-outline-success tablet-search-button"  type="submit">
          <i class="search-icon" data-feather="search" role="img" aria-label="Search the All In One page"></i>
        </button>
      </fieldset>
    </form>
    -->
    <a id="search-button" class="btn btn-primary" href="aio.html" role="button" aria-label="Search the All In One page">Search the All In One page</a>
  </div>
<!--/div.container-fluid -->
</nav><div class="col-md-12 mobile-title">
  ARCHER2 Introduction to HPC
</div>

<aside class="col-md-12 lesson-progress"><div style="width: %" class="percentage">
    %
  </div>
  <div class="progress incubator">
    <div class="progress-bar incubator" role="progressbar" style="width: %" aria-valuenow="" aria-label="Lesson Progress" aria-valuemin="0" aria-valuemax="100">
    </div>
  </div>
</aside><div class="container">
      <div class="row">
        <!-- START: inst/pkgdown/templates/navbar.html -->
<div id="sidebar-col" class="col-lg-4">
  <div id="sidebar" class="sidebar">
      <nav aria-labelledby="flush-headingEleven"><button role="button" aria-label="close menu" alt="close menu" aria-expanded="true" aria-controls="sidebar" class="collapse-toggle" data-collapse="Collapse " data-episodes="Episodes ">
          <i class="search-icon" data-feather="x" role="img"></i>
        </button>
        <div class="sidebar-inner">
          <div class="row mobile-row" id="theme-row-mobile">
            <div class="col" id="theme-selector">
              <li class="nav-item dropdown" id="theme-button-list">
                <button class="btn btn-link nav-link px-0 px-lg-2 dropdown-toggle d-flex align-items-center" id="bd-theme" type="button" aria-expanded="false" data-bs-toggle="dropdown" data-bs-display="static" aria-label="Toggle theme (auto)">
                  <svg class="bi my-1 theme-icon-active"><use href="#circle-half"></use></svg><span class="d-lg-none ms-1" id="bd-theme-text">Toggle Theme</span>
                </button>
                <ul class="dropdown-menu dropdown-menu-right" aria-labelledby="bd-theme-text">
<li>
                    <button type="button" class="btn dropdown-item d-flex align-items-center" data-bs-theme-value="light" aria-pressed="false">
                      <svg class="bi me-2 theme-icon"><use href="#sun-fill"></use></svg>
                      Light
                      <svg class="bi ms-auto d-none"><use href="#check2"></use></svg></button>
                  </li>
                  <li>
                    <button type="button" class="btn dropdown-item d-flex align-items-center" data-bs-theme-value="dark" aria-pressed="false">
                      <svg class="bi me-2 theme-icon"><use href="#moon-stars-fill"></use></svg>
                      Dark
                      <svg class="bi ms-auto d-none"><use href="#check2"></use></svg></button>
                  </li>
                  <li>
                    <button type="button" class="btn dropdown-item d-flex align-items-center active" data-bs-theme-value="auto" aria-pressed="true">
                      <svg class="bi me-2 theme-icon"><use href="#circle-half"></use></svg>
                      Auto
                      <svg class="bi ms-auto d-none"><use href="#check2"></use></svg></button>
                  </li>
                </ul>
</li>
            </div>
          </div>
          <div class="row mobile-row">
            <div class="col">
              <div class="sidenav-view-selector">
                <div class="accordion accordion-flush" id="accordionFlush9">
                  <div class="accordion-item">
                    <h2 class="accordion-header" id="flush-headingNine">
                      <button class="accordion-button collapsed" id="instructor" type="button" data-bs-toggle="collapse" data-bs-target="#flush-collapseNine" aria-expanded="false" aria-controls="flush-collapseNine">
                        <i id="eye" aria-hidden="true" class="icon" data-feather="eye"></i> Learner View
                      </button>
                    </h2>
                    <div id="flush-collapseNine" class="accordion-collapse collapse" aria-labelledby="flush-headingNine" data-bs-parent="#accordionFlush2">
                      <div class="accordion-body">
                        <a href="instructor/aio.html">Instructor View</a>
                      </div>
                    </div>
                  </div>
<!--/div.accordion-item-->
                </div>
<!--/div.accordion-flush-->
              </div>
<!--div.sidenav-view-selector -->
            </div>
<!--/div.col -->

            <hr>
</div>
<!--/div.mobile-row -->

          <div class="accordion accordion-flush" id="accordionFlush11">
            <div class="accordion-item">

              <button id="chapters" class="accordion-button show" type="button" data-bs-toggle="collapse" data-bs-target="#flush-collapseEleven" aria-expanded="false" aria-controls="flush-collapseEleven">
                <h2 class="accordion-header chapters" id="flush-headingEleven">
                  EPISODES
                </h2>
              </button>
              <div id="flush-collapseEleven" class="accordion-collapse show collapse" aria-labelledby="flush-headingEleven" data-bs-parent="#accordionFlush11">

                <div class="accordion-body">
                  <div class="accordion accordion-flush" id="accordionFlush1">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading1">
        <a href="index.html">Summary and Setup</a>
    </div>
<!--/div.accordion-header-->

  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush2">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading2">
        <a href="10-connecting-hpc.html">1. Connecting to the remote HPC system</a>
    </div>
<!--/div.accordion-header-->

  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush3">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading3">
        <a href="11-hpc-intro.html">2. Why do we use HPC?</a>
    </div>
<!--/div.accordion-header-->

  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush4">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading4">
        <a href="12-cluster.html">3. Working on a remote HPC system</a>
    </div>
<!--/div.accordion-header-->

  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush5">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading5">
        <a href="13-scheduler.html">4. Working with the scheduler</a>
    </div>
<!--/div.accordion-header-->

  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush6">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading6">
        <a href="14-modules.html">5. Accessing software via Modules</a>
    </div>
<!--/div.accordion-header-->

  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush7">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading7">
        <a href="15-transferring-files.html">6. Transferring files with remote computers</a>
    </div>
<!--/div.accordion-header-->

  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush8">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading8">
        <a href="17-resources.html">7. Using resources effectively</a>
    </div>
<!--/div.accordion-header-->

  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush9">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading9">
        <a href="18-responsibility.html">8. Using shared resources responsibly</a>
    </div>
<!--/div.accordion-header-->

  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

                </div>
              </div>
            </div>

            <hr class="half-width">
<div class="accordion accordion-flush lesson-resources" id="accordionFlush12">
              <div class="accordion-item">
                <h2 class="accordion-header" id="flush-headingTwelve">
                  <button class="accordion-button collapsed" id="lesson-resources" type="button" data-bs-toggle="collapse" data-bs-target="#flush-collapseTwelve" aria-expanded="false" aria-controls="flush-collapseTwelve">
                    RESOURCES
                  </button>
                </h2>
                <div id="flush-collapseTwelve" class="accordion-collapse collapse" aria-labelledby="flush-headingTwelve" data-bs-parent="#accordionFlush12">
                  <div class="accordion-body">
                    <ul>
<li>
                        <a href="key-points.html">Key Points</a>
                      </li>
                      <li>
                        <a href="reference.html#glossary">Glossary</a>
                      </li>
                      <li>
                        <a href="profiles.html">Learner Profiles</a>
                      </li>
                      <li><a href="reference.html">Glossary</a></li>
                    </ul>
</div>
                </div>
              </div>
            </div>
            <hr class="half-width lesson-resources">
<a href="aio.html">See all in one page</a>


            <hr class="d-none d-sm-block d-md-none">
<div class="d-grid gap-1">

            </div>
          </div>
<!-- /div.accordion -->
        </div>
<!-- /div.sidebar-inner -->
      </nav>
</div>
<!-- /div.sidebar -->
  </div>
<!-- /div.sidebar-col -->
<!-- END:   inst/pkgdown/templates/navbar.html-->

        <!-- START: inst/pkgdown/templates/content-extra.html -->
  <div class="col-xl-8 col-lg-12 primary-content">
    <main id="main-content" class="main-content"><div class="container lesson-content">
        
        
<section id="aio-10-connecting-hpc"><p>Content from <a href="10-connecting-hpc.html">Connecting to the remote HPC system</a></p>
<hr>
<p>Last updated on 2025-10-08 |

        <a href="https://github.com/EPCCed/2025-10-14-archer2-intro-hpc/edit/main/episodes/10-connecting-hpc.Rmd" class="external-link">Edit this page <i aria-hidden="true" data-feather="edit"></i></a></p>
<div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right" data-expand="Expand All Solutions " data-collapse="Collapse All Solutions "> Expand All Solutions <i aria-hidden="true" data-feather="plus"></i></button>
        </div>
<div class="overview card">
<h2 class="card-header">Overview</h2>
<div class="row g-0">
<div class="col-md-4">
<div class="card-body">
<div class="inner">
<h3 class="card-title">Questions</h3>
<ul>
<li>How do I open a terminal?</li>
<li>What is an SSH key?</li>
<li>How do I connect to a remote computer?</li>
</ul>
</div>
</div>
</div>
<div class="col-md-8">
<div class="card-body">
<div class="inner bordered">
<h3 class="card-title">Objectives</h3>
<ul>
<li>Connect to a remote HPC system.</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<p>In this workshop, we will connect to ARCHER2 — an HPC system located
at the University of Edinburgh. Although it’s unlikely that every system
will be exactly like ARCHER2, it’s a very good example of what you can
expect from an HPC.</p>
<p>The first step in using a cluster is to establish a connection from
our laptop to the cluster. When we are sitting at a computer (or
standing, or holding it in our hands or on our wrists), we have come to
expect a visual display with icons, widgets, and perhaps some windows or
applications: a graphical user interface, or GUI.</p>
<p>Since computer clusters are remote resources that we connect to over
often slow or laggy interfaces (WiFi and VPNs especially), it is more
practical to use a command-line interface, or CLI, in which commands and
results are transmitted via text, only. Anything other than text
(images, for example) are written to disk and opened with a separate
program.</p>
<p>If you have ever opened a terminal, i.e. the Windows Command Prompt
or macOS Terminal, you have seen a CLI. If you have already taken The
Carpentries’ courses on the UNIX Shell or Version Control, you have used
the CLI on your local machine somewhat extensively.</p>
<section><h2 class="section-heading" id="opening-a-terminal">Opening a Terminal<a class="anchor" aria-label="anchor" href="#opening-a-terminal"></a>
</h2>
<hr class="half-width">
<p>Different operating systems have different terminals, none of which
are exactly the same in terms of their features and abilities while
working on the operating system. However, when connected to the remote
system the experience between terminals will be identical as each will
faithfully present the same experience of using that system.</p>
<p>Here is the process for opening a terminal in each operating
system.</p>
<div class="section level3">
<h3 id="linux">Linux<a class="anchor" aria-label="anchor" href="#linux"></a>
</h3>
<p>There are many different versions (aka “flavours”) of Linux and how
to open a terminal window can change between flavours. Fortunately most
Linux users already know how to open a terminal window since it is a
common part of the workflow for Linux users. If this is something that
you do not know how to do then a quick search on the Internet for “how
to open a terminal window in” with your particular Linux flavour
appended to the end should quickly give you the directions you need.</p>
</div>
<div class="section level3">
<h3 id="mac">Mac<a class="anchor" aria-label="anchor" href="#mac"></a>
</h3>
<p>Macs have had a terminal built in since the first version of OS X
since it is built on a UNIX-like operating system, leveraging many parts
from BSD (Berkeley Software Distribution). The terminal can be quickly
opened through the use of the Searchlight tool. Hold down the command
key and press the spacebar. In the search bar that shows up type
“terminal”, choose the terminal app from the list of results (it will
look like a tiny, black computer screen) and you will be presented with
a terminal window. Alternatively, you can find Terminal under
“Utilities” in the Applications menu.</p>
</div>
<div class="section level3">
<h3 id="windows">Windows<a class="anchor" aria-label="anchor" href="#windows"></a>
</h3>
<p>While Windows does have a command-line interface known as the
“Command Prompt” that has its roots in MS-DOS (Microsoft Disk Operating
System) it does not have an SSH tool built into it and so one needs to
be installed. There are a variety of programs that can be used for this;
a few common ones we describe here, as follows:</p>
<div class="section level4">
<h4 id="mobaxterm">(1) MobaXterm<a class="anchor" aria-label="anchor" href="#mobaxterm"></a>
</h4>
<p>MobaXterm is a terminal window emulator for Windows and the home
edition can be downloaded for free from <a href="" title="https://mobaxterm.mobatek.net/download-home-edition.html">mobatek.net</a>.</p>
<p>If you follow the link you will note that there are two editions of
the home version available: Portable and Installer. The portable edition
puts all MobaXterm content in a folder on the desktop (or anywhere else
you would like it) so that it is easy to add plug-ins or remove the
software. The installer edition adds MobaXterm to your Windows
installation and menu as any other program you might install. If you are
not sure that you will continue to use MobaXterm in the future, the
portable edition is likely the best choice for you.</p>
<p>Download the version that you would like to use and install it as you
would any other software on your Windows installation. Once the software
is installed you can run it by either opening the folder installed with
the portable edition and double-clicking on the executable file named
<code>MobaXterm_Personal_11.1</code> (your version number may vary) or,
if the installer edition was used, finding the executable through either
the start menu or the Windows search option.</p>
<p>Once the MobaXterm window is open you should see a large button in
the middle of that window with the text “Start Local Terminal”. Click
this button and you will have a terminal window at your disposal.</p>
</div>
<div class="section level4">
<h4 id="git-bash">(2) Git BASH<a class="anchor" aria-label="anchor" href="#git-bash"></a>
</h4>
<p>Git BASH gives you a terminal like interface in Windows. You can use
this to connect to a remote computer via SSH. It can be downloaded for
free from <a href="https://gitforwindows.org/" class="external-link">here</a>.</p>
</div>
<div class="section level4">
<h4 id="windows-subsystem-for-linux">(3) Windows Subsystem for Linux<a class="anchor" aria-label="anchor" href="#windows-subsystem-for-linux"></a>
</h4>
<p>The Windows Subsystem for Linux also allows you to connect to a
remote computer via SSH. Instructions on installing it can be found <a href="https://docs.microsoft.com/en-us/windows/wsl/install-win10" class="external-link">here</a>.</p>
<div id="how-do-i-open-a-terminal" class="callout discussion">
<div class="callout-square">
<i class="callout-icon" data-feather="message-circle"></i>
</div>
<span class="callout-header">Discussion</span>
<div id="how-do-i-open-a-terminal" class="callout-inner">
<h3 class="callout-title">How do I open a terminal?</h3>
<div class="callout-content">
<p>Everyone should now be able to do this! We have completed the first
step to using an HPC system.</p>
</div>
</div>
</div>
</div>
</div>
</section><section><h2 class="section-heading" id="secure-shell-protocol-ssh">Secure SHell protocol (SSH)<a class="anchor" aria-label="anchor" href="#secure-shell-protocol-ssh"></a>
</h2>
<hr class="half-width">
<p>We can think of connecting to the remote HPC system as opening a
terminal on a <em>remote</em> machine. However, we also need to take
some precautions so that other folks on the network can’t see (or
change) the commands you’re running or the results the remote machine
sends back.</p>
<figure><img src="fig/connect-to-remote.svg" alt="Connecting your laptop to a remote cluster" class="figure mx-auto d-block"><div class="figcaption">Connect to cluster</div>
</figure><p>We will use the Secure SHell protocol (or SSH) to open an encrypted
network connection between two machines (your laptop/computer and the
remote HPC system), allowing you to send &amp; receive text and data
without having to worry about prying eyes.</p>
<p>In this section, we will cover creating a pair of SSH keys: a private
key which you keep on your own computer and a public key which is placed
on the remote HPC system that you will log in to.</p>
<p>These keys initiate a secure handshake between remote parties. The
private vs public nomenclature can be confusing as they are both called
keys. It is more helpful to think of the public key as a “lock” and the
private key as the “key”. You give the public ‘lock’ to remote parties
to encrypt or ‘lock’ data. This data is then opened with the ‘private’
key which you hold in a secure place.</p>
<div class="section level3">
<h3 id="creating-an-ssh-key">Creating an SSH key<a class="anchor" aria-label="anchor" href="#creating-an-ssh-key"></a>
</h3>
<p>Make sure you have a SSH client installed on your laptop. SSH clients
are usually command-line tools, where you provide the remote machine
address as the only required argument. If your SSH client has a
graphical front-end, such as PuTTY or MobaXterm, you will set these
arguments before clicking “connect.” From the terminal, you’ll write
something like <code>ssh userName@hostname</code>, where the “@” symbol
is used to separate the two parts of the argument.</p>
</div>
<div class="section level3">
<h3 id="linux-mac-and-windows-subsystem-for-linux">Linux, Mac and Windows Subsystem for Linux<a class="anchor" aria-label="anchor" href="#linux-mac-and-windows-subsystem-for-linux"></a>
</h3>
<p>Once you have opened a terminal check for existing SSH keys and
filenames. Existing SSH keys can be overwritten, so it is good to check
this:</p>
<div class="codewrapper sourceCode" id="cb1">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a><span class="ex">$</span> ls ~/.ssh/</span></code></pre>
</div>
<p>We can then then generate a new public-private key pair,</p>
<div class="codewrapper sourceCode" id="cb2">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb2-1"><a href="#cb2-1" tabindex="-1"></a><span class="ex">$</span> ssh-keygen <span class="at">-o</span> <span class="at">-a</span> 100 <span class="at">-t</span> rsa <span class="at">-b</span> 4096 <span class="at">-f</span> ~/.ssh/key_ARCHER2_rsa</span></code></pre>
</div>
<ul>
<li>
<code>-o</code> (no default): use the OpenSSH key format, rather
than PEM.</li>
<li>
<code>-a</code> (default is 16): number of rounds of passphrase
derivation; increase to slow down brute force attacks.</li>
<li>
<code>-t</code> (default is <a href="https://en.wikipedia.org/wiki/RSA_(cryptosystem)" class="external-link">rsa</a>):
specify the “type” or cryptographic algorithm. <a href="https://en.wikipedia.org/wiki/EdDSA" class="external-link">ed25519</a> is faster and
shorter than RSA for comparable strength.</li>
<li>
<code>-f</code> (default is /home/user/.ssh/id_algorithm): filename
to store your keys. If you already have SSH keys, make sure you specify
a different name: <code>ssh-keygen</code> will overwrite the default key
if you don’t specify!</li>
</ul>
<p>The flag <code>-b</code> sets the number of bits in the key. The
default is 2048. EdDSA uses a fixed key length, so this flag would have
no effect.</p>
<p>When prompted, enter a strong password that you will remember.
Cryptography is only as good as the weakest link, and this will be used
to connect to a powerful, precious, computational resource.</p>
<p>Take a look in <code>~/.ssh</code> (use <code>ls ~/.ssh</code>). You
should see the two new files: your private key
(<code>~/.ssh/key_ARCHER2_rsa</code>) and the public key
(<code>~/.ssh/key_ARCHER2_rsa.pub</code>). If a key is requested by the
system administrators, the <em>public</em> key is the one to
provide.</p>
<div id="further-information" class="callout discussion">
<div class="callout-square">
<i class="callout-icon" data-feather="message-circle"></i>
</div>
<span class="callout-header">Discussion</span>
<div id="further-information" class="callout-inner">
<h3 class="callout-title">Further information</h3>
<div class="callout-content">
<p>For more information on SSH security and some of the flags set here,
an excellent resource is <a href="https://stribika.github.io/2015/01/04/secure-secure-shell.html" class="external-link">Secure
Secure Shell</a>.</p>
</div>
</div>
</div>
</div>
<div class="section level3">
<h3 id="windows-1">Windows<a class="anchor" aria-label="anchor" href="#windows-1"></a>
</h3>
<p>For other options when using Windows, see:</p>
<ul>
<li>puttygen, see the Putty <a href="https://www.chiark.greenend.org.uk/~sgtatham/putty/docs.html" class="external-link">documentation</a>
</li>
<li>MobaKeyGen, see the MobaXterm <a href="https://mobaxterm.mobatek.net/documentation.html" class="external-link">documentation</a>
</li>
</ul>
</div>
<div class="section level3">
<h3 id="uploading-the-public-part-of-the-key-to-the-safe">Uploading the public part of the key to the SAFE<a class="anchor" aria-label="anchor" href="#uploading-the-public-part-of-the-key-to-the-safe"></a>
</h3>
<p>As part of the <a href="index.html">setup</a> you will have created
an account on the SAFE.</p>
<p>The SAFE is an online service management system used by EPCC. Through
SAFE, individual users can request machine accounts, reset passwords,
see available resources and track their usage. All users must be
registered on SAFE before they can apply for their machine account, so
this is the service you used to sign-up for an ARCHER2 account.</p>
<p>Once you have generated your key pair, you need to add the public
part to your ARCHER2 account in SAFE:</p>
<ol style="list-style-type: decimal">
<li><a href="https://safe.epcc.ed.ac.uk" class="external-link">Login to SAFE</a></li>
<li>Go to the Menu “Login accounts” and select the ARCHER2 account you
want to add the SSH key to</li>
<li>On the subsequent Login account details page click the “Add
Credential” button</li>
<li>Select “SSH public key” as the Credential Type and click “Next”</li>
<li>Either copy and paste the public part of your SSH key into the “SSH
Public key” box or use the button to select the public key file on your
computer.</li>
<li>Click “Add” to associate the public SSH key part with your
account</li>
</ol>
<p>The public SSH key part will now be added to your login account on
the ARCHER2 system, so it can actually be used as your secure handshake
between remote parties. You will recieve an email once this process has
been done.</p>
<p>Remember: you can think of the public key as a “lock” and the private
key as the “key”. You give the public ‘lock’ to remote parties to
encrypt or ‘lock’ data. This data is then opened with the ‘private’ key
which you hold in a secure place.</p>
<div id="private-keys-are-private" class="callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<span class="callout-header">Callout</span>
<div id="private-keys-are-private" class="callout-inner">
<h3 class="callout-title">PRIVATE KEYS ARE PRIVATE</h3>
<div class="callout-content">
<p>A private key that is visible to anyone but you should be considered
compromised, and must be destroyed. This includes having improper
permissions on the directory it (or a copy) is stored in, traversing any
network in the clear, attachment on unencrypted email, and even
displaying the key (which is ASCII text) in your terminal window.</p>
<p>Protect this key as if it unlocks your front door. In many ways, it
does.</p>
</div>
</div>
</div>
</div>
<div class="section level3">
<h3 id="configure-totp-passwords">Configure TOTP passwords<a class="anchor" aria-label="anchor" href="#configure-totp-passwords"></a>
</h3>
<p>ARCHER2 also uses Time-based One-Time Passwords (TOTP) for
multi-factor authentication (MFA). One time passwords are a common
security measure used by banking, cloud services and apps that create a
changing time limited code to verify your identity beyond a password and
username.</p>
<p>To setup your MFA TOTP you will need an authenticator application on
your phone or laptop.</p>
<ol style="list-style-type: decimal">
<li><a href="https://safe.epcc.ed.ac.uk" class="external-link">Login to SAFE</a></li>
<li>Go to the Menu “Login accounts” and select the ARCHER2 account you
want to add the MFA token to</li>
<li>On the subsequent Login account details page click the “Set
MFA-Token” button</li>
<li>Scan the QR code and enter the verification code</li>
</ol>
<p>You will only be prompted at login for your TOTP code once a day.</p>
</div>
</section><section><h2 class="section-heading" id="logging-in-to-archer2">Logging in to ARCHER2<a class="anchor" aria-label="anchor" href="#logging-in-to-archer2"></a>
</h2>
<hr class="half-width">
<p>Let’s finally connect to the remote HPC system.</p>
<p>We’ve already used SSH protocol to generate an SSH key-pair, now we
will use SSH to connect (if you are using PuTTY, see above). SSH allows
us to connect to UNIX computers remotely, and use them as if they were
our own. The general syntax of the connection command follows the
format:</p>
<div class="codewrapper sourceCode" id="cb3">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb3-1"><a href="#cb3-1" tabindex="-1"></a><span class="fu">ssh</span> <span class="at">-i</span> ~/.ssh/key_for_remote_computer yourUsername@remote.computer.address</span></code></pre>
</div>
<p>For the SSH key-pair we generated in the previous section, it will
look like this:</p>
<div class="codewrapper sourceCode" id="cb4">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb4-1"><a href="#cb4-1" tabindex="-1"></a><span class="fu">ssh</span> <span class="at">-i</span> ~/.ssh/key_ARCHER2_rsa yourUsername@login.archer2.ac.uk</span></code></pre>
</div>
<p>If your SSH key pair is stored in the default location (usually
~/.ssh/id_rsa) on your local system, you may not need to specify the
path to the private part of the key wih the -i option to ssh. For
example:</p>
<div class="codewrapper sourceCode" id="cb5">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb5-1"><a href="#cb5-1" tabindex="-1"></a><span class="fu">ssh</span> yourUsername@ARCHER2</span></code></pre>
</div>
<div id="first-login" class="callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<span class="callout-header">Callout</span>
<div id="first-login" class="callout-inner">
<h3 class="callout-title">First login!</h3>
<div class="callout-content">
<p>As an additional security measure, you will also need to use a
password from SAFE for your first login to ARCHER2 with a new account.
When you log into ARCHER2 for the first time with a new account, you
will be prompted to change your initial password. This is a three step
process:</p>
<ol style="list-style-type: decimal">
<li>When promoted to enter your ldap password: Enter the password which
you retrieve from SAFE
<ol style="list-style-type: decimal">
<li><a href="https://safe.epcc.ed.ac.uk" class="external-link">Login to SAFE</a></li>
<li>Go to the Menu “Login accounts” and select the ARCHER2 account you
want to add the MFA token to</li>
<li>On the subsequent Login account details page click the “View Login
Account Password” button</li>
<li>Copy this and enter into ARCHER2 prompt</li>
</ol>
</li>
<li>When prompted to enter your new password: type in a new
password</li>
<li>When prompted to re-enter the new password: re-enter the new
password</li>
</ol>
<p>Your password has now been changed. You will no longer need this
password to log into ARCHER2 from this point forwards, you will use your
SSH key and TOTP code <em>only</em>.</p>
</div>
</div>
</div>
<p>If you’ve connected successfully, you should see a prompt like the
one below. This prompt is informative, and lets you grasp certain
information at a glance. (If you don’t understand what these things are,
don’t worry! We will cover things in depth as we explore the system
further.)</p>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>#######################################################################################

        @@@@@@@@@
     @@@         @@@            _      ____     ____   _   _   _____   ____    ____
   @@@    @@@@@    @@@         / \    |  _ \   / ___| | | | | | ____| |  _ \  |___ \
  @@@   @@     @@   @@@       / _ \   | |_) | | |     | |_| | |  _|   | |_) |   __) |
  @@   @@  @@@  @@   @@      / ___ \  |  _ &lt;  | |___  |  _  | | |___  |  _ &lt;   / __/
  @@   @@  @@@  @@   @@     /_/   \_\ |_| \_\  \____| |_| |_| |_____| |_| \_\ |_____|
  @@@   @@     @@   @@@
   @@@    @@@@@    @@@       https://www.archer2.ac.uk/support-access/
     @@@         @@@
        @@@@@@@@@

 -         U K R I         -        E P C C        -         H P E   C r a y         -

Hostname:     ln02
Distribution: SLES 15.1 1
CPUS:         256
Memory:       515.3GB
Configured:   2025-09-16

######################################################################################
---------------------------------Welcome to ARCHER2-----------------------------------
######################################################################################</code></pre>
</div>
</section><section><h2 class="section-heading" id="telling-the-difference-between-the-local-terminal-and-the-remote-terminal">Telling the Difference between the Local Terminal and the Remote
Terminal<a class="anchor" aria-label="anchor" href="#telling-the-difference-between-the-local-terminal-and-the-remote-terminal"></a>
</h2>
<hr class="half-width">
<div class="codewrapper sourceCode" id="cb7">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb7-1"><a href="#cb7-1" tabindex="-1"></a><span class="ex">userid@ln03:~</span><span class="op">&gt;</span></span></code></pre>
</div>
<p>You may have noticed that the prompt changed when you logged into the
remote system using the terminal (if you logged in using PuTTY this will
not apply because it does not offer a local terminal).</p>
<p>This change is important because it makes it clear on which system
the commands you type will be run when you pass them into the terminal.
This change is also a small complication that we will need to navigate
throughout the workshop. Exactly what is reported before the
<code>$</code> in the terminal when it is connected to the local system
and the remote system will typically be different for every user.</p>
<p>We will using the following to differentiate:</p>
<ul>
<li>
<code>[local]$</code> when the command is to be entered on a
terminal connected to your local computer</li>
<li>
<code>userid@ln03:~&gt;</code> when the command is to be entered on
a terminal connected to the remote system</li>
<li>
<code>$</code> when it really doesn’t matter which system the
terminal is connected to.</li>
</ul>
<p>If you ever need to be certain which system a terminal you are using
is connected to then use the following command:
<code>$ hostname</code>.</p>
<div id="keep-two-terminal-windows-open" class="callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<span class="callout-header">Callout</span>
<div id="keep-two-terminal-windows-open" class="callout-inner">
<h3 class="callout-title">Keep two terminal windows open</h3>
<div class="callout-content">
<p>It is strongly recommended that you have two terminals open, one
connected to the local system and one connected to the remote system,
that you can switch back and forth between. If you only use one terminal
window then you will need to reconnect to the remote system using one of
the methods above when you see a change from <code>[local]$</code> to <a href="mailto:userid@ln03" class="email">userid@ln03</a>:~&gt; and
disconnect when you see the reverse.</p>
</div>
</div>
</div>
<div id="keypoints1" class="callout keypoints">
<div class="callout-square">
<i class="callout-icon" data-feather="key"></i>
</div>
<span class="callout-header">Key Points</span>
<div class="callout-inner">
<div class="callout-content">
<p>To connect to a remote HPC system using SSH, we would run the
following command and enter an SSH key passphrase and machine password.
(For ARCHER2, this is a TOTP)</p>
<div class="codewrapper sourceCode" id="cb8">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb8-1"><a href="#cb8-1" tabindex="-1"></a><span class="fu">ssh</span> <span class="at">-i</span> ~/.ssh/key_for_remote_computer yourUsername@remote.computer.address</span></code></pre>
</div>
</div>
</div>
</div>
<!--
Place links that you need to refer to multiple times across pages here. Delete
any links that you are not going to use.

use like [gitbash][gitbash]
 -->
</section></section><section id="aio-11-hpc-intro"><p>Content from <a href="11-hpc-intro.html">Why do we use HPC?</a></p>
<hr>
<p>Last updated on 2025-10-13 |

        <a href="https://github.com/EPCCed/2025-10-14-archer2-intro-hpc/edit/main/episodes/11-hpc-intro.Rmd" class="external-link">Edit this page <i aria-hidden="true" data-feather="edit"></i></a></p>
<div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right" data-expand="Expand All Solutions " data-collapse="Collapse All Solutions "> Expand All Solutions <i aria-hidden="true" data-feather="plus"></i></button>
        </div>
<div class="overview card">
<h2 class="card-header">Overview</h2>
<div class="row g-0">
<div class="col-md-4">
<div class="card-body">
<div class="inner">
<h3 class="card-title">Questions</h3>
<ul>
<li>What is the difference between a laptop, a server and a remote HPC
system?</li>
<li>Why would I be interested in High Performance Computing (HPC)?</li>
<li>Have I already been relying on servers without realizing it?</li>
</ul>
</div>
</div>
</div>
<div class="col-md-8">
<div class="card-body">
<div class="inner bordered">
<h3 class="card-title">Objectives</h3>
<ul>
<li>Recognize examples of remote servers and large-scale computing in
everyday life.<br>
</li>
<li>Identify how an HPC system could benefit you.</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<section><h2 class="section-heading" id="hpc-research-examples">HPC research examples<a class="anchor" aria-label="anchor" href="#hpc-research-examples"></a>
</h2>
<hr class="half-width">
<p>Frequently, research problems that use computing can outgrow the
capabilities of the desktop or laptop computer where they started:</p>
<ul>
<li>A statistics student wants to cross-validate a model. This involves
running the model 1000 times — but each run takes an hour. Running the
model on a laptop will take over a month! In this research problem,
final results are calculated after all 1000 models have run, but
typically only one model is run at a time (in <strong>serial</strong>)
on the laptop. Since each of the 1000 runs is independent of all others,
and given enough computers, it’s theoretically possible to run them all
at once (in <strong>parallel</strong>).</li>
<li>A genomics researcher has been using small datasets of sequence
data, but soon will be receiving a new type of sequencing data that is
10 times as large. It’s already challenging to open the datasets on a
computer — analyzing these larger datasets will probably crash it. In
this research problem, the calculations required might be impossible to
parallelize, but a computer with <strong>more memory</strong> would be
required to analyze the much larger future data set.</li>
<li>An engineer is using a fluid dynamics package that has an option to
run in parallel. So far, this option was not utilized on a desktop. In
going from 2D to 3D simulations, the simulation time has more than
tripled. It might be useful to take advantage of that option or feature.
In this research problem, the calculations in each region of the
simulation are largely independent of calculations in other regions of
the simulation. It’s possible to run each region’s calculations
simultaneously (in <strong>parallel</strong>), communicate selected
results to adjacent regions as needed, and repeat the calculations to
converge on a final set of results. In moving from a 2D to a 3D model,
<strong>both the amount of data and the amount of calculations increases
greatly</strong>, and it’s theoretically possible to distribute the
calculations across multiple computers communicating over a shared
network.</li>
</ul>
<p>In all these cases, access to more (and larger) computers is needed.
Those larger computers should be usable by many people and problems at
the same time, <strong>therefore solving many researchers’ problems in
parallel</strong>.</p>
<div id="over-to-you" class="callout discussion">
<div class="callout-square">
<i class="callout-icon" data-feather="message-circle"></i>
</div>
<span class="callout-header">Discussion</span>
<div id="over-to-you" class="callout-inner">
<h3 class="callout-title">Over to you!</h3>
<div class="callout-content">
<p>Talk to your neighbour, office mate or <a href="https://rubberduckdebugging.com/" class="external-link">rubber duck</a> about your
research.</p>
<ul>
<li>How does computing help you do your research?</li>
<li>How could more computing help you do more or better research?</li>
</ul>
</div>
</div>
</div>
</section><section><h2 class="section-heading" id="a-standard-laptop-for-standard-tasks">A Standard Laptop for Standard Tasks<a class="anchor" aria-label="anchor" href="#a-standard-laptop-for-standard-tasks"></a>
</h2>
<hr class="half-width">
<p>Today, many people use coding and data analysis in their jobs,
typically working with standard laptops.</p>
<figure><img src="fig/200px-laptop-openclipartorg-aoguerrero.svg" alt="A standard laptop" class="figure mx-auto d-block"><div class="figcaption">A standard laptop</div>
</figure><p>Let’s dissect what resources programs running on a laptop
require:</p>
<ul>
<li>The keyboard and/or touchpad is used to tell the computer what to do
(<strong>Input</strong>)</li>
<li>The internal computing resources <strong>Central Processing
Unit</strong> and <strong>Memory</strong> perform calculation</li>
<li>The display depicts progress and results
(<strong>Output</strong>)</li>
</ul>
<p>Schematically, this can be reduced to the following:</p>
<figure><img src="fig/Simple_Von_Neumann_Architecture.svg" alt="Schematic of how a computer works" class="figure mx-auto d-block"><div class="figcaption">Schematic of how a computer works</div>
</figure></section><section><h2 class="section-heading" id="when-tasks-take-too-long">When Tasks Take Too Long<a class="anchor" aria-label="anchor" href="#when-tasks-take-too-long"></a>
</h2>
<hr class="half-width">
<p>When the task to solve becomes heavy on computations, the operations
are typically out-sourced from the local laptop or desktop to
elsewhere.</p>
<p>For example, the task to find the directions for your next vacation.
The capabilities of your laptop are typically not enough to calculate
that route spontaneously: <a href="https://en.wikipedia.org/wiki/Dijkstra's_algorithm" class="external-link">finding
the shortest path</a> through a network runs on the order of (<em>v</em>
log <em>v</em>) time, where <em>v</em> (vertices) represents the number
of intersections in your map. Instead of doing this yourself, you use a
website, which in turn runs on a server, that is almost definitely not
in the same room as you are.</p>
<figure style="max-width: 30%; margin: 0 auto; text-align: center"><img src="fig/servers-openclipartorg-ericlemerdy.svg" alt="A rack half full with servers" class="figure figure"><div class="figcaption">
A rack half full with servers
</div>
</figure><p>Note here, that a server is mostly a noisy computer mounted into a
rack cabinet which in turn resides in a data center. The internet made
it possible that these data centers do not require to be nearby your
laptop.</p>
<p>What people call <strong>the cloud</strong> is mostly a web-service
where you can rent such servers by requesting remote resources that
satisfy your requirements and then pay for the time you need. This is
often handled through an online, browser-based interface listing the
various machines available and their capacities in terms of processing
power, memory, and storage.</p>
<p>The server itself has no direct display or input methods attached to
it. But most importantly, it has much more storage, memory and compute
capacity than your laptop will ever have.</p>
<p>In any case, you need a local device (laptop, workstation, mobile
phone or tablet) to interact with this remote machine, which people
typically call ‘a server’.</p>
</section><section><h2 class="section-heading" id="when-one-server-is-not-enough">When One Server Is Not Enough<a class="anchor" aria-label="anchor" href="#when-one-server-is-not-enough"></a>
</h2>
<hr class="half-width">
<p>If the computational task or analysis to complete is daunting for a
single server, larger agglomerations of servers are used. These go by
the name of “clusters” or “supercomputers”.</p>
<figure style="max-width: 30%; margin: 0 auto; text-align: center;"><img src="fig/serverrack-openclipartorg-psteinb-basedon-ericlemerdy.svg" alt="A rack full with servers" class="figure figure"><div class="figcaption">
A rack full with servers
</div>
</figure><p>The methodology of providing the input data, configuring the program
options, and retrieving the results is quite different to using a plain
laptop. Moreover, using a graphical user interface is often discarded in
favor of using the command line. This imposes a double paradigm shift
for prospective users who must:</p>
<ol style="list-style-type: decimal">
<li>Work with the command line interface (CLI) or terminal, rather than
a graphical user interface (GUI)</li>
<li>Work with a distributed set of computers (called nodes) rather than
the machine attached to their keyboard &amp; mouse</li>
</ol>
<div id="ive-never-used-a-server-have-i" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<span class="callout-header">Challenge</span>
<div id="ive-never-used-a-server-have-i" class="callout-inner">
<h3 class="callout-title">I’ve Never Used a Server, Have I?</h3>
<div class="callout-content">
<p>Take a minute and think about which of your daily interactions with a
computer may require a remote server or even cluster to provide you with
results.</p>
</div>
</div>
</div>
<div id="accordionSolution1" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution1" aria-expanded="false" aria-controls="collapseSolution1">
  <h4 class="accordion-header" id="headingSolution1">
  Some Ideas
  </h4>
</button>
<div id="collapseSolution1" class="accordion-collapse collapse" data-bs-parent="#accordionSolution1" aria-labelledby="headingSolution1">
<div class="accordion-body">
<ul>
<li>
<strong>Checking email:</strong> your computer (possibly in your
pocket) contacts a remote machine, authenticates, and downloads a list
of new messages; it also uploads changes to message status, such as
whether you read, marked as junk, or deleted the message. Since yours is
not the only account, the mail server is probably one of many in a data
center.</li>
<li>
<strong>Searching for a phrase</strong> online involves comparing
your search term against a massive database of all known sites, looking
for matches. This “query” operation can be straightforward, but building
that database is a <a href="https://en.wikipedia.org/wiki/MapReduce" class="external-link">monumental task</a>!
Servers are involved at every step.</li>
<li>
<strong>Searching for directions on a mapping website</strong>
involves connecting your starting and end points by <a href="https://en.wikipedia.org/wiki/Dijkstra%27s_algorithm" class="external-link">traversing a
graph</a> in search of the “shortest” path by distance, time, expense,
or another metric. Converting a map into the right form is relatively
simple, but calculating all the possible routes between A and B is
expensive.</li>
<li>
<strong>Streaming a movie or music:</strong> when you press play on
a streaming service, your computer requests data from a network of
servers spread around the world. These servers ensure your video starts
fast and doesn’t pause mid-climax.</li>
<li>
<strong>Playing an online game:</strong> whether you’re in a massive
multiplayer battle or just racing a friend, a game server keeps
everyone’s view of the world synchronized. Every jump, shot, and respawn
is coordinated in real time by remote machines.</li>
<li>
<strong>Asking a virtual assistant for help:</strong> saying “Hey
Siri” or “OK Google” sends your voice to servers that run speech
recognition and natural language models.</li>
<li>
<strong>Using cloud storage:</strong> saving a document to somewhere
in the cloud means it’s being encrypted, stored, and backed up across
multiple servers so it’s safe even if your laptop isn’t.</li>
</ul>
<p>Checking email could be serial: your machine connects to one server
and exchanges data. Searching by querying the database for your search
term (or endpoints) could also be serial, in that one machine receives
your query and returns the result. However, assembling and storing the
full database is far beyond the capability of any one machine.
Therefore, these functions are served in parallel by a large, <a href="https://en.wikipedia.org/wiki/Hyperscale_computing" class="external-link">“hyperscale”</a>
collection of servers working together.</p>
</div>
</div>
</div>
</div>
<div id="keypoints1" class="callout keypoints">
<div class="callout-square">
<i class="callout-icon" data-feather="key"></i>
</div>
<span class="callout-header">Key Points</span>
<div class="callout-inner">
<div class="callout-content">
<ul>
<li>High Performance Computing (HPC) typically involves connecting to
very large computing systems located elsewhere in the world.<br>
</li>
<li>These systems can perform tasks that would be impossible or much
slower on smaller, personal computers.<br>
</li>
<li>We already rely on remote servers every day.<br>
</li>
</ul>
</div>
</div>
</div>
<!--
Place links that you need to refer to multiple times across pages here. Delete
any links that you are not going to use.

use like [gitbash][gitbash]
 -->
</section></section><section id="aio-12-cluster"><p>Content from <a href="12-cluster.html">Working on a remote HPC system</a></p>
<hr>
<p>Last updated on 2025-10-13 |

        <a href="https://github.com/EPCCed/2025-10-14-archer2-intro-hpc/edit/main/episodes/12-cluster.Rmd" class="external-link">Edit this page <i aria-hidden="true" data-feather="edit"></i></a></p>
<div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right" data-expand="Expand All Solutions " data-collapse="Collapse All Solutions "> Expand All Solutions <i aria-hidden="true" data-feather="plus"></i></button>
        </div>
<div class="overview card">
<h2 class="card-header">Overview</h2>
<div class="row g-0">
<div class="col-md-4">
<div class="card-body">
<div class="inner">
<h3 class="card-title">Questions</h3>
<ul>
<li>What is an HPC system?</li>
<li>How does an HPC system work?</li>
</ul>
</div>
</div>
</div>
<div class="col-md-8">
<div class="card-body">
<div class="inner bordered">
<h3 class="card-title">Objectives</h3>
<ul>
<li>Understand the general HPC system architecture.</li>
<li>Understand that there are different types of nodes for different
purposes</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<section><h2 class="section-heading" id="what-is-an-hpc-system">What is an HPC System?<a class="anchor" aria-label="anchor" href="#what-is-an-hpc-system"></a>
</h2>
<hr class="half-width">
<p>The words “cloud”, “cluster”, and the phrase “high-performance
computing” or “HPC” are used a lot in different contexts and with
various related meanings. So what do they mean? And more importantly,
how do we use them in our work?</p>
<p>The <em>cloud</em> is a generic term commonly used to refer to
computing resources that are a) <em>provisioned</em> to users on demand
or as needed and b) represent real or <em>virtual</em> resources that
may be located anywhere on Earth. For example, a large company with
computing resources in Brazil, Zimbabwe and Japan may manage those
resources as its own <em>internal</em> cloud and that same company may
also utilize commercial cloud resources provided by Amazon or Google.
Cloud resources may refer to machines performing relatively simple tasks
such as serving websites, providing shared storage, providing web
services (such as e-mail or social media platforms), as well as more
traditional compute intensive tasks such as running a simulation.</p>
<p>The term <em>HPC system</em>, on the other hand, describes a
stand-alone resource for computationally intensive workloads. They are
typically comprised of a multitude of integrated processing and storage
elements, designed to handle high volumes of data and/or large numbers
of floating-point operations (<a href="https://en.wikipedia.org/wiki/FLOPS" class="external-link">FLOPS</a>) with the highest
possible performance. To support these constraints, an HPC resource must
exist in a specific, fixed location: networking cables can only stretch
so far, and electrical and optical signals can travel only so fast. All
of the machines on the <a href="https://www.top500.org" class="external-link">Top-500</a> list
are HPC systems.</p>
<p>The word “cluster” is often used for small to moderate scale HPC
resources less impressive than the <a href="https://www.top500.org" class="external-link">Top-500</a>. Clusters are often maintained
in computing centers that support several such systems, all sharing
common networking and storage to support common compute intensive
tasks.</p>
</section><section><h2 class="section-heading" id="logging-in">Logging In<a class="anchor" aria-label="anchor" href="#logging-in"></a>
</h2>
<hr class="half-width">
<p>Go ahead and open your terminal and log in to ARCHER2. Remember, we
are opening a terminal on our local laptop to connect to a remote system
which is physically at EPCC in Edinburgh.</p>
<div class="codewrapper sourceCode" id="cb1">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a><span class="ex">[user@laptop</span> ~]$ ssh userid@login.archer2.ac.uk</span></code></pre>
</div>
<p>Remember to replace <code>userid</code> with your username or the one
supplied by the instructors.</p>
<div id="want-to-refresh-your-memory-on-the-log-in-process" class="callout prereq">
<div class="callout-square">
<i class="callout-icon" data-feather="check"></i>
</div>
<span class="callout-header">Prerequisite</span>
<div id="want-to-refresh-your-memory-on-the-log-in-process" class="callout-inner">
<h3 class="callout-title">Want to refresh your memory on the log in
process?</h3>
<div class="callout-content">
<p>This was covered in <a href="10-connecting-hpc.html">lesson 1</a> or
you can find a QuickStart guide in the <a href="index.html">set-up
section</a>. Ask an instructor if you need help!</p>
</div>
</div>
</div>
</section><section><h2 class="section-heading" id="where-are-we">Where Are We?<a class="anchor" aria-label="anchor" href="#where-are-we"></a>
</h2>
<hr class="half-width">
<p>Very often, many users are tempted to think of a high-performance
computing installation as one giant, magical machine. Sometimes, people
will assume that the computer they’ve logged onto is the entire
computing cluster. So what’s really happening? What computer have we
logged on to?</p>
<p>We can check where we are in the system with the
<code>hostname</code> command. (You may also notice that the current
hostname is also part of our prompt!)</p>
<div class="codewrapper sourceCode" id="cb2">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb2-1"><a href="#cb2-1" tabindex="-1"></a><span class="ex">userid@ln03:~</span><span class="op">&gt;</span> hostname</span>
<span id="cb2-2"><a href="#cb2-2" tabindex="-1"></a><span class="ex">userid@ln03:~</span><span class="op">&gt;</span> ln03</span></code></pre>
</div>
<div id="where-are-we-when-we-login" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<span class="callout-header">Challenge</span>
<div id="where-are-we-when-we-login" class="callout-inner">
<h3 class="callout-title">Where are we when we login?</h3>
<div class="callout-content">
<p>Take a look around and see what you can find.</p>
<p>The system administrators may have configured your home directory
with some helpful files, folders, and links (shortcuts) to space
reserved for you on other filesystems.</p>
<p><em>Hint:</em> The shell commands <code>pwd</code>, <code>cd</code>
and <code>ls</code> may come in handy. Home directory contents vary from
user to user. Please discuss any differences you spot with your
neighbors.</p>
</div>
</div>
</div>
<div id="accordionSolution1" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution1" aria-expanded="false" aria-controls="collapseSolution1">
  <h4 class="accordion-header" id="headingSolution1"> It’s a Beautiful Day in the Neighborhood </h4>
</button>
<div id="collapseSolution1" class="accordion-collapse collapse" data-bs-parent="#accordionSolution1" aria-labelledby="headingSolution1">
<div class="accordion-body">
<p>The deepest layer should differ: <code>userid</code> is uniquely
yours. Are there differences in the path at higher levels?</p>
<p>If both of you have empty directories, they will look identical. If
you or your neighbor has used the system before, there may be
differences. What are you working on?</p>
<p>Use <code>pwd</code> to <strong>p</strong>rint the
<strong>w</strong>orking <strong>d</strong>irectory path:</p>
<div class="codewrapper sourceCode" id="cb3">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb3-1"><a href="#cb3-1" tabindex="-1"></a><span class="ex">userid@ln03:~</span><span class="op">&gt;</span> pwd</span></code></pre>
</div>
<p>You can run <code>ls</code> to <strong>l</strong>i<strong>s</strong>t
the directory contents, though it’s possible nothing will show up (if no
files have been provided). To be sure, use the <code>-a</code> flag to
show hidden files, too.</p>
<div class="codewrapper sourceCode" id="cb4">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb4-1"><a href="#cb4-1" tabindex="-1"></a><span class="ex">userid@ln03:~</span><span class="op">&gt;</span> ls <span class="at">-a</span></span></code></pre>
</div>
<p>At a minimum, this will show the current directory as <code>.</code>,
and the parent directory as <code>..</code>.</p>
</div>
</div>
</div>
</div>
</section><section><h2 class="section-heading" id="nodes">Nodes<a class="anchor" aria-label="anchor" href="#nodes"></a>
</h2>
<hr class="half-width">
<p>Individual computers that compose a cluster are typically called
<em>nodes</em> (although you will also hear people call them
<em>servers</em>, <em>computers</em> and <em>machines</em>). On a
cluster, there are different types of nodes for different types of
tasks. The node where you are right now is called the <em>head
node</em>, <em>login node</em>, <em>landing pad</em>, or <em>submit
node</em>. A login node serves as an access point to the cluster.</p>
<p>As a gateway, it is well suited for uploading and downloading files,
setting up software, and running quick tests. Generally speaking, the
login node should <strong>not</strong> be used for time-consuming or
resource-intensive tasks. You should be alert to this, and check with
your site’s operators or documentation for details of what is and isn’t
allowed. In these lessons, we will avoid running jobs on the head node
(because we will get in trouble otherwise).</p>
<div id="specialised-nodes" class="callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<span class="callout-header">Callout</span>
<div id="specialised-nodes" class="callout-inner">
<h3 class="callout-title">Specialised nodes</h3>
<div class="callout-content">
<p>Many HPC clusters have a variety of nodes optimized for particular
workloads. Some nodes may have larger amount of memory, or specialized
resources such as Graphical Processing Units (GPUs).</p>
<div class="section level3">
<h3 id="dedicated-transfer-nodes">Dedicated Transfer Nodes<a class="anchor" aria-label="anchor" href="#dedicated-transfer-nodes"></a>
</h3>
<p>If you want to transfer larger amounts of data to or from the
cluster, some systems offer dedicated nodes for data transfers only. The
motivation for this lies in the fact that larger data transfers should
not obstruct operation of the login node for anybody else. Check with
your cluster’s documentation or its support team if such a transfer node
is available. As a rule of thumb, consider all transfers of a volume
larger than 500 MB to 1 GB as large. But these numbers change, e.g.,
depending on the network connection of yourself and of your cluster or
other factors.</p>
</div>
</div>
</div>
</div>
<p>The real work on a cluster gets done by the <em>worker</em> (or
<em>compute</em>) <em>nodes</em>. Worker nodes come in many shapes and
sizes, but generally are dedicated to long or hard tasks that require a
lot of computational resources.</p>
<p>All interaction with the worker nodes is handled by a specialized
piece of software called a scheduler (the scheduler used in this lesson
is called <strong>Slurm</strong>). We’ll learn more about how to use the
scheduler to submit jobs next, but for now, it can also tell us more
information about the worker nodes.</p>
<p>For example, we can view all of the worker nodes by running the
command <code>sinfo</code>.</p>
<div class="codewrapper sourceCode" id="cb5">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb5-1"><a href="#cb5-1" tabindex="-1"></a><span class="ex">userid@ln03:~</span><span class="op">&gt;</span> sinfo</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>PARTITION AVAIL  TIMELIMIT  NODES  STATE NODELIST
standard     up 1-00:00:00     27 drain* nid[001029,001050,001149,001363,001366,001391,001552,001568,001620,001642,001669,001672-001675,001688,001690-001691,001747,001751,001783,001793,001812,001832-001835]
standard     up 1-00:00:00      5  down* nid[001024,001026,001064,001239,001898]
standard     up 1-00:00:00      8  drain nid[001002,001028,001030-001031,001360-001362,001745]
standard     up 1-00:00:00    945  alloc nid[001000-001001,001003-001023,001025,001027,001032-001037,001040-001049,001051-001063,001065-001108,001110-001145,001147,001150-001238,001240-001264,001266-001271,001274-001334,001337-001359,001364-001365,001367-001390,001392-001551,001553-001567,001569-001619,001621-001637,001639-001641,001643-001668,001670-001671,001676,001679-001687,001692-001734,001736-001744,001746,001748-001750,001752-001782,001784-001792,001794-001811,001813-001824,001826-001831,001836-001890,001892-001897,001899-001918,001920,001923-001934,001936-001945,001947-001965,001967-001981,001984-001991,002006-002023]
standard     up 1-00:00:00     37   resv nid[001038-001039,001109,001146,001148,001265,001272-001273,001335-001336,001638,001677-001678,001735,001891,001919,001921-001922,001935,001946,001966,001982-001983,001992-002005] </code></pre>
</div>
<p>There are also specialized machines used for managing disk storage,
user authentication, and other infrastructure-related tasks. Although we
do not typically log on to or interact with these machines directly,
they enable a number of key features like ensuring our user account and
files are available throughout the HPC system.</p>
</section><section><h2 class="section-heading" id="whats-in-a-node">What’s in a Node?<a class="anchor" aria-label="anchor" href="#whats-in-a-node"></a>
</h2>
<hr class="half-width">
<p>All of the nodes in an HPC system have the same components as your
own laptop or desktop: <em>CPUs</em> (sometimes also called
<em>processors</em> or <em>cores</em>), <em>memory</em> (or
<em>RAM</em>), and <em>disk</em> space. CPUs are a computer’s tool for
actually running programs and calculations. Information about a current
task is stored in the computer’s memory. Disk refers to all storage that
can be accessed like a file system. While this storage can be local (a
hard drive installed inside of it), it is more common for nodes to
connect to a shared, remote fileserver or cluster of servers.</p>
<figure><img src="fig/node_anatomy.png" max-width="20%" caption="" alt="Node anatomy" class="figure mx-auto d-block"><div class="figcaption">Node anatomy</div>
</figure><div id="explore-your-computer" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<span class="callout-header">Challenge</span>
<div id="explore-your-computer" class="callout-inner">
<h3 class="callout-title">Explore Your Computer</h3>
<div class="callout-content">
<p>Try to find out the number of CPUs and amount of memory available on
your personal computer. Note that, if you’re logged in to the remote
computer cluster, you need to log out first. To do so, type
<code>Ctrl+d</code> or <code>exit</code>:</p>
<div class="codewrapper sourceCode" id="cb7">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb7-1"><a href="#cb7-1" tabindex="-1"></a><span class="ex">userid@ln03:~</span><span class="op">&gt;</span> exit</span>
<span id="cb7-2"><a href="#cb7-2" tabindex="-1"></a><span class="ex">[user@laptop</span> ~]$</span></code></pre>
</div>
</div>
</div>
</div>
<div id="accordionSolution2" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution2" aria-expanded="false" aria-controls="collapseSolution2">
  <h4 class="accordion-header" id="headingSolution2"> Show me the solution </h4>
</button>
<div id="collapseSolution2" class="accordion-collapse collapse" data-bs-parent="#accordionSolution2" aria-labelledby="headingSolution2">
<div class="accordion-body">
<p>There are several ways to do this. Most operating systems have a
graphical system monitor, like the Windows Task Manager. More detailed
information can sometimes be found on the command line. For example,
some of the commands used on a Linux system are:</p>
<p>Run system utilities</p>
<div class="codewrapper sourceCode" id="cb8">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb8-1"><a href="#cb8-1" tabindex="-1"></a><span class="ex">[user@laptop</span> ~]$ nproc <span class="at">--all</span></span>
<span id="cb8-2"><a href="#cb8-2" tabindex="-1"></a><span class="ex">[user@laptop</span> ~]$ free <span class="at">-m</span></span></code></pre>
</div>
<p>Read from <code>/proc</code></p>
<div class="codewrapper sourceCode" id="cb9">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb9-1"><a href="#cb9-1" tabindex="-1"></a><span class="ex">[user@laptop</span> ~]$ cat /proc/cpuinfo</span>
<span id="cb9-2"><a href="#cb9-2" tabindex="-1"></a><span class="ex">[user@laptop</span> ~]$ cat /proc/meminfo</span></code></pre>
</div>
<p>Run system monitor</p>
<div class="codewrapper sourceCode" id="cb10">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb10-1"><a href="#cb10-1" tabindex="-1"></a><span class="ex">[user@laptop</span> ~]$ htop</span></code></pre>
</div>
</div>
</div>
</div>
</div>
<div id="explore-the-login-node" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<span class="callout-header">Challenge</span>
<div id="explore-the-login-node" class="callout-inner">
<h3 class="callout-title">Explore the login node</h3>
<div class="callout-content">
<p>Now compare the resources of your computer with those of the head
node.</p>
</div>
</div>
</div>
<div id="accordionSolution3" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution3" aria-expanded="false" aria-controls="collapseSolution3">
  <h4 class="accordion-header" id="headingSolution3"> Show me the solution </h4>
</button>
<div id="collapseSolution3" class="accordion-collapse collapse" data-bs-parent="#accordionSolution3" aria-labelledby="headingSolution3">
<div class="accordion-body">
<div class="codewrapper sourceCode" id="cb11">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb11-1"><a href="#cb11-1" tabindex="-1"></a><span class="ex">[user@laptop</span> ~]$ ssh userid@login.archer2.ac.uk</span>
<span id="cb11-2"><a href="#cb11-2" tabindex="-1"></a><span class="ex">userid@ln03:~</span><span class="op">&gt;</span> nproc <span class="at">--all</span></span>
<span id="cb11-3"><a href="#cb11-3" tabindex="-1"></a><span class="ex">userid@ln03:~</span><span class="op">&gt;</span> free <span class="at">-m</span></span></code></pre>
</div>
<p>You can get more information about the processors using
<code>lscpu</code>, and a lot of detail about the memory by reading the
file <code>/proc/meminfo</code>:</p>
<div class="codewrapper sourceCode" id="cb12">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb12-1"><a href="#cb12-1" tabindex="-1"></a><span class="ex">userid@ln03:~</span><span class="op">&gt;</span> less /proc/meminfo</span></code></pre>
</div>
<p>You can also explore the available filesystems using <code>df</code>
to show <strong>d</strong>isk <strong>f</strong>ree space. The
<code>-h</code> flag renders the sizes in a human-friendly format, i.e.,
GB instead of B. The <strong>t</strong>ype flag <code>-T</code> shows
what kind of filesystem each resource is.</p>
<div class="codewrapper sourceCode" id="cb13">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb13-1"><a href="#cb13-1" tabindex="-1"></a><span class="ex">userid@ln03:~</span><span class="op">&gt;</span> df <span class="at">-Th</span></span></code></pre>
</div>
</div>
</div>
</div>
</div>
<!--
#::: discussion
#The local filesystems (ext, tmp, xfs, zfs) will depend on whether you're
#on the same login node (or compute node, later on). Networked filesystems
#(beegfs, cifs, gpfs, nfs, pvfs) will be similar --- but may include
#userid, depending on how it is [mounted](
#https://en.wikipedia.org/wiki/Mount_(computing)).
#:::
-->
<div id="shared-filesystems" class="callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<span class="callout-header">Callout</span>
<div id="shared-filesystems" class="callout-inner">
<h3 class="callout-title">Shared Filesystems</h3>
<div class="callout-content">
<p>This is an important point to remember: files saved on one login node
are available in <code>/home</code> regardless of which login node you
are on.</p>
</div>
</div>
</div>
<div id="explore-a-worker-node" class="callout discussion">
<div class="callout-square">
<i class="callout-icon" data-feather="message-circle"></i>
</div>
<span class="callout-header">Discussion</span>
<div id="explore-a-worker-node" class="callout-inner">
<h3 class="callout-title">Explore a Worker Node</h3>
<div class="callout-content">
<p>Finally, let’s look at the resources available on the worker nodes
where your jobs will actually run. Try running this command to see the
name, CPUs and memory available on one of the worker nodes:</p>
<div class="codewrapper sourceCode" id="cb14">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb14-1"><a href="#cb14-1" tabindex="-1"></a><span class="ex">userid@ln03:~</span><span class="op">&gt;</span> sinfo <span class="at">-n</span> nid001053 <span class="at">-o</span> <span class="st">"%n %c %m"</span></span></code></pre>
</div>
</div>
</div>
</div>
<div id="compare-your-computer-the-login-node-and-the-compute-node" class="callout discussion">
<div class="callout-square">
<i class="callout-icon" data-feather="message-circle"></i>
</div>
<span class="callout-header">Discussion</span>
<div id="compare-your-computer-the-login-node-and-the-compute-node" class="callout-inner">
<h3 class="callout-title">Compare Your Computer, the login node and the
compute node</h3>
<div class="callout-content">
<p>Compare your laptop’s number of processors and memory with the
numbers you see on the cluster head node and worker node. Discuss the
differences with your neighbor.</p>
<p>What implications do you think the differences might have on running
your research work on the different systems and nodes?</p>
</div>
</div>
</div>
<p>With all of this in mind, we will now cover how to talk to the
cluster’s scheduler, and use it to start running our scripts and
programs!</p>
<div id="keypoints1" class="callout keypoints">
<div class="callout-square">
<i class="callout-icon" data-feather="key"></i>
</div>
<span class="callout-header">Key Points</span>
<div class="callout-inner">
<div class="callout-content">
<ul>
<li>HPC systems are large, fixed-location clusters designed for
computationally intensive tasks, unlike cloud systems which are flexible
and distributed.</li>
<li>HPC systems typically provide login nodes and a set of worker
nodes.</li>
<li>The resources found on independent (worker) nodes can vary in volume
and type (amount of RAM, processor architecture, availability of network
mounted filesystems, etc.).</li>
<li>Files and environments are often shared across nodes, meaning users
can access their data and run jobs anywhere within the cluster.</li>
</ul>
</div>
</div>
</div>
<!--
Place links that you need to refer to multiple times across pages here. Delete
any links that you are not going to use.

use like [gitbash][gitbash]
 -->
</section></section><section id="aio-13-scheduler"><p>Content from <a href="13-scheduler.html">Working with the scheduler</a></p>
<hr>
<p>Last updated on 2025-10-13 |

        <a href="https://github.com/EPCCed/2025-10-14-archer2-intro-hpc/edit/main/episodes/13-scheduler.Rmd" class="external-link">Edit this page <i aria-hidden="true" data-feather="edit"></i></a></p>
<div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right" data-expand="Expand All Solutions " data-collapse="Collapse All Solutions "> Expand All Solutions <i aria-hidden="true" data-feather="plus"></i></button>
        </div>
<div class="overview card">
<h2 class="card-header">Overview</h2>
<div class="row g-0">
<div class="col-md-4">
<div class="card-body">
<div class="inner">
<h3 class="card-title">Questions</h3>
<ul>
<li>How do I launch a program to run on any one node in the
cluster?</li>
<li>How does an HPC system decide which jobs run, when, and where?</li>
<li>What is a scheduler and how do I use it?</li>
</ul>
</div>
</div>
</div>
<div class="col-md-8">
<div class="card-body">
<div class="inner bordered">
<h3 class="card-title">Objectives</h3>
<ul>
<li>Run a simple program on the cluster.</li>
<li>Submit a simple script to the cluster.</li>
<li>Monitor the execution of your job.</li>
<li>Inspect the output and error files of your jobs.</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<section><h2 class="section-heading" id="job-scheduler">Job Scheduler<a class="anchor" aria-label="anchor" href="#job-scheduler"></a>
</h2>
<hr class="half-width">
<p>An HPC system might have thousands of nodes and thousands of users.
How do we decide who gets what and when? How do we ensure that a task is
run with the resources it needs? This job is handled by a special piece
of software called the scheduler. On an HPC system, the scheduler
manages which jobs run where and when.</p>
<p>The following illustration compares the tasks of a job scheduler to a
waiter in a restaurant. Have you had to wait for a while in a queue to
get in to a popular restaurant? Scheduling a job can be thought of in
the same way!</p>
<figure><img src="fig/restaurant_queue_manager.svg" caption="" alt="Compare a job scheduler to a waiter in a restaurant" class="figure mx-auto d-block"><div class="figcaption">The waiter scheduler</div>
</figure><p>The scheduler used in this lesson is Slurm. Although Slurm is not
used everywhere, running jobs is quite similar regardless of what
software is being used. The exact syntax might change, but the concepts
remain the same.</p>
</section><section><h2 class="section-heading" id="running-a-batch-job">Running a Batch Job<a class="anchor" aria-label="anchor" href="#running-a-batch-job"></a>
</h2>
<hr class="half-width">
<p>The most basic use of the scheduler is to run a command
non-interactively. Any command (or series of commands) that you want to
run on the cluster is called a <em>job</em>, and the process of using a
scheduler to run the job is called <em>batch job submission</em>.</p>
<p>In this case, the job we want to run is just a shell script. Let’s
create a demo shell script to run as a test. The landing pad will have a
number of terminal-based text editors installed. Use whichever you
prefer. Unsure? <code>vim</code> or <code>nano</code> are pretty good,
basic choices.</p>
<div class="codewrapper sourceCode" id="cb1">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a><span class="ex">userid@ln03:~</span><span class="op">&gt;</span> vim example-job.sh</span>
<span id="cb1-2"><a href="#cb1-2" tabindex="-1"></a><span class="ex">userid@ln03:~</span><span class="op">&gt;</span> chmod +x example-job.sh</span>
<span id="cb1-3"><a href="#cb1-3" tabindex="-1"></a><span class="ex">userid@ln03:~</span><span class="op">&gt;</span> cat example-job.sh</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>#!/bin/bash

echo -n "This script is running on "
hostname
echo "This script has finished successfully."</code></pre>
</div>
<div id="creating-our-test-job" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<span class="callout-header">Challenge</span>
<div id="creating-our-test-job" class="callout-inner">
<h3 class="callout-title">Creating Our Test Job</h3>
<div class="callout-content">
<p>Run the script. Does it execute on the cluster or just our login
node?</p>
<div class="codewrapper sourceCode" id="cb3">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb3-1"><a href="#cb3-1" tabindex="-1"></a><span class="ex">userid@ln03:~</span><span class="op">&gt;</span> ./example-job.sh</span></code></pre>
</div>
</div>
</div>
</div>
<div id="accordionSolution1" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution1" aria-expanded="false" aria-controls="collapseSolution1">
  <h4 class="accordion-header" id="headingSolution1"> Show me the solution </h4>
</button>
<div id="collapseSolution1" class="accordion-collapse collapse" data-bs-parent="#accordionSolution1" aria-labelledby="headingSolution1">
<div class="accordion-body">
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>This script is running on ln03
This script has finished successfully.</code></pre>
</div>
<p>This job runs on the login node.</p>
</div>
</div>
</div>
</div>
<p>If you completed the previous challenge successfully, you probably
realise that there is a distinction between running the job through the
scheduler and just “running it”.</p>
<p>We need to submit the job to the scheduler, so we use the
<code>sbatch</code> command.</p>
<div class="codewrapper sourceCode" id="cb5">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb5-1"><a href="#cb5-1" tabindex="-1"></a><span class="ex">userid@ln03:~</span><span class="op">&gt;</span> sbatch <span class="at">--partition</span><span class="op">=</span>standard <span class="at">--qos</span><span class="op">=</span>short example-job.sh</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>sbatch: Your job has no time specification (--time=). The maximum time for the short QoS of 20 minutes has been applied.
sbatch: Warning: It appears your working directory may not be on the work filesystem. It is /home1/home/ta215/ta215/ta215broa1. The home filesystem and RDFaaS are not available from the compute nodes - please check that this is what you intended. You can cancel your job with 'scancel &lt;JOBID&gt;' if you wish to resubmit.
Submitted batch job 11102066</code></pre>
</div>
<p>Ah! What went wrong here? Slurm is telling us that the file system we
are currently on, <code>/home</code>, is not available on the compute
nodes and that we are getting the default, short runtime. We will deal
with the runtime later, but we need to move to a different file system
to submit the job and have it visible to the compute nodes.</p>
<p>On ARCHER2, this is the <code>/work</code> file system. The path is
similar to home but with <code>/work</code> at the start. Lets move
there now, copy our job script across and resubmit:</p>
<div class="codewrapper sourceCode" id="cb7">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb7-1"><a href="#cb7-1" tabindex="-1"></a><span class="ex">userid@ln03:~</span><span class="op">&gt;</span> cd /work/ta215/ta215/userid</span>
<span id="cb7-2"><a href="#cb7-2" tabindex="-1"></a><span class="ex">userid@ln03:/work/ta215/ta215/userid</span><span class="op">&gt;</span> cp ~/example-job.sh .</span>
<span id="cb7-3"><a href="#cb7-3" tabindex="-1"></a><span class="ex">userid@ln03:/work/ta215/ta215/userid</span><span class="op">&gt;</span> sbatch <span class="at">--partition</span><span class="op">=</span>standard <span class="at">--qos</span><span class="op">=</span>short example-job.sh</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>sbatch: Your job has no time specification (--time=). The maximum time for the short QoS of 20 minutes has been applied
Submitted batch job 36855</code></pre>
</div>
<p>That’s better! And that’s all we need to do to submit a job. Our work
is done — now the scheduler takes over and tries to schedule the job to
run on the compute nodes. While the job is waiting to run, it goes into
a list of jobs called the <em>queue</em>. To check on our job’s status,
we can check the queue using the command
<code>squeue -u userid</code>.</p>
<div class="codewrapper sourceCode" id="cb9">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb9-1"><a href="#cb9-1" tabindex="-1"></a><span class="ex">userid@ln03:/work/ta215/ta215/userid</span><span class="op">&gt;</span> squeue <span class="at">-u</span> userid</span></code></pre>
</div>
<p>Or, we can use:</p>
<div class="codewrapper sourceCode" id="cb10">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb10-1"><a href="#cb10-1" tabindex="-1"></a><span class="ex">userid@ln03:/work/ta215/ta215/userid</span><span class="op">&gt;</span> squeue <span class="at">--me</span> </span></code></pre>
</div>
<p>You have to be quick! If you are, you should see an output that looks
like this:</p>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>        JOBID PARTITION     NAME             USER       ST       TIME  NODES NODELIST(REASON)
    11102103  standard      example-job.sh   ta215bro   R       0:01      1 nid001810</code></pre>
</div>
<p>We can see all the details of our job, most importantly that it is in
the <code>R</code> or <code>RUNNING</code> state. Sometimes our jobs
might need to wait in a queue and show the <code>PD</code> or
<code>PENDING</code> state.</p>
<div id="wheres-the-output" class="callout discussion">
<div class="callout-square">
<i class="callout-icon" data-feather="message-circle"></i>
</div>
<span class="callout-header">Discussion</span>
<div id="wheres-the-output" class="callout-inner">
<h3 class="callout-title">Where’s the Output?</h3>
<div class="callout-content">
<p>On the login node, this script printed output to the terminal but now
there’s nothing. Where’d it go? HPC job output is typically redirected
to a file in the directory you launched it from. Use <code>ls</code> to
find and read the file.</p>
</div>
</div>
</div>
<p>The best way to check our job’s status is with <code>squeue</code>.
Of course, running <code>squeue</code> repeatedly to check on things can
be a little tiresome. To see a real-time view of our jobs, we can use
the <code>watch</code> command. <code>watch</code> reruns a given
command at 2-second intervals. This is too frequent for a large machine
like ARCHER2 and <strong>will upset your system administrator.</strong>
You can change the interval to a more reasonable value with the
<code>-n seconds</code> parameter. ARCHER2 system administration
recommmend this to be set for 60 seconds or longer.</p>
<div class="codewrapper sourceCode" id="cb12">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb12-1"><a href="#cb12-1" tabindex="-1"></a><span class="ex">userid@ln03:/work/ta215/ta215/userid</span><span class="op">&gt;</span> sbatch <span class="at">--partition</span><span class="op">=</span>standard <span class="at">--qos</span><span class="op">=</span>short example-job.sh</span>
<span id="cb12-2"><a href="#cb12-2" tabindex="-1"></a><span class="ex">userid@ln03:/work/ta215/ta215/userid</span><span class="op">&gt;</span> watch <span class="at">-n</span> 60 squeue <span class="at">-u</span> userid</span></code></pre>
</div>
<p>You should see an auto-updating display of your job’s status. When it
finishes, it will disappear from the queue. Press <code>Ctrl-c</code>
when you want to stop the <code>watch</code> command.</p>
</section><section><h2 class="section-heading" id="customising-a-job">Customising a Job<a class="anchor" aria-label="anchor" href="#customising-a-job"></a>
</h2>
<hr class="half-width">
<p>The job we just ran used some of the scheduler’s default options. In
a real-world scenario, that’s probably not what we want. The default
options represent a reasonable minimum. Chances are, we will need more
cores, more memory, more time, among other special considerations. To
get access to these resources we must customize our job script.</p>
<p>Comments in UNIX shell scripts (denoted by <code>#</code>) are
typically ignored, but there are exceptions. For instance the special
<code>#!</code> comment at the beginning of scripts specifies what
program should be used to run it (you’ll typically see
<code>#!/bin/bash</code>). Schedulers like Slurm also have a special
comment used to denote special scheduler-specific options. Though these
comments differ from scheduler to scheduler, Slurm’s special comment is
<code>#SBATCH</code>. Anything following the <code>#SBATCH</code>
comment is interpreted as an instruction to the scheduler.</p>
<p>Let’s illustrate this by example. By default, a job’s name is the
name of the script, but the <code>--job-name</code> option can be used
to change the name of a job. Add an option to the
<code>example-job.sh</code> script:</p>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>#!/bin/bash
#SBATCH --job-name=new_name

echo -n "This script is running on "
hostname
echo "This script has finished successfully."</code></pre>
</div>
<p>Submit the job and monitor its status:</p>
<div class="codewrapper sourceCode" id="cb14">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb14-1"><a href="#cb14-1" tabindex="-1"></a><span class="ex">userid@ln03:/work/ta215/ta215/userid</span><span class="op">&gt;</span> sbatch <span class="at">--partition</span><span class="op">=</span>standard <span class="at">--qos</span><span class="op">=</span>short example-job.sh</span>
<span id="cb14-2"><a href="#cb14-2" tabindex="-1"></a><span class="ex">userid@ln03:/work/ta215/ta215/userid</span><span class="op">&gt;</span> squeue <span class="at">-u</span> userid</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>        JOBID PARTITION     NAME       USER       ST       TIME  NODES NODELIST(REASON)
    11102119  standard      new_name   ta215bro   CG       0:02      1 nid004855</code></pre>
</div>
<p>Fantastic, we’ve successfully changed the name of our job!</p>
<p>We can see also see a new job state. The state is reporting as
<code>CG</code> which stands for <code>COMPLETING</code>.</p>
<div class="section level3">
<h3 id="resource-requests">Resource Requests<a class="anchor" aria-label="anchor" href="#resource-requests"></a>
</h3>
<p>But what about more important changes, such as the number of cores
and memory for our jobs? One thing that is absolutely critical when
working on an HPC system is specifying the resources required to run a
job. This allows the scheduler to find the right time and place to
schedule our job. If you do not specify requirements (such as the amount
of time you need), you will likely be stuck with your site’s default
resources or face an error when submitting, which is probably not what
you want.</p>
<p>The following are several key resource requests:</p>
<ul>
<li>
<code>--nodes=&lt;nodes&gt;</code> - Number of nodes to use</li>
<li>
<code>--ntasks-per-node=&lt;tasks-per-node&gt;</code> - Number of
parallel processes per node</li>
<li>
<code>--cpus-per-task=&lt;cpus-per-task&gt;</code> - Number of cores
to assign to each parallel process</li>
<li>
<code>--time=&lt;days-hours:minutes:seconds&gt;</code> - Maximum
real-world time (walltime) your job will be allowed to run. The
<code>&lt;days&gt;</code> part can be omitted.</li>
</ul>
<p>Note that just <em>requesting</em> these resources does not make your
job run faster, nor does it necessarily mean that you will consume all
of these resources. It only means that these are made available to you.
Your job may end up using less time or fewer tasks or nodes, than you
have requested, and it will still run.</p>
<p>It’s best if your requests accurately reflect your job’s
requirements. We’ll talk more about how to make sure that you’re using
resources effectively in a later episode of this lesson.</p>
<div id="command-line-options-or-job-script-options" class="callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<span class="callout-header">Callout</span>
<div id="command-line-options-or-job-script-options" class="callout-inner">
<h3 class="callout-title">Command line options or job script
options?</h3>
<div class="callout-content">
<p>All of the options we specify can be supplied on the command line (as
we do here for <code>--partition=standard</code>) or in the job script
(as we have done for the job name above). These are interchangeable. It
is often more convenient to put the options in the job script as it
avoids lots of typing at the command line.</p>
</div>
</div>
</div>
<div id="submitting-resource-requests" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<span class="callout-header">Challenge</span>
<div id="submitting-resource-requests" class="callout-inner">
<h3 class="callout-title">Submitting Resource Requests</h3>
<div class="callout-content">
<p>Modify our <code>hostname</code> script so that it runs for a minute,
then submit a job for it on the cluster. You should also move all the
options we have been specifying on the command line
(e.g. <code>--partition</code>) into the script at this point.</p>
</div>
</div>
</div>
<div id="accordionSolution2" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution2" aria-expanded="false" aria-controls="collapseSolution2">
  <h4 class="accordion-header" id="headingSolution2"> Show me the solution </h4>
</button>
<div id="collapseSolution2" class="accordion-collapse collapse" data-bs-parent="#accordionSolution2" aria-labelledby="headingSolution2">
<div class="accordion-body">
<div class="codewrapper sourceCode" id="cb16">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb16-1"><a href="#cb16-1" tabindex="-1"></a><span class="ex">userid@ln03:/work/ta215/ta215/userid</span><span class="op">&gt;</span> cat example-job.sh</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>#!/bin/bash
#SBATCH --time 00:01:15
#SBATCH --partition=standard
#SBATCH --qos=short
echo -n "This script is running on "
sleep 60 # time in seconds
hostname
echo "This script has finished successfully."</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb18">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb18-1"><a href="#cb18-1" tabindex="-1"></a><span class="ex">userid@ln03:~</span><span class="op">&gt;</span> sbatch example-job.sh</span></code></pre>
</div>
<p>Why do we not make the Slurm time and <code>sleep</code> time
identical?</p>
</div>
</div>
</div>
</div>
<p>Resource requests are typically binding. If you exceed them, your job
will be killed. Let’s use the walltime as an example. We will request 30
seconds of walltime, and attempt to run a job for two minutes.</p>
<div class="codewrapper sourceCode" id="cb19">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb19-1"><a href="#cb19-1" tabindex="-1"></a><span class="ex">userid@ln03:/work/ta215/ta215/userid</span><span class="op">&gt;</span> cat example-job.sh</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>#!/bin/bash
#SBATCH --job-name long_job
#SBATCH --time 00:00:30
#SBATCH --partition=standard
#SBATCH --qos=short

echo "This script is running on ... "
sleep 120 # time in seconds
hostname
echo "This script has finished successfully."</code></pre>
</div>
<p>Submit the job and wait for it to finish. Once it is has finished,
check the log file.</p>
<div class="codewrapper sourceCode" id="cb21">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb21-1"><a href="#cb21-1" tabindex="-1"></a><span class="ex">userid@ln03:/work/ta215/ta215/userid</span><span class="op">&gt;</span> sbatch example-job.sh</span>
<span id="cb21-2"><a href="#cb21-2" tabindex="-1"></a><span class="ex">userid@ln03:/work/ta215/ta215/userid</span><span class="op">&gt;</span> squeue <span class="at">-u</span> userid</span></code></pre>
</div>
<div class="codewrapper sourceCode" id="cb22">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb22-1"><a href="#cb22-1" tabindex="-1"></a><span class="ex">userid@ln03:/work/ta215/ta215/userid</span><span class="op">&gt;</span> cat slurm-11102156.out</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>This script is running on slurmstepd: error: *** JOB 11102156 ON nid001142 CANCELLED AT 2025-10-08T10:39:46 DUE TO TIME LIMIT ***</code></pre>
</div>
<p>Our job was killed for exceeding the amount of resources it
requested. Although this appears harsh, this is actually a feature.
Strict adherence to resource requests allows the scheduler to find the
best possible place for your jobs. Even more importantly, it ensures
that another user cannot use more resources than they’ve been given. If
another user messes up and accidentally attempts to use all of the cores
or memory on a node, Slurm will either restrain their job to the
requested resources or kill the job outright. Other jobs on the node
will be unaffected. This means that one user cannot mess up the
experience of others, the only jobs affected by a mistake in scheduling
will be their own.</p>
</div>
</section><section><h2 class="section-heading" id="what-else-affects-a-jobs-resources">What else affects a job’s resources?<a class="anchor" aria-label="anchor" href="#what-else-affects-a-jobs-resources"></a>
</h2>
<hr class="half-width">
<p>As well as resources that you specifically request in your job
script, ARCHER2’s resource limits are also definied by two arguments
that must be passed to <code>sbatch</code>: <code>--partition</code> and
<code>--qos</code>.</p>
<p>the <strong>Quality of Service (QoS)</strong> specifies the job
limits that apply.</p>
<p>The reason for the QoS is so that user’s are restricted to certain
time limits or certain numbers of jobs, to help ensure fair and shared
use of the machine. This is a difficult balance to make as we want to
ensure that reearchers can use the full computational power of the
machine, but also want to ensure that many researchers can do science
all at the same time.</p>
<div class="section level3">
<h3 id="partitions">Partitions<a class="anchor" aria-label="anchor" href="#partitions"></a>
</h3>
<p>The <strong>partition</strong> specifies the nodes that are eligible
to run your job. This is so that users can ask for more memory, run in
serial or run with GPUs. The partitions help to accommodate different
types of workloads, all running on the same machine.</p>
<table class="table">
<thead><tr class="header">
<th>Partition</th>
<th>Description</th>
<th>Max nodes available</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>standard</td>
<td>CPU nodes 256/512 GB memory</td>
<td>5860</td>
</tr>
<tr class="even">
<td>highmem</td>
<td>CPU nodes 512 GB memory</td>
<td>584</td>
</tr>
<tr class="odd">
<td>serial</td>
<td>CPU nodes 512 GB memory</td>
<td>2</td>
</tr>
<tr class="even">
<td>gpu</td>
<td>GPU nodes 512 GB memory</td>
<td>4</td>
</tr>
</tbody>
</table>
</div>
<div class="section level3">
<h3 id="qos">QoS<a class="anchor" aria-label="anchor" href="#qos"></a>
</h3>
<p>The <strong>Quality of Service (QoS)</strong> specifies the job
limits that apply. This is so that users are restricted to certain time
limits or certain numbers of jobs, to help ensure fair and shared use of
the machine. This is a difficult balance to make as we want to ensure
that reearchers can use the full computational power of the machine, but
also want to ensure that many researchers can do science all at the same
time.</p>
<table class="table">
<colgroup>
<col width="12%">
<col width="21%">
<col width="15%">
<col width="13%">
<col width="15%">
<col width="15%">
<col width="7%">
</colgroup>
<thead><tr class="header">
<th>QoS</th>
<th>Max Nodes Per Job</th>
<th>Max Walltime</th>
<th>Jobs Queued</th>
<th>Jobs Running</th>
<th>Partition(s)</th>
<th>Notes</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>standard</td>
<td>1024</td>
<td>24 hrs</td>
<td>64</td>
<td>16</td>
<td>standard</td>
<td>Max 1024 nodes</td>
</tr>
<tr class="even">
<td>highmem</td>
<td>256</td>
<td>24 hrs</td>
<td>16</td>
<td>16</td>
<td>highmem</td>
<td>Max 256 nodes</td>
</tr>
<tr class="odd">
<td>taskfarm</td>
<td>16</td>
<td>24 hrs</td>
<td>128</td>
<td>32</td>
<td>standard</td>
<td>Max 256 nodes</td>
</tr>
<tr class="even">
<td>short</td>
<td>32</td>
<td>20 mins</td>
<td>16</td>
<td>4</td>
<td>standard</td>
<td></td>
</tr>
<tr class="odd">
<td>long</td>
<td>64</td>
<td>96 hrs</td>
<td>16</td>
<td>16</td>
<td>standard</td>
<td>Min 24hr walltime, max 512 nodes</td>
</tr>
<tr class="even">
<td>largescale</td>
<td>5860</td>
<td>12 hrs</td>
<td>8</td>
<td>1</td>
<td>standard</td>
<td>Min 1025 nodes</td>
</tr>
<tr class="odd">
<td>lowpriority</td>
<td>2048</td>
<td>24 hrs</td>
<td>16</td>
<td>16</td>
<td>standard</td>
<td>Jobs not charged, requires &lt;= 1 CU in budget.</td>
</tr>
<tr class="even">
<td>serial</td>
<td>32 cores and/or 128 GB memory</td>
<td>24 hrs</td>
<td>32</td>
<td>4</td>
<td>serial</td>
<td>Jobs not charged, requires &lt;= 1 CU in budget. Max 32 cores and/or
128 GB.</td>
</tr>
<tr class="odd">
<td>reservation</td>
<td>Size of reservation</td>
<td>Length of reservation</td>
<td>No limit</td>
<td>no limit</td>
<td>standard</td>
<td></td>
</tr>
<tr class="even">
<td>capabilityday</td>
<td>At least 4096 nodes</td>
<td>3 hrs</td>
<td>8</td>
<td>2</td>
<td>standard</td>
<td>Min 512 nodes. Only Capability Days</td>
</tr>
<tr class="odd">
<td>gpu-shd</td>
<td>1</td>
<td>12 hrs</td>
<td>2</td>
<td>1</td>
<td>gpu</td>
<td>potentially shared with other users</td>
</tr>
<tr class="even">
<td>gpu-exc</td>
<td>2</td>
<td>12 hrs</td>
<td>2</td>
<td>1</td>
<td>gpu</td>
<td>exclusive node access</td>
</tr>
</tbody>
</table>
<div id="but-how-much-does-it-cost" class="callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<span class="callout-header">Callout</span>
<div id="but-how-much-does-it-cost" class="callout-inner">
<h3 class="callout-title">But how much does it cost?</h3>
<div class="callout-content">
<p>Although your job will be killed if it exceeds the selected runtime,
a job that completes within the time limit is only charged for the time
it actually used. However, you should always try and specify a wallclock
limit that is close to (but greater than!) the expected runtime as this
will enable your job to be scheduled more quickly.</p>
<p>If you say your job will run for an hour, the scheduler has to wait
until a full hour becomes free on the machine. If it only ever runs for
5 minutes, you could have set a limit of 10 minutes and it might have
been run earlier in the gaps between other users’ jobs.</p>
</div>
</div>
</div>
</div>
</section><section><h2 class="section-heading" id="cancelling-a-job">Cancelling a Job<a class="anchor" aria-label="anchor" href="#cancelling-a-job"></a>
</h2>
<hr class="half-width">
<p>Sometimes we’ll make a mistake and need to cancel a job. This can be
done with the <code>scancel</code> command. Let’s submit a job and then
cancel it using its job ID number (remember to change the walltime so
that it runs long enough for you to cancel it before it is killed!).</p>
<div class="codewrapper sourceCode" id="cb24">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb24-1"><a href="#cb24-1" tabindex="-1"></a><span class="ex">userid@ln03:/work/ta215/ta215/userid</span><span class="op">&gt;</span> sbatch example-job.sh</span>
<span id="cb24-2"><a href="#cb24-2" tabindex="-1"></a><span class="ex">userid@ln03:/work/ta215/ta215/userid</span><span class="op">&gt;</span> squeue <span class="at">-u</span> userid</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>Submitted batch job 11102156

             JOBID PARTITION     NAME     USER ST       TIME  NODES NODELIST(REASON)
          11102156  standard example- ta215bro  R       0:18      1 nid001142</code></pre>
</div>
<p>Now cancel the job with its job number (printed in your terminal).
Absence of any job info indicates that the job has been successfully
cancelled.</p>
<div class="codewrapper sourceCode" id="cb26">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb26-1"><a href="#cb26-1" tabindex="-1"></a><span class="ex">userid@ln03:/work/ta215/ta215/userid</span><span class="op">&gt;</span> scancel 11102156</span>
<span id="cb26-2"><a href="#cb26-2" tabindex="-1"></a><span class="ex">userid@ln03:/work/ta215/ta215/userid</span><span class="op">&gt;</span> squeue <span class="at">-u</span> userid</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>             JOBID PARTITION     NAME     USER ST       TIME  NODES NODELIST(REASON)</code></pre>
</div>
<div id="cancelling-multiple-jobs" class="callout discussion">
<div class="callout-square">
<i class="callout-icon" data-feather="message-circle"></i>
</div>
<span class="callout-header">Discussion</span>
<div id="cancelling-multiple-jobs" class="callout-inner">
<h3 class="callout-title">Cancelling multiple jobs</h3>
<div class="callout-content">
<p>We can also cancel all of our jobs at once using the <code>-u</code>
option. This will delete all jobs for a specific user (in this case us).
Note that you can only delete your own jobs. Try submitting multiple
jobs and then cancelling them all with
<code>scancel -u yourUsername</code>.</p>
</div>
</div>
</div>
</section><section><h2 class="section-heading" id="other-types-of-jobs">Other Types of Jobs<a class="anchor" aria-label="anchor" href="#other-types-of-jobs"></a>
</h2>
<hr class="half-width">
<p>Up to this point we’ve focused on running jobs in batch mode, but
Slurm also provides the ability to start an interactive session. There
are very frequently tasks that need to be done interactively. For
example, when we want to debug something that went wrong with a previous
job. The amount of resources needed is too much for a login node, but
writing an entire job script is overkill.</p>
<p>In this instance, we can run these types of tasks as a one-off with
<code>srun</code>.</p>
<p><code>srun</code> runs a single command in the queue system and then
exits. Let’s demonstrate this by running the <code>hostname</code>
command with <code>srun</code>. (We can cancel an <code>srun</code> job
with <code>Ctrl-c</code>.)</p>
<div class="codewrapper sourceCode" id="cb28">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb28-1"><a href="#cb28-1" tabindex="-1"></a> <span class="ex">srun</span> <span class="at">--partition</span><span class="op">=</span>standard <span class="at">--qos</span><span class="op">=</span>short <span class="at">--time</span><span class="op">=</span>00:01:00 hostname</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>srun: job 11102176 queued and waiting for resources
srun: job 11102176 has been allocated resources
nid001810</code></pre>
</div>
<p><code>srun</code> accepts all of the same options as
<code>sbatch</code>. However, instead of specifying these in a script,
these options are specified on the command-line when starting a job.</p>
<p>Typically, the resulting shell environment will be the same as that
for <code>sbatch</code>.</p>
</section><section><h2 class="section-heading" id="running-parallel-jobs-using-mpi">Running parallel jobs using MPI<a class="anchor" aria-label="anchor" href="#running-parallel-jobs-using-mpi"></a>
</h2>
<hr class="half-width">
<p>The power of HPC systems comes from <em>parallelism</em>. That is,
connecting many processors, disks, and other components to work
together, rather than relying on having more powerful components than
your laptop or workstation.</p>
<p>Often, when running research programs on HPC you will need to run a
program that has been built to use the MPI (Message Passing Interface)
parallel library for parallel computing. MPI enables programs to take
advantage of multiple processing cores in parallel, allowing researchers
to run large simulations or models more quickly.</p>
<p>The details of how MPI works is not important for this course.
However, it’s important to know that MPI programs are launched
differently from serial programs, and you’ll need to submit them
correctly in your job submission scrips. Specifically, launching
parallel MPI programs typically requires four things:</p>
<ul>
<li>A special parallel launch program such as <code>mpirun</code>,
<code>mpiexec</code>, <code>srun</code> or <code>aprun</code>.</li>
<li>A specification of how many processes to use in parallel. For
example, our parallel program may use 256 processes in parallel.</li>
<li>A specification of how many parallel processes to use per compute
node. For example, if our compute nodes each have 32 cores we can
specify up to 32 parallel processes per node.</li>
<li>The command and arguments for our parallel program.</li>
</ul>
<div id="required-files" class="callout prereq">
<div class="callout-square">
<i class="callout-icon" data-feather="check"></i>
</div>
<span class="callout-header">Prerequisite</span>
<div id="required-files" class="callout-inner">
<h3 class="callout-title">Required Files</h3>
<div class="callout-content">
<p>The program used in this example can be retrieved using wget or a
browser and copied to the remote.</p>
<p><strong>Using wget</strong>:</p>
<div class="codewrapper sourceCode" id="cb30">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb30-1"><a href="#cb30-1" tabindex="-1"></a><span class="ex">userid@ln03:~</span><span class="op">&gt;</span> wget https://epcced.github.io/2025-10-14-archer2-intro-hpc/files/pi-mpi.py</span></code></pre>
</div>
<p><strong>Download via web browser</strong>:</p>
<p><a href="https://epcced.github.io/2025-10-14-archer2-intro-hpc/files/pi-mpi.py" class="external-link">https://epcced.github.io/2025-10-14-archer2-intro-hpc/files/pi-mpi.py</a></p>
</div>
</div>
</div>
<p>To illustrate this process, we will use a simple MPI parallel program
that estimates the value of Pi - <em>We will meet this example program
in more detail in a later episode of this course.</em></p>
<p>Here is a job submission script that runs the program on 1 compute
node, using 16 parallel tasks (or cores) on the cluster. Create a job
submission script (e.g. called: <code>run-pi-mpi.slurm</code>) with the
following contents:</p>
<div class="codewrapper sourceCode" id="cb31">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb31-1"><a href="#cb31-1" tabindex="-1"></a><span class="co">#!/bin/bash</span></span>
<span id="cb31-2"><a href="#cb31-2" tabindex="-1"></a></span>
<span id="cb31-3"><a href="#cb31-3" tabindex="-1"></a><span class="co">#SBATCH --partition=standard</span></span>
<span id="cb31-4"><a href="#cb31-4" tabindex="-1"></a><span class="co">#SBATCH --qos=short</span></span>
<span id="cb31-5"><a href="#cb31-5" tabindex="-1"></a><span class="co">#SBATCH --time=00:05:00</span></span>
<span id="cb31-6"><a href="#cb31-6" tabindex="-1"></a></span>
<span id="cb31-7"><a href="#cb31-7" tabindex="-1"></a><span class="co">#SBATCH --nodes=1</span></span>
<span id="cb31-8"><a href="#cb31-8" tabindex="-1"></a><span class="co">#SBATCH --ntasks-per-node=16</span></span>
<span id="cb31-9"><a href="#cb31-9" tabindex="-1"></a></span>
<span id="cb31-10"><a href="#cb31-10" tabindex="-1"></a><span class="ex">module</span> load cray-python</span>
<span id="cb31-11"><a href="#cb31-11" tabindex="-1"></a></span>
<span id="cb31-12"><a href="#cb31-12" tabindex="-1"></a><span class="ex">srun</span> python pi-mpi.py 10000000</span></code></pre>
</div>
<p>The parallel launch line for our program can be seen towards the
bottom of the script:</p>
<div class="codewrapper sourceCode" id="cb32">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb32-1"><a href="#cb32-1" tabindex="-1"></a><span class="ex">srun</span> python pi-mpi.py 10000000</span></code></pre>
</div>
<p>And this corresponds to the four required items we described
above:</p>
<ol style="list-style-type: decimal">
<li>Parallel launch program: in this case the parallel launch program is
called <code>srun</code>; the additional argument controls which cores
are used.</li>
<li>Number of parallel processes per node: in this case this is 16, and
is specified by the option <code>--ntasks-per-node=16</code>
option.</li>
<li>Total number of parallel processes: in this case this is also 16,
because we specified 1 node and 16 parallel processes per node.</li>
<li>Our program and arguments: in this case this is
<code>python pi-mpi.py 10000000</code>.</li>
</ol>
<p>We can now launch using the <code>sbatch</code> command.</p>
<div class="codewrapper sourceCode" id="cb33">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb33-1"><a href="#cb33-1" tabindex="-1"></a><span class="ex">userid@ln03:/work/ta215/ta215/userid</span><span class="op">&gt;</span> sbatch run-pi-mpi.slurm</span></code></pre>
</div>
<div id="running-parallel-jobs" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<span class="callout-header">Challenge</span>
<div id="running-parallel-jobs" class="callout-inner">
<h3 class="callout-title">Running parallel jobs</h3>
<div class="callout-content">
<p>Modify the pi-mpi-run script that you used above to use all 128 cores
on one node. Check the output to confirm that it used the correct number
of cores in parallel for the calculation.</p>
</div>
</div>
</div>
<div id="accordionSolution3" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution3" aria-expanded="false" aria-controls="collapseSolution3">
  <h4 class="accordion-header" id="headingSolution3"> Show me the solution </h4>
</button>
<div id="collapseSolution3" class="accordion-collapse collapse" data-bs-parent="#accordionSolution3" aria-labelledby="headingSolution3">
<div class="accordion-body">
<p>Here is a modified script</p>
<div class="codewrapper sourceCode" id="cb34">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb34-1"><a href="#cb34-1" tabindex="-1"></a><span class="co">#!/bin/bash</span></span>
<span id="cb34-2"><a href="#cb34-2" tabindex="-1"></a></span>
<span id="cb34-3"><a href="#cb34-3" tabindex="-1"></a><span class="co">#SBATCH --partition=standard</span></span>
<span id="cb34-4"><a href="#cb34-4" tabindex="-1"></a><span class="co">#SBATCH --qos=short</span></span>
<span id="cb34-5"><a href="#cb34-5" tabindex="-1"></a><span class="co">#SBATCH --time=00:00:30</span></span>
<span id="cb34-6"><a href="#cb34-6" tabindex="-1"></a></span>
<span id="cb34-7"><a href="#cb34-7" tabindex="-1"></a><span class="co">#SBATCH --nodes=1</span></span>
<span id="cb34-8"><a href="#cb34-8" tabindex="-1"></a><span class="co">#SBATCH --ntasks-per-node=128</span></span>
<span id="cb34-9"><a href="#cb34-9" tabindex="-1"></a></span>
<span id="cb34-10"><a href="#cb34-10" tabindex="-1"></a><span class="ex">module</span> load cray-python</span>
<span id="cb34-11"><a href="#cb34-11" tabindex="-1"></a><span class="ex">srun</span> python pi-mpi.py 10000000</span></code></pre>
</div>
</div>
</div>
</div>
</div>
<div id="configuring-parallel-jobs" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<span class="callout-header">Challenge</span>
<div id="configuring-parallel-jobs" class="callout-inner">
<h3 class="callout-title">Configuring parallel jobs</h3>
<div class="callout-content">
<p>You will see in the job output that information is displayed about
where each MPI process is running, in particular which node it is
on.</p>
<p>Modify the pi-mpi-run script so that you run with 2 nodes and a total
of 16 processes; but use only 8 tasks on each of two nodes. Check the
output file to ensure that you understand the job distribution.</p>
</div>
</div>
</div>
<div id="accordionSolution4" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution4" aria-expanded="false" aria-controls="collapseSolution4">
  <h4 class="accordion-header" id="headingSolution4"> Show me the solution </h4>
</button>
<div id="collapseSolution4" class="accordion-collapse collapse" data-bs-parent="#accordionSolution4" aria-labelledby="headingSolution4">
<div class="accordion-body">
<div class="codewrapper sourceCode" id="cb35">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb35-1"><a href="#cb35-1" tabindex="-1"></a><span class="co">#!/bin/bash</span></span>
<span id="cb35-2"><a href="#cb35-2" tabindex="-1"></a></span>
<span id="cb35-3"><a href="#cb35-3" tabindex="-1"></a><span class="co">#SBATCH --partition=standard</span></span>
<span id="cb35-4"><a href="#cb35-4" tabindex="-1"></a><span class="co">#SBATCH --qos=short</span></span>
<span id="cb35-5"><a href="#cb35-5" tabindex="-1"></a><span class="co">#SBATCH --time=00:00:30</span></span>
<span id="cb35-6"><a href="#cb35-6" tabindex="-1"></a></span>
<span id="cb35-7"><a href="#cb35-7" tabindex="-1"></a><span class="co">#SBATCH --nodes=2</span></span>
<span id="cb35-8"><a href="#cb35-8" tabindex="-1"></a><span class="co">#SBATCH --ntasks-per-node=8</span></span>
<span id="cb35-9"><a href="#cb35-9" tabindex="-1"></a></span>
<span id="cb35-10"><a href="#cb35-10" tabindex="-1"></a><span class="ex">module</span> load cray-python</span>
<span id="cb35-11"><a href="#cb35-11" tabindex="-1"></a><span class="ex">srun</span> python pi-mpi.py 10000000</span></code></pre>
</div>
</div>
</div>
</div>
</div>
<div id="keypoints1" class="callout keypoints">
<div class="callout-square">
<i class="callout-icon" data-feather="key"></i>
</div>
<span class="callout-header">Key Points</span>
<div class="callout-inner">
<div class="callout-content">
<ul>
<li>Schedulers manage fairness and efficiency on HPC systems, deciding
which user jobs run and when.</li>
<li>A job is any command or script submitted for execution.</li>
<li>Jobs should not run on login nodes — they must be submitted to the
scheduler.</li>
<li>The scheduler handles how compute resources are shared between
users, on ARCHER2 this is through the <code>partition</code> and
<code>qos</code> options.</li>
<li>MPI jobs require special launch commands (srun, mpirun, etc.) and
explicit process counts to utilize multiple cores or nodes
effectively.</li>
</ul>
</div>
</div>
</div>
<!--
Place links that you need to refer to multiple times across pages here. Delete
any links that you are not going to use.

use like [gitbash][gitbash]
 -->
</section></section><section id="aio-14-modules"><p>Content from <a href="14-modules.html">Accessing software via Modules</a></p>
<hr>
<p>Last updated on 2025-10-13 |

        <a href="https://github.com/EPCCed/2025-10-14-archer2-intro-hpc/edit/main/episodes/14-modules.Rmd" class="external-link">Edit this page <i aria-hidden="true" data-feather="edit"></i></a></p>
<div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right" data-expand="Expand All Solutions " data-collapse="Collapse All Solutions "> Expand All Solutions <i aria-hidden="true" data-feather="plus"></i></button>
        </div>
<div class="overview card">
<h2 class="card-header">Overview</h2>
<div class="row g-0">
<div class="col-md-4">
<div class="card-body">
<div class="inner">
<h3 class="card-title">Questions</h3>
<ul>
<li>How do we load and unload software packages?</li>
</ul>
</div>
</div>
</div>
<div class="col-md-8">
<div class="card-body">
<div class="inner bordered">
<h3 class="card-title">Objectives</h3>
<ul>
<li>Understand how to load and use a software package.</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<p>On a HPC system, it is seldom the case that the software we want to
use is available when we log in. It may be installed, but we will need
to “load” it before it can run.</p>
<p>Before we start using individual software packages, however, we
should understand the reasoning behind this approach. The three biggest
factors are:</p>
<div class="section level3">
<h3 id="software-incompatibilities">Software incompatibilities<a class="anchor" aria-label="anchor" href="#software-incompatibilities"></a>
</h3>
<p>Software incompatibility is a major headache for programmers.
Sometimes the presence (or absence) of a software package will break
others that depend on it. Two of the most famous examples are Python 2
vs 3 and C compiler versions: - Python 3 famously provides a
<code>python</code> command that conflicts with that provided by Python
2. - Software compiled against a newer version of the C libraries and
then used when they are not present will result in a nasty
<code>'GLIBCXX_3.4.20' not found</code> error.</p>
</div>
<div class="section level3">
<h3 id="versioning">Versioning<a class="anchor" aria-label="anchor" href="#versioning"></a>
</h3>
<p>Software versioning is another common issue. A team might depend on a
certain package version for their research project - if the software
version was to change (for instance, if a package was updated), it might
affect their results. Having access to multiple software versions on the
same system helps to prevent software versioning issues from affecting
their results.</p>
</div>
<div class="section level3">
<h3 id="dependencies">Dependencies<a class="anchor" aria-label="anchor" href="#dependencies"></a>
</h3>
<p>Dependencies are where a particular software package (or even a
particular version) depends on having access to another software package
(or even a particular version of another software package). For example,
the VASP materials science software may depend on having a particular
version of the FFTW (Fastest Fourier Transform in the West) software
library available for it to work. Therefore, it is useful to have
multiple versions available for multiple use cases.</p>
</div>
<section><h2 class="section-heading" id="environment-modules">Environment Modules<a class="anchor" aria-label="anchor" href="#environment-modules"></a>
</h2>
<hr class="half-width">
<p>Environment modules are the solution to these problems. A
<em>module</em> is a self-contained description of a software package -
it contains the settings required to run a software package and,
usually, encodes required dependencies on other software packages.</p>
<p>There are a number of different environment module implementations
commonly used on HPC systems: the two most common are <em>TCL
modules</em> and <em>Lmod</em>. Both of these use similar syntax and the
concepts are the same so learning to use one will allow you to use
whichever is installed on the system you are using. In both
implementations the <code>module</code> command is used to interact with
environment modules. An additional subcommand is usually added to the
command to specify what you want to do. For a list of subcommands you
can use <code>module -h</code> or <code>module help</code>. As for all
commands, you can access the full help on the <em>man</em> pages with
<code>man module</code>.</p>
<p>On login you may start out with a default set of modules loaded or
you may start out with an empty environment; this depends on the setup
of the system you are using.</p>
<div class="section level3">
<h3 id="listing-available-modules">Listing Available Modules<a class="anchor" aria-label="anchor" href="#listing-available-modules"></a>
</h3>
<p>To see available software modules, use <code>module avail</code>:</p>
<div class="codewrapper sourceCode" id="cb1">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a><span class="ex">userid@ln03:/work/ta215/ta215/userid</span><span class="op">&gt;</span> module avail</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>-------------------------------------------------------------- /opt/cray/pe/lmod/modulefiles/core ---------------------------------------------------------------
   PrgEnv-amd/8.3.3      (D)      aocc/4.0.0        (D)      cray-cti/2.16.0                    cray-pals/1.2.5      (D)      gdb4hpc/4.14.6         (D)
   PrgEnv-amd/8.4.0               atp/3.14.16       (D)      cray-cti/2.17.1           (D)      cray-pals/1.2.12              gdb4hpc/4.15.1
   PrgEnv-aocc/8.3.3     (D)      atp/3.15.1                 cray-cti/2.18.1                    cray-pmi/6.1.8       (D)      iobuf/2.0.10
   PrgEnv-aocc/8.4.0              cce/15.0.0        (L,D)    cray-dsmml/0.2.2          (L)      cray-pmi/6.1.12               papi/6.0.0.17          (D)
   PrgEnv-cray-amd/8.3.3          cce/16.0.1                 cray-dyninst/12.1.1       (D)      cray-python/3.9.13.1 (D)      papi/7.0.1.1
   PrgEnv-cray-amd/8.4.0 (D)      cpe-cuda/22.12    (D)      cray-dyninst/12.3.0                cray-python/3.10.10           perftools-base/22.12.0 (L,D)
   PrgEnv-cray/8.3.3     (L,D)    cpe-cuda/23.09             cray-libpals/1.2.5        (D)      cray-stat/4.11.13    (D)      perftools-base/23.09.0
   PrgEnv-cray/8.4.0              cpe/22.12         (D)      cray-libpals/1.2.12                cray-stat/4.12.1              rocm/5.2.3
   PrgEnv-gnu-amd/8.3.3           cpe/23.09                  cray-libsci/22.12.1.1     (L,D)    craype/2.7.19        (L,D)    sanitizers4hpc/1.0.4   (D)
   PrgEnv-gnu-amd/8.4.0  (D)      cray-R/4.2.1.1    (D)      cray-libsci/23.09.1.1              craype/2.7.23                 sanitizers4hpc/1.1.1
   PrgEnv-gnu/8.3.3      (D)      cray-R/4.2.1.2             cray-libsci_acc/22.12.1.1 (D)      craypkg-gen/1.3.28   (D)      valgrind4hpc/2.12.10   (D)
   PrgEnv-gnu/8.4.0               cray-ccdb/4.12.13 (D)      cray-libsci_acc/23.09.1.1          craypkg-gen/1.3.30            valgrind4hpc/2.13.1
   amd/5.2.3                      cray-ccdb/5.0.1            cray-mrnet/5.0.4          (D)      gcc/10.3.0
   aocc/3.2.0                     cray-cti/2.15.14           cray-mrnet/5.1.1                   gcc/11.2.0           (D)

----------------------------------------------------- /opt/cray/pe/lmod/modulefiles/craype-targets/default ------------------------------------------------------
   craype-accel-amd-gfx908    craype-arm-grace        craype-hugepages2G      craype-hugepages64M        craype-x86-genoa          craype-x86-spr
   craype-accel-amd-gfx90a    craype-hugepages128M    craype-hugepages2M      craype-hugepages8M         craype-x86-milan-x        craype-x86-trento
   craype-accel-host          craype-hugepages16M     craype-hugepages32M     craype-network-none        craype-x86-milan
   craype-accel-nvidia70      craype-hugepages1G      craype-hugepages4M      craype-network-ofi  (L)    craype-x86-rome    (L)
   craype-accel-nvidia80      craype-hugepages256M    craype-hugepages512M    craype-network-ucx         craype-x86-spr-hbm

...

Many more

...
</code></pre>
</div>
</div>
<div class="section level3">
<h3 id="listing-currently-loaded-modules">Listing Currently Loaded Modules<a class="anchor" aria-label="anchor" href="#listing-currently-loaded-modules"></a>
</h3>
<p>You can use the <code>module list</code> command to see which modules
you currently have loaded in your environment. If you have no modules
loaded, you will see a message telling you so</p>
<div class="codewrapper sourceCode" id="cb3">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb3-1"><a href="#cb3-1" tabindex="-1"></a><span class="ex">userid@ln03:/work/ta215/ta215/userid</span><span class="op">&gt;</span> module list</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>Currently Loaded Modules:
  1) craype-x86-rome                         6) cce/15.0.0             11) PrgEnv-cray/8.3.3
  2) libfabric/1.12.1.2.2.0.0                7) craype/2.7.19          12) bolt/0.8
  3) craype-network-ofi                      8) cray-dsmml/0.2.2       13) epcc-setup-env
  4) perftools-base/22.12.0                  9) cray-mpich/8.1.23      14) load-epcc-module
  5) xpmem/2.5.2-2.4_3.30__gd0f7936.shasta  10) cray-libsci/22.12.1.1</code></pre>
</div>
</div>
</section><section><h2 class="section-heading" id="loading-and-unloading-software">Loading and Unloading Software<a class="anchor" aria-label="anchor" href="#loading-and-unloading-software"></a>
</h2>
<hr class="half-width">
<p>To load a software module, use <code>module load</code>. Let’s say we
would like to use the HDF5 utility <code>h5dump</code>.</p>
<p>On login, <code>h5dump</code> is not available. We can test this by
using the <code>which</code> command. <code>which</code> looks for
programs the same way that Bash does, so we can use it to tell us where
a particular piece of software is stored.</p>
<div class="codewrapper sourceCode" id="cb5">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb5-1"><a href="#cb5-1" tabindex="-1"></a> <span class="fu">which</span> h5dump</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>which: no h5dump in (/work/y07/shared/utils/core/bolt/0.8/bin:/mnt/lustre/a2fs-work4/work/y07/shared/utils/core/bin:/opt/cray/pe/mpich/8.1.23/ofi/crayclang/10.0/bin:/opt/cray/pe/mpich/8.1.23/bin:/opt/cray/pe/craype/2.7.19/bin:/opt/cray/pe/cce/15.0.0/binutils/x86_64/x86_64-pc-linux-gnu/bin:/opt/cray/pe/cce/15.0.0/binutils/cross/x86_64-aarch64/aarch64-linux-gnu/../bin:/opt/cray/pe/cce/15.0.0/utils/x86_64/bin:/opt/cray/pe/cce/15.0.0/bin:/opt/cray/pe/cce/15.0.0/cce-clang/x86_64/bin:/opt/cray/pe/perftools/22.12.0/bin:/opt/cray/pe/papi/6.0.0.17/bin:/opt/cray/libfabric/1.12.1.2.2.0.0/bin:/usr/local/bin:/usr/bin:/bin:/usr/lib/mit/bin:/opt/cray/pe/bin)</code></pre>
</div>
<p>We can find the <code>h5dump</code> command by using
<code>module load</code>:</p>
<div class="codewrapper sourceCode" id="cb7">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb7-1"><a href="#cb7-1" tabindex="-1"></a> <span class="ex">module</span> load cray-hdf5</span>
<span id="cb7-2"><a href="#cb7-2" tabindex="-1"></a> <span class="fu">which</span> h5dump</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>/opt/cray/pe/hdf5/1.12.2.1/bin/h5dump</code></pre>
</div>
<p>So, what just happened?</p>
<p>To understand the output, first we need to understand the nature of
the <code>$PATH</code> environment variable. <code>$PATH</code> is a
special environment variable that controls where a UNIX system looks for
software. Specifically, <code>$PATH</code> is a list of directories
(separated by <code>:</code>) that the OS searches through for a command
before giving up and telling us it can’t find it. As with all
environment variables we can print it out using <code>echo</code>.</p>
<div class="codewrapper sourceCode" id="cb9">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb9-1"><a href="#cb9-1" tabindex="-1"></a> <span class="bu">echo</span> <span class="va">$PATH</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>/opt/cray/pe/hdf5/1.12.2.1/bin:/work/y07/shared/utils/core/bolt/0.8/bin:/mnt/lustre/a2fs-work4/work/y07/shared/utils/core/bin:/opt/cray/pe/mpich/8.1.23/ofi/crayclang/10.0/bin:/opt/cray/pe/mpich/8.1.23/bin:/opt/cray/pe/craype/2.7.19/bin:/opt/cray/pe/cce/15.0.0/binutils/x86_64/x86_64-pc-linux-gnu/bin:/opt/cray/pe/cce/15.0.0/binutils/cross/x86_64-aarch64/aarch64-linux-gnu/../bin:/opt/cray/pe/cce/15.0.0/utils/x86_64/bin:/opt/cray/pe/cce/15.0.0/bin:/opt/cray/pe/cce/15.0.0/cce-clang/x86_64/bin:/opt/cray/pe/perftools/22.12.0/bin:/opt/cray/pe/papi/6.0.0.17/bin:/opt/cray/libfabric/1.12.1.2.2.0.0/bin:/usr/local/bin:/usr/bin:/bin:/usr/lib/mit/bin:/opt/cray/pe/bin</code></pre>
</div>
<p>You’ll notice a similarity to the output of the <code>which</code>
command. In this case, there’s only one difference: the different
directory at the beginning. When we ran the <code>module load</code>
command, it added a directory to the beginning of our
<code>$PATH</code>. Let’s examine what’s there:</p>
<div class="codewrapper sourceCode" id="cb11">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb11-1"><a href="#cb11-1" tabindex="-1"></a> <span class="fu">ls</span> /opt/cray/pe/hdf5/1.12.2.1/bin/</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>gif2h5	h5c++  h5clear	h5debug  h5dump  h5format_convert  h5jam  h5mkgrp	 h5redeploy  h5repart  h5unjam
h52gif	h5cc   h5copy	h5diff	 h5fc	 h5import	   h5ls   h5perf_serial  h5repack    h5stat    h5watch</code></pre>
</div>
<p>In summary, <code>module load</code> will add software to your
<code>$PATH</code>. <code>module load</code> may also load additional
modules with software dependencies.</p>
<p>To unload a module, use <code>module unload</code> with the relevant
module name.</p>
<div id="unload" class="callout discussion">
<div class="callout-square">
<i class="callout-icon" data-feather="message-circle"></i>
</div>
<span class="callout-header">Discussion</span>
<div id="unload" class="callout-inner">
<h3 class="callout-title">Unload!</h3>
<div class="callout-content">
<p>Confirm you can unload the <code>cray-hdf5</code> module and check
what happens to the <code>PATH</code> environment variable.</p>
</div>
</div>
</div>
</section><section><h2 class="section-heading" id="software-versioning">Software versioning<a class="anchor" aria-label="anchor" href="#software-versioning"></a>
</h2>
<hr class="half-width">
<p>So far, we’ve learned how to load and unload software packages. This
is very useful, however we have not yet addressed the issue of software
versioning. At some point or other, you will run into issues where only
one particular version of some software will be suitable. Perhaps a key
bugfix only happened in a certain version, or version X broke
compatibility with a file format you use. In either of these example
cases, it helps to be very specific about what software is loaded.</p>
<p>Let’s examine the output of <code>module avail</code> more
closely.</p>
<div class="codewrapper sourceCode" id="cb13">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb13-1"><a href="#cb13-1" tabindex="-1"></a> <span class="ex">module</span> avail cray-hdf5</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>---------------- /opt/cray/pe/lmod/modulefiles/mpi/crayclang/14.0/ofi/1.0/cray-mpich/8.0 ----------------
   cray-hdf5-parallel/1.12.2.1 (D)    cray-hdf5-parallel/1.12.2.7

---------------- /opt/cray/pe/lmod/modulefiles/compiler/crayclang/14.0 ----------------------------------
   cray-hdf5/1.12.2.1 (L,D)    cray-hdf5/1.12.2.7

  Where:
   L:  Module is loaded
   D:  Default Module
</code></pre>
</div>
<p>Note that we have two different versions of
<code>cray-hdf5</code>.</p>
<div id="using-module-swap" class="callout discussion">
<div class="callout-square">
<i class="callout-icon" data-feather="message-circle"></i>
</div>
<span class="callout-header">Discussion</span>
<div id="using-module-swap" class="callout-inner">
<h3 class="callout-title">Using <code>module swap</code>
</h3>
<div class="callout-content">
<p>Load module <code>cray-hdf5</code> as before. Note that if we do not
specifify a particular version, we load a default version. If we wish to
change versions, we can use
<code>module swap &lt;old-module&gt; &lt;new-module&gt;</code>. Try this
to obtain <code>cray-hdf5/1.12.2.7</code>. Check what has happened to
the location of the <code>h5dump</code> utility.</p>
</div>
</div>
</div>
<div id="using-software-modules-in-scripts" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<span class="callout-header">Challenge</span>
<div id="using-software-modules-in-scripts" class="callout-inner">
<h3 class="callout-title">Using Software Modules in Scripts</h3>
<div class="callout-content">
<p>Create a job that is able to run <code>h5dump --version</code>.
Remember, submitting a job is just like logging in to a new remote
system. What modules would you expect to be there?</p>
</div>
</div>
</div>
<div id="accordionSolution1" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution1" aria-expanded="false" aria-controls="collapseSolution1">
  <h4 class="accordion-header" id="headingSolution1"> Show me the solution </h4>
</button>
<div id="collapseSolution1" class="accordion-collapse collapse" aria-labelledby="headingSolution1" data-bs-parent="#accordionSolution1">
<div class="accordion-body">
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>#!/bin/bash
#SBATCH --partition=standard
#SBATCH --qos=short
module load cray-hdf5
h5dump --version</code></pre>
</div>
</div>
</div>
</div>
</div>
<div id="keypoints1" class="callout keypoints">
<div class="callout-square">
<i class="callout-icon" data-feather="key"></i>
</div>
<span class="callout-header">Key Points</span>
<div class="callout-inner">
<div class="callout-content">
<ul>
<li>HPC systems use modules to help deal with software
incompatibilities, versioning and dependencies.</li>
<li>We can see what modules we currently have loaded with
<code>module list</code>.</li>
<li>We can see what modules are available with
<code>module avail</code>.</li>
<li>We can load a module with
<code>module load softwareName</code>.</li>
<li>We can unload a module with
<code>module unload softwareName</code>.</li>
<li>We can swap modules for different versions with
<code>module swap old-softwareName new-softwareName</code>.</li>
</ul>
</div>
</div>
</div>
<!--
Place links that you need to refer to multiple times across pages here. Delete
any links that you are not going to use.

use like [gitbash][gitbash]
 -->
</section></section><section id="aio-15-transferring-files"><p>Content from <a href="15-transferring-files.html">Transferring files with remote computers</a></p>
<hr>
<p>Last updated on 2025-10-13 |

        <a href="https://github.com/EPCCed/2025-10-14-archer2-intro-hpc/edit/main/episodes/15-transferring-files.Rmd" class="external-link">Edit this page <i aria-hidden="true" data-feather="edit"></i></a></p>
<div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right" data-expand="Expand All Solutions " data-collapse="Collapse All Solutions "> Expand All Solutions <i aria-hidden="true" data-feather="plus"></i></button>
        </div>
<div class="overview card">
<h2 class="card-header">Overview</h2>
<div class="row g-0">
<div class="col-md-4">
<div class="card-body">
<div class="inner">
<h3 class="card-title">Questions</h3>
<ul>
<li>How do I transfer files to (and from) the cluster?</li>
</ul>
</div>
</div>
</div>
<div class="col-md-8">
<div class="card-body">
<div class="inner bordered">
<h3 class="card-title">Objectives</h3>
<ul>
<li>
<code>wget</code> and <code>curl -O</code> download a file from the
internet.</li>
<li>
<code>scp</code> transfers files to and from your computer.</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<p>A remote computer offers very limited use if we cannot get files to
or from the cluster. There are several options for transferring data
between computing resources, from command line options to GUI
programs.</p>
<section><h2 class="section-heading" id="download-files-from-the-internet">Download Files From the Internet<a class="anchor" aria-label="anchor" href="#download-files-from-the-internet"></a>
</h2>
<hr class="half-width">
<p>One of the most straightforward ways to download files is to use
either <code>curl</code> or <code>wget</code>. One of these is usually
installed in most Linux shells, on Mac OS terminal and in GitBash. Any
file that can be downloaded in your web browser through a direct link
can be downloaded using <code>curl -O</code> or <code>wget</code>. This
is a quick way to download datasets or source code.</p>
<p>The syntax for these commands is:
<code>curl -O https://some/link/to/a/file</code> and
<code>wget https://some/link/to/a/file</code>. Try it out by downloading
some material we’ll use later on, from a terminal on your
<strong>local</strong> machine.</p>
<div class="codewrapper sourceCode" id="cb1">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a><span class="ex">[user@laptop</span> ~]$ curl <span class="at">-O</span> https://epcced.github.io/2025-10-14-archer2-intro-hpc/files/hpc-intro-data.tar.gz</span></code></pre>
</div>
<p>or</p>
<div class="codewrapper sourceCode" id="cb2">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb2-1"><a href="#cb2-1" tabindex="-1"></a><span class="ex">[user@laptop</span> ~]$ wget https://epcced.github.io/2025-10-14-archer2-intro-hpc/files/hpc-intro-data.tar.gz</span></code></pre>
</div>
<div id="tar.gz" class="callout discussion">
<div class="callout-square">
<i class="callout-icon" data-feather="message-circle"></i>
</div>
<span class="callout-header">Discussion</span>
<div id="tar.gz" class="callout-inner">
<h3 class="callout-title">
<code>tar.gz</code>?</h3>
<div class="callout-content">
<p>This is an archive file format, just like <code>.zip</code>, commonly
used and supported by default on Linux, which is the operating system
the majority of HPC cluster machines run. You may also see the extension
<code>.tgz</code>, which is exactly the same. We’ll talk more about
“tarballs” (“tar-dot-g-z” is a mouthful!) later on.</p>
</div>
</div>
</div>
</section><section><h2 class="section-heading" id="transferring-single-files-and-folders-with-scp">Transferring Single Files and Folders With <code>scp</code>
<a class="anchor" aria-label="anchor" href="#transferring-single-files-and-folders-with-scp"></a>
</h2>
<hr class="half-width">
<p>To copy a single file to or from the cluster, we can use
<code>scp</code> (“secure copy”). The syntax can be a little complex,
but we’ll break it down.</p>
<p>To <em>upload to</em> another computer:</p>
<div class="codewrapper sourceCode" id="cb3">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb3-1"><a href="#cb3-1" tabindex="-1"></a><span class="ex">[user@laptop</span> ~]$ scp path/to/local/file.txt userid@login.archer2.ac.uk:/path/on/ARCHER2</span></code></pre>
</div>
<p>To <em>download from</em> another computer:</p>
<div class="codewrapper sourceCode" id="cb4">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb4-1"><a href="#cb4-1" tabindex="-1"></a><span class="ex">[user@laptop</span> ~]$ scp userid@login.archer2.ac.uk:/path/on/ARCHER2/file.txt path/to/local/</span></code></pre>
</div>
<p>Note that everything after the <code>:</code> is relative to our home
directory on the remote computer. We can leave it at that if we don’t
care where the file goes:</p>
<div class="codewrapper sourceCode" id="cb5">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb5-1"><a href="#cb5-1" tabindex="-1"></a><span class="ex">[user@laptop</span> ~]$ scp local-file.txt userid@login.archer2.ac.uk:</span></code></pre>
</div>
<div id="why-not-download-on-archer2-directly" class="callout discussion">
<div class="callout-square">
<i class="callout-icon" data-feather="message-circle"></i>
</div>
<span class="callout-header">Discussion</span>
<div id="why-not-download-on-archer2-directly" class="callout-inner">
<h3 class="callout-title">Why Not Download on ARCHER2 Directly?</h3>
<div class="callout-content">
<p>Some computer clusters are behind firewalls set to only allow
transfers initiated from the <em>outside</em>. This means that the
<code>curl</code> command will fail, as an address outside the firewall
is unreachable from the inside. To get around this, run the
<code>curl</code> or <code>wget</code> command from your local machine
to download the file, then use the <code>scp</code> command to upload it
to the cluster.</p>
</div>
</div>
</div>
<div id="upload-a-file" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<span class="callout-header">Challenge</span>
<div id="upload-a-file" class="callout-inner">
<h3 class="callout-title">Upload a File</h3>
<div class="callout-content">
<p>Copy the file you just downloaded from the Internet to your home
directory on ARCHER2.</p>
</div>
</div>
</div>
<div id="accordionSolution1" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution1" aria-expanded="false" aria-controls="collapseSolution1">
  <h4 class="accordion-header" id="headingSolution1"> Show me the solution </h4>
</button>
<div id="collapseSolution1" class="accordion-collapse collapse" data-bs-parent="#accordionSolution1" aria-labelledby="headingSolution1">
<div class="accordion-body">
<div class="codewrapper sourceCode" id="cb6">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb6-1"><a href="#cb6-1" tabindex="-1"></a><span class="ex">[user@laptop</span> ~]$ scp hpc-intro-data.tar.gz userid@login.archer2.ac.uk:~/</span></code></pre>
</div>
<p><strong>Note:</strong> If you need to pass your SSH key to ssh using
the <code>-i</code> command to login, you may need to also do that
here.</p>
</div>
</div>
</div>
</div>
<div id="can-you-download-from-the-server-directly" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<span class="callout-header">Challenge</span>
<div id="can-you-download-from-the-server-directly" class="callout-inner">
<h3 class="callout-title">Can you download from the server
directly?</h3>
<div class="callout-content">
<p>Try downloading the file directly using <code>curl</code> or
<code>wget</code>. Do the commands understand file locations on your
local machine over SSH? Note that it may well fail, and that’s OK!</p>
</div>
</div>
</div>
<div id="accordionSolution2" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution2" aria-expanded="false" aria-controls="collapseSolution2">
  <h4 class="accordion-header" id="headingSolution2"> Show me the solution </h4>
</button>
<div id="collapseSolution2" class="accordion-collapse collapse" data-bs-parent="#accordionSolution2" aria-labelledby="headingSolution2">
<div class="accordion-body">
<p>Using <code>curl</code> or <code>wget</code> commands like the
following:</p>
<div class="codewrapper sourceCode" id="cb7">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb7-1"><a href="#cb7-1" tabindex="-1"></a><span class="ex">[user@laptop</span> ~]$ ssh userid@login.archer2.ac.uk</span>
<span id="cb7-2"><a href="#cb7-2" tabindex="-1"></a><span class="ex">userid@ln03:~</span><span class="op">&gt;</span> curl <span class="at">-O</span> https://epcced.github.io/2025-10-14-archer2-intro-hpc/files/hpc-intro-data.tar.gz</span>
<span id="cb7-3"><a href="#cb7-3" tabindex="-1"></a><span class="ex">or</span></span>
<span id="cb7-4"><a href="#cb7-4" tabindex="-1"></a><span class="ex">userid@ln03:~</span><span class="op">&gt;</span> wget https://epcced.github.io/2025-10-14-archer2-intro-hpc/files/hpc-intro-data.tar.gz</span></code></pre>
</div>
<p>Did it work? If not, what does the terminal output tell you about
what happened?</p>
</div>
</div>
</div>
</div>
<p>To copy a whole directory, we add the <code>-r</code> flag, for
“<strong>r</strong>ecursive”: copy the item specified, and every item
below it, and every item below those… until it reaches the bottom of the
directory tree rooted at the folder name you provided.</p>
<div class="codewrapper sourceCode" id="cb8">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb8-1"><a href="#cb8-1" tabindex="-1"></a><span class="ex">[user@laptop</span> ~]$ scp <span class="at">-r</span> some-local-folder userid@login.archer2.ac.uk:target-directory/</span></code></pre>
</div>
<div id="caution" class="callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<span class="callout-header">Callout</span>
<div id="caution" class="callout-inner">
<h3 class="callout-title">Caution</h3>
<div class="callout-content">
<p>For a large directory — either in size or number of files — copying
with <code>-r</code> can take a long time to complete.</p>
</div>
</div>
</div>
</section><section><h2 class="section-heading" id="whats-in-a">What’s in a <code>/</code>?<a class="anchor" aria-label="anchor" href="#whats-in-a"></a>
</h2>
<hr class="half-width">
<p>When using <code>scp</code>, you may have noticed that a
<code>:</code> <em>always</em> follows the remote computer name;
sometimes a <code>/</code> follows that, and sometimes not, and
sometimes there’s a final <code>/</code>. On Linux computers,
<code>/</code> is the <strong><em>root</em></strong> directory, the
location where the entire filesystem (and others attached to it) is
anchored. A path starting with a <code>/</code> is called
<em>absolute</em>, since there can be nothing above the root
<code>/</code>. A path that does not start with <code>/</code> is called
<em>relative</em>, since it is not anchored to the root.</p>
<p>If you want to upload a file to a location inside your home directory
— which is often the case — then you don’t need a leading
<code>/</code>. After the <code>:</code>, start writing the sequence of
folders that lead to the final storage location for the file or, as
mentioned above, provide nothing if your home directory <em>is</em> the
destination.</p>
<p>A trailing slash on the target directory is optional, and has no
effect for <code>scp -r</code>, but is important in other commands, like
<code>rsync</code>.</p>
<div id="a-note-on-rsync" class="callout discussion">
<div class="callout-square">
<i class="callout-icon" data-feather="message-circle"></i>
</div>
<span class="callout-header">Discussion</span>
<div id="a-note-on-rsync" class="callout-inner">
<h3 class="callout-title">A Note on <code>rsync</code>
</h3>
<div class="callout-content">
<p>As you gain experience with transferring files, you may find the
<code>scp</code> command limiting. The <a href="https://rsync.samba.org/" class="external-link">rsync</a> utility provides advanced
features for file transfer and is typically faster compared to both
<code>scp</code> and <code>sftp</code> (see below). It is especially
useful for transferring large and/or many files and creating synced
backup folders. The syntax is similar to <code>scp</code>. To transfer
<em>to</em> another computer with commonly used options:</p>
<div class="codewrapper sourceCode" id="cb9">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb9-1"><a href="#cb9-1" tabindex="-1"></a><span class="ex">[user@laptop</span> ~]$ rsync <span class="at">-avzP</span> path/to/local/file.txt userid@login.archer2.ac.uk:directory/path/on/ARCHER2/</span></code></pre>
</div>
<p>The <code>a</code> (archive) option preserves file timestamps and
permissions among other things; the <code>v</code> (verbose) option
gives verbose output to help monitor the transfer; the <code>z</code>
(compression) option compresses the file during transit to reduce size
and transfer time; and the <code>P</code> (partial/progress) option
preserves partially transferred files in case of an interruption and
also displays the progress of the transfer.</p>
<p>To recursively copy a directory, we can use the same options:</p>
<div class="codewrapper sourceCode" id="cb10">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb10-1"><a href="#cb10-1" tabindex="-1"></a><span class="ex">[user@laptop</span> ~]$ rsync <span class="at">-avzP</span> path/to/local/dir userid@login.archer2.ac.uk:directory/path/on/ARCHER2/</span></code></pre>
</div>
<p>As written, this will place the local directory and its contents
under the specified directory on the remote system. If the trailing
slash is omitted on the destination, a new directory corresponding to
the transferred directory (‘dir’ in the example) will not be created,
and the contents of the source directory will be copied directly into
the destination directory.</p>
<p>The <code>a</code> (archive) option implies recursion.</p>
<p>To download a file, we simply change the source and destination:</p>
<div class="codewrapper sourceCode" id="cb11">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb11-1"><a href="#cb11-1" tabindex="-1"></a><span class="ex">[user@laptop</span> ~]$ rsync <span class="at">-avzP</span> userid@login.archer2.ac.uk:path/on/ARCHER2/file.txt path/to/local/</span></code></pre>
</div>
<div id="callout2" class="callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<span class="callout-header">Callout</span>
<div class="callout-inner">
<div class="callout-content">
<p>If If you need to pass your SSH key to ssh using the <code>-i</code>
command to login, you may need to also do that here:</p>
<div class="codewrapper sourceCode" id="cb12">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb12-1"><a href="#cb12-1" tabindex="-1"></a><span class="fu">rsync</span> <span class="at">-avzP</span> <span class="at">-e</span> <span class="st">"ssh -i ~/.ssh/key_for_remote_computer"</span> path/to/local/dir userid@login.archer2.ac.uk:directory/path/on/ARCHER2/</span></code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<div id="a-note-on-ports" class="callout discussion">
<div class="callout-square">
<i class="callout-icon" data-feather="message-circle"></i>
</div>
<span class="callout-header">Discussion</span>
<div id="a-note-on-ports" class="callout-inner">
<h3 class="callout-title">A Note on Ports</h3>
<div class="callout-content">
<p>All file transfers using the above methods use SSH to encrypt data
sent through the network. So, if you can connect via SSH, you will be
able to transfer files. By default, SSH uses network port 22. If a
custom SSH port is in use, you will have to specify it using the
appropriate flag, often <code>-p</code>, <code>-P</code>, or
<code>--port</code>. Check <code>--help</code> or the <code>man</code>
page if you’re unsure.</p>
<div id="rsync-port" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<span class="callout-header">Challenge</span>
<div id="rsync-port" class="callout-inner">
<h3 class="callout-title">Rsync Port</h3>
<div class="callout-content">
<p>Say we have to connect <code>rsync</code> through port 768 instead of
22. How would we modify this command?</p>
<div class="codewrapper sourceCode" id="cb13">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb13-1"><a href="#cb13-1" tabindex="-1"></a><span class="ex">[user@laptop</span> ~]$ rsync test.txt userid@login.archer2.ac.uk:</span></code></pre>
</div>
</div>
</div>
</div>
<div id="accordionSolution3" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution3" aria-expanded="false" aria-controls="collapseSolution3">
  <h4 class="accordion-header" id="headingSolution3"> Show me the solution </h4>
</button>
<div id="collapseSolution3" class="accordion-collapse collapse" data-bs-parent="#accordionSolution3" aria-labelledby="headingSolution3">
<div class="accordion-body">
<div class="codewrapper sourceCode" id="cb14">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb14-1"><a href="#cb14-1" tabindex="-1"></a><span class="ex">[user@laptop</span> ~]$ rsync <span class="at">--help</span> <span class="kw">|</span> <span class="fu">grep</span> port</span>
<span id="cb14-2"><a href="#cb14-2" tabindex="-1"></a>     <span class="ex">--port=PORT</span>             specify double-colon alternate port number</span>
<span id="cb14-3"><a href="#cb14-3" tabindex="-1"></a><span class="ex">See</span> https://rsync.samba.org/ for updates, bug reports, and answers</span>
<span id="cb14-4"><a href="#cb14-4" tabindex="-1"></a><span class="ex">[user@laptop</span> ~]$ rsync <span class="at">--port</span><span class="op">=</span>768 test.txt userid@login.archer2.ac.uk:</span></code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</section><section><h2 class="section-heading" id="archiving-files">Archiving Files<a class="anchor" aria-label="anchor" href="#archiving-files"></a>
</h2>
<hr class="half-width">
<p>One of the biggest challenges we often face when transferring data
between remote HPC systems is that of large numbers of files. There is
an overhead to transferring each individual file and when we are
transferring large numbers of files these overheads combine to slow down
our transfers to a large degree.</p>
<p>The solution to this problem is to <em>archive</em> multiple files
into smaller numbers of larger files before we transfer the data to
improve our transfer efficiency. Sometimes we will combine archiving
with <em>compression</em> to reduce the amount of data we have to
transfer and so speed up the transfer.</p>
<p>The most common archiving command you will use on a (Linux) HPC
cluster is <code>tar</code>. <code>tar</code> can be used to combine
files into a single archive file and, optionally, compress it.</p>
<p>Let’s start with the file we downloaded from the lesson site,
<code>hpc-intro-data.tar.gz</code>. The “gz” part stands for
<em>gzip</em>, which is a compression library. Reading this file name,
it appears somebody took a folder named “hpc-intro-data,” wrapped up all
its contents in a single file with <code>tar</code>, then compressed
that archive with <code>gzip</code> to save space. Let’s check using
<code>tar</code> with the <code>-t</code> flag, which prints the
“<strong>t</strong>able of contents” without unpacking the file,
specified by <code>-f &lt;filename&gt;</code>, on the remote computer.
Note that you can concatenate the two flags, instead of writing
<code>-t -f</code> separately.</p>
<div class="codewrapper sourceCode" id="cb15">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb15-1"><a href="#cb15-1" tabindex="-1"></a><span class="ex">[user@laptop</span> ~]$ ssh userid@login.archer2.ac.uk</span>
<span id="cb15-2"><a href="#cb15-2" tabindex="-1"></a><span class="ex">userid@ln03:~</span><span class="op">&gt;</span> tar <span class="at">-tf</span> hpc-intro-data.tar.gz</span>
<span id="cb15-3"><a href="#cb15-3" tabindex="-1"></a><span class="ex">hpc-intro-data/</span></span>
<span id="cb15-4"><a href="#cb15-4" tabindex="-1"></a><span class="ex">hpc-intro-data/north-pacific-gyre/</span></span>
<span id="cb15-5"><a href="#cb15-5" tabindex="-1"></a><span class="ex">hpc-intro-data/north-pacific-gyre/NENE01971Z.txt</span></span>
<span id="cb15-6"><a href="#cb15-6" tabindex="-1"></a><span class="ex">hpc-intro-data/north-pacific-gyre/goostats</span></span>
<span id="cb15-7"><a href="#cb15-7" tabindex="-1"></a><span class="ex">hpc-intro-data/north-pacific-gyre/goodiff</span></span>
<span id="cb15-8"><a href="#cb15-8" tabindex="-1"></a><span class="ex">hpc-intro-data/north-pacific-gyre/NENE02040B.txt</span></span>
<span id="cb15-9"><a href="#cb15-9" tabindex="-1"></a><span class="ex">hpc-intro-data/north-pacific-gyre/NENE01978B.txt</span></span>
<span id="cb15-10"><a href="#cb15-10" tabindex="-1"></a><span class="ex">hpc-intro-data/north-pacific-gyre/NENE02043B.txt</span></span>
<span id="cb15-11"><a href="#cb15-11" tabindex="-1"></a><span class="ex">hpc-intro-data/north-pacific-gyre/NENE02018B.txt</span></span>
<span id="cb15-12"><a href="#cb15-12" tabindex="-1"></a><span class="ex">hpc-intro-data/north-pacific-gyre/NENE01843A.txt</span></span>
<span id="cb15-13"><a href="#cb15-13" tabindex="-1"></a><span class="ex">hpc-intro-data/north-pacific-gyre/NENE01978A.txt</span></span>
<span id="cb15-14"><a href="#cb15-14" tabindex="-1"></a><span class="ex">hpc-intro-data/north-pacific-gyre/NENE01751B.txt</span></span>
<span id="cb15-15"><a href="#cb15-15" tabindex="-1"></a><span class="ex">hpc-intro-data/north-pacific-gyre/NENE01736A.txt</span></span>
<span id="cb15-16"><a href="#cb15-16" tabindex="-1"></a><span class="ex">hpc-intro-data/north-pacific-gyre/NENE01812A.txt</span></span>
<span id="cb15-17"><a href="#cb15-17" tabindex="-1"></a><span class="ex">hpc-intro-data/north-pacific-gyre/NENE02043A.txt</span></span>
<span id="cb15-18"><a href="#cb15-18" tabindex="-1"></a><span class="ex">hpc-intro-data/north-pacific-gyre/NENE01729B.txt</span></span>
<span id="cb15-19"><a href="#cb15-19" tabindex="-1"></a><span class="ex">hpc-intro-data/north-pacific-gyre/NENE02040A.txt</span></span>
<span id="cb15-20"><a href="#cb15-20" tabindex="-1"></a><span class="ex">hpc-intro-data/north-pacific-gyre/NENE01843B.txt</span></span>
<span id="cb15-21"><a href="#cb15-21" tabindex="-1"></a><span class="ex">hpc-intro-data/north-pacific-gyre/NENE01751A.txt</span></span>
<span id="cb15-22"><a href="#cb15-22" tabindex="-1"></a><span class="ex">hpc-intro-data/north-pacific-gyre/NENE01729A.txt</span></span>
<span id="cb15-23"><a href="#cb15-23" tabindex="-1"></a><span class="ex">hpc-intro-data/north-pacific-gyre/NENE02040Z.txt</span></span></code></pre>
</div>
<p>This shows a folder containing another folder, which contains a bunch
of files. If you’ve taken The Carpentries’ Shell lesson recently, these
might look familiar. Let’s see about that compression, using
<code>du</code> for “<strong>d</strong>isk <strong>u</strong>sage”.</p>
<div class="codewrapper sourceCode" id="cb16">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb16-1"><a href="#cb16-1" tabindex="-1"></a><span class="ex">userid@ln03:~</span><span class="op">&gt;</span> du <span class="at">-sh</span> hpc-intro-data.tar.gz</span>
<span id="cb16-2"><a href="#cb16-2" tabindex="-1"></a><span class="ex">36K</span>     hpc-intro-data.tar.gz</span></code></pre>
</div>
<p>Now let’s unpack the archive. We’ll run <code>tar</code> with a few
common flags:</p>
<ul>
<li>
<code>-x</code> to e<strong>x</strong>tract the archive</li>
<li>
<code>-v</code> for <strong>v</strong>erbose output</li>
<li>
<code>-z</code> for g<strong>z</strong>ip compression</li>
<li>
<code>-f</code> for the file to be unpacked</li>
</ul>
<p>When it’s done, check the directory size with <code>du</code> and
compare.</p>
<div id="extract-the-archive" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<span class="callout-header">Challenge</span>
<div id="extract-the-archive" class="callout-inner">
<h3 class="callout-title">Extract the Archive</h3>
<div class="callout-content">
<p>Using the four flags above, unpack the lesson data using
<code>tar</code>. Then, check the size of the whole unpacked directory
using <code>du</code>. Hint: <code>tar</code> lets you concatenate
flags.</p>
</div>
</div>
</div>
<div id="accordionSolution4" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution4" aria-expanded="false" aria-controls="collapseSolution4">
  <h4 class="accordion-header" id="headingSolution4"> Commands </h4>
</button>
<div id="collapseSolution4" class="accordion-collapse collapse" data-bs-parent="#accordionSolution4" aria-labelledby="headingSolution4">
<div class="accordion-body">
<div class="codewrapper sourceCode" id="cb17">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb17-1"><a href="#cb17-1" tabindex="-1"></a><span class="ex">userid@ln03:~</span><span class="op">&gt;</span> tar <span class="at">-xvzf</span> hpc-intro-data.tar.gz</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code><span><span class="va">hpc</span><span class="op">-</span><span class="va">intro</span><span class="op">-</span><span class="va">data</span><span class="op">/</span></span>
<span><span class="va">hpc</span><span class="op">-</span><span class="va">intro</span><span class="op">-</span><span class="va">data</span><span class="op">/</span><span class="va">north</span><span class="op">-</span><span class="va">pacific</span><span class="op">-</span><span class="va">gyre</span><span class="op">/</span></span>
<span><span class="va">hpc</span><span class="op">-</span><span class="va">intro</span><span class="op">-</span><span class="va">data</span><span class="op">/</span><span class="va">north</span><span class="op">-</span><span class="va">pacific</span><span class="op">-</span><span class="va">gyre</span><span class="op">/</span><span class="va">NENE01971Z.txt</span></span>
<span><span class="va">hpc</span><span class="op">-</span><span class="va">intro</span><span class="op">-</span><span class="va">data</span><span class="op">/</span><span class="va">north</span><span class="op">-</span><span class="va">pacific</span><span class="op">-</span><span class="va">gyre</span><span class="op">/</span><span class="va">goostats</span></span>
<span><span class="va">hpc</span><span class="op">-</span><span class="va">intro</span><span class="op">-</span><span class="va">data</span><span class="op">/</span><span class="va">north</span><span class="op">-</span><span class="va">pacific</span><span class="op">-</span><span class="va">gyre</span><span class="op">/</span><span class="va">goodiff</span></span>
<span><span class="va">hpc</span><span class="op">-</span><span class="va">intro</span><span class="op">-</span><span class="va">data</span><span class="op">/</span><span class="va">north</span><span class="op">-</span><span class="va">pacific</span><span class="op">-</span><span class="va">gyre</span><span class="op">/</span><span class="va">NENE02040B.txt</span></span>
<span><span class="va">hpc</span><span class="op">-</span><span class="va">intro</span><span class="op">-</span><span class="va">data</span><span class="op">/</span><span class="va">north</span><span class="op">-</span><span class="va">pacific</span><span class="op">-</span><span class="va">gyre</span><span class="op">/</span><span class="va">NENE01978B.txt</span></span>
<span><span class="va">hpc</span><span class="op">-</span><span class="va">intro</span><span class="op">-</span><span class="va">data</span><span class="op">/</span><span class="va">north</span><span class="op">-</span><span class="va">pacific</span><span class="op">-</span><span class="va">gyre</span><span class="op">/</span><span class="va">NENE02043B.txt</span></span>
<span><span class="va">hpc</span><span class="op">-</span><span class="va">intro</span><span class="op">-</span><span class="va">data</span><span class="op">/</span><span class="va">north</span><span class="op">-</span><span class="va">pacific</span><span class="op">-</span><span class="va">gyre</span><span class="op">/</span><span class="va">NENE02018B.txt</span></span>
<span><span class="va">hpc</span><span class="op">-</span><span class="va">intro</span><span class="op">-</span><span class="va">data</span><span class="op">/</span><span class="va">north</span><span class="op">-</span><span class="va">pacific</span><span class="op">-</span><span class="va">gyre</span><span class="op">/</span><span class="va">NENE01843A.txt</span></span>
<span><span class="va">hpc</span><span class="op">-</span><span class="va">intro</span><span class="op">-</span><span class="va">data</span><span class="op">/</span><span class="va">north</span><span class="op">-</span><span class="va">pacific</span><span class="op">-</span><span class="va">gyre</span><span class="op">/</span><span class="va">NENE01978A.txt</span></span>
<span><span class="va">hpc</span><span class="op">-</span><span class="va">intro</span><span class="op">-</span><span class="va">data</span><span class="op">/</span><span class="va">north</span><span class="op">-</span><span class="va">pacific</span><span class="op">-</span><span class="va">gyre</span><span class="op">/</span><span class="va">NENE01751B.txt</span></span>
<span><span class="va">hpc</span><span class="op">-</span><span class="va">intro</span><span class="op">-</span><span class="va">data</span><span class="op">/</span><span class="va">north</span><span class="op">-</span><span class="va">pacific</span><span class="op">-</span><span class="va">gyre</span><span class="op">/</span><span class="va">NENE01736A.txt</span></span>
<span><span class="va">hpc</span><span class="op">-</span><span class="va">intro</span><span class="op">-</span><span class="va">data</span><span class="op">/</span><span class="va">north</span><span class="op">-</span><span class="va">pacific</span><span class="op">-</span><span class="va">gyre</span><span class="op">/</span><span class="va">NENE01812A.txt</span></span>
<span><span class="va">hpc</span><span class="op">-</span><span class="va">intro</span><span class="op">-</span><span class="va">data</span><span class="op">/</span><span class="va">north</span><span class="op">-</span><span class="va">pacific</span><span class="op">-</span><span class="va">gyre</span><span class="op">/</span><span class="va">NENE02043A.txt</span></span>
<span><span class="va">hpc</span><span class="op">-</span><span class="va">intro</span><span class="op">-</span><span class="va">data</span><span class="op">/</span><span class="va">north</span><span class="op">-</span><span class="va">pacific</span><span class="op">-</span><span class="va">gyre</span><span class="op">/</span><span class="va">NENE01729B.txt</span></span>
<span><span class="va">hpc</span><span class="op">-</span><span class="va">intro</span><span class="op">-</span><span class="va">data</span><span class="op">/</span><span class="va">north</span><span class="op">-</span><span class="va">pacific</span><span class="op">-</span><span class="va">gyre</span><span class="op">/</span><span class="va">NENE02040A.txt</span></span>
<span><span class="va">hpc</span><span class="op">-</span><span class="va">intro</span><span class="op">-</span><span class="va">data</span><span class="op">/</span><span class="va">north</span><span class="op">-</span><span class="va">pacific</span><span class="op">-</span><span class="va">gyre</span><span class="op">/</span><span class="va">NENE01843B.txt</span></span>
<span><span class="va">hpc</span><span class="op">-</span><span class="va">intro</span><span class="op">-</span><span class="va">data</span><span class="op">/</span><span class="va">north</span><span class="op">-</span><span class="va">pacific</span><span class="op">-</span><span class="va">gyre</span><span class="op">/</span><span class="va">NENE01751A.txt</span></span>
<span><span class="va">hpc</span><span class="op">-</span><span class="va">intro</span><span class="op">-</span><span class="va">data</span><span class="op">/</span><span class="va">north</span><span class="op">-</span><span class="va">pacific</span><span class="op">-</span><span class="va">gyre</span><span class="op">/</span><span class="va">NENE01729A.txt</span></span>
<span><span class="va">hpc</span><span class="op">-</span><span class="va">intro</span><span class="op">-</span><span class="va">data</span><span class="op">/</span><span class="va">north</span><span class="op">-</span><span class="va">pacific</span><span class="op">-</span><span class="va">gyre</span><span class="op">/</span><span class="va">NENE02040Z.txt</span></span></code></pre>
</div>
<p>Note that we did not type out <code>-x -v -z -f</code>, thanks to the
flag concatenation, though the command works identically either way.</p>
<div class="codewrapper sourceCode" id="cb19">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb19-1"><a href="#cb19-1" tabindex="-1"></a><span class="ex">userid@ln03:~</span><span class="op">&gt;</span> du <span class="at">-sh</span> hpc-intro-data</span>
<span id="cb19-2"><a href="#cb19-2" tabindex="-1"></a><span class="ex">144K</span>    hpc-intro-data</span></code></pre>
</div>
</div>
</div>
</div>
</div>
<div id="was-the-data-compressed" class="callout discussion">
<div class="callout-square">
<i class="callout-icon" data-feather="message-circle"></i>
</div>
<span class="callout-header">Discussion</span>
<div id="was-the-data-compressed" class="callout-inner">
<h3 class="callout-title">Was the Data Compressed?</h3>
<div class="callout-content">
<p>Text files compress nicely: the “tarball” is one-quarter the total
size of the raw data!</p>
</div>
</div>
</div>
<p>If you want to reverse the process — compressing raw data instead of
extracting it — set a <code>c</code> flag instead of <code>x</code>, set
the archive filename, then provide a directory to compress:</p>
<div class="codewrapper sourceCode" id="cb20">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb20-1"><a href="#cb20-1" tabindex="-1"></a><span class="ex">[user@laptop</span> ~]$ tar <span class="at">-cvzf</span> compressed_data.tar.gz hpc-intro-data</span></code></pre>
</div>
<div id="working-with-windows" class="callout discussion">
<div class="callout-square">
<i class="callout-icon" data-feather="message-circle"></i>
</div>
<span class="callout-header">Discussion</span>
<div id="working-with-windows" class="callout-inner">
<h3 class="callout-title">Working with Windows</h3>
<div class="callout-content">
<p>When you transfer text files to from a Windows system to a Unix
system (Mac, Linux, BSD, Solaris, etc.) this can cause problems. Windows
encodes its files slightly different than Unix, and adds an extra
character to every line. On a Unix system, every line in a file ends
with a <code>\n</code> (newline). On Windows, every line in a file ends
with a <code>\r\n</code> (carriage return + newline). This causes
problems sometimes.</p>
<p>Though most modern programming languages and software handles this
correctly, in some rare instances, you may run into an issue. The
solution is to convert a file from Windows to Unix encoding with the
<code>dos2unix</code> command.</p>
<p>You can identify if a file has Windows line endings with
<code>cat -A filename</code>. A file with Windows line endings will have
<code>^M$</code> at the end of every line. A file with Unix line endings
will have <code>$</code> at the end of a line. To convert the file, just
run <code>dos2unix filename</code>. (Conversely, to convert back to
Windows format, you can run <code>unix2dos filename</code>.)</p>
</div>
</div>
</div>
<div id="keypoints1" class="callout keypoints">
<div class="callout-square">
<i class="callout-icon" data-feather="key"></i>
</div>
<span class="callout-header">Key Points</span>
<div class="callout-inner">
<div class="callout-content">
<ul>
<li>It is an essential skill to be able to transfer files to and from a
cluser</li>
<li>
<code>wget</code> and <code>curl -O</code> can be used to download a
file from the internet.</li>
<li>
<code>scp</code> transfers files to and from your computer.</li>
<li>If you have a lot of data to transfer, it is good practice to
archive and compress the data</li>
</ul>
</div>
</div>
</div>
<!--
Place links that you need to refer to multiple times across pages here. Delete
any links that you are not going to use.

use like [gitbash][gitbash]
 -->
</section></section><section id="aio-17-resources"><p>Content from <a href="17-resources.html">Using resources effectively</a></p>
<hr>
<p>Last updated on 2025-10-13 |

        <a href="https://github.com/EPCCed/2025-10-14-archer2-intro-hpc/edit/main/episodes/17-resources.Rmd" class="external-link">Edit this page <i aria-hidden="true" data-feather="edit"></i></a></p>
<div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right" data-expand="Expand All Solutions " data-collapse="Collapse All Solutions "> Expand All Solutions <i aria-hidden="true" data-feather="plus"></i></button>
        </div>
<div class="overview card">
<h2 class="card-header">Overview</h2>
<div class="row g-0">
<div class="col-md-4">
<div class="card-body">
<div class="inner">
<h3 class="card-title">Questions</h3>
<ul>
<li>How do we monitor our jobs?</li>
<li>How can I get my jobs scheduled more easily?</li>
</ul>
</div>
</div>
</div>
<div class="col-md-8">
<div class="card-body">
<div class="inner bordered">
<h3 class="card-title">Objectives</h3>
<ul>
<li>Understand how to look up job statistics and profile code.</li>
<li>Understand job size implications.</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<p>We’ve touched on all the skills you need to interact with an HPC
cluster: - Logging in over SSH, - Loading software modules, - Submitting
parallel jobs, and - Finding the output</p>
<p>Now, let’s learn about estimating resource usage and why it might
matter. To do this we need to understand the basics of
<em>benchmarking</em>.</p>
<section><h2 class="section-heading" id="the-basics-of-benchmarking">The Basics of Benchmarking<a class="anchor" aria-label="anchor" href="#the-basics-of-benchmarking"></a>
</h2>
<hr class="half-width">
<p>Benchmarking is essentially performing simple experiments to help
understand how the performance of our work varies as we change the
properties of the jobs on the cluster - including input parameters, job
options and resources used.</p>
<div id="our-example" class="callout discussion">
<div class="callout-square">
<i class="callout-icon" data-feather="message-circle"></i>
</div>
<span class="callout-header">Discussion</span>
<div id="our-example" class="callout-inner">
<h3 class="callout-title">Our example</h3>
<div class="callout-content">
<p>In the rest of this episode, we will use an example parallel
application that calculates an estimate of the value of Pi. Although
this is a toy problem, it exhibits all the properties of a full parallel
application that we are interested in for this course.</p>
<p>The main resource we will consider here is the use of compute core
time as this is the resource you are usually charged for on HPC
resources. However, other resources - such as memory use - may also have
a bearing on how you choose resources and constrain your choice.</p>
<p>For those that have come across HPC benchmarking before, you may be
aware that people often make a distinction between <em>strong
scaling</em> and <em>weak scaling</em>:</p>
<ul>
<li>Strong scaling is where the problem size (i.e. the
<em>application</em>) stays the same size and we try to use more cores
to solve the problem faster.</li>
<li>Weak scaling is where the problem size increases at the same rate as
we increase the core count so we are using more cores to solve a larger
problem.</li>
</ul>
<p>Both of these approaches are equally valid uses of HPC. This example
looks at strong scaling.</p>
</div>
</div>
</div>
<p>Before we work on benchmarking, it is useful to define some terms for
the example we will be using</p>
<ul>
<li>
<strong>Program</strong> = The computer program we are executing
(<code>pi-mpi.py</code> in the examples below)</li>
<li>
<strong>Application</strong> = The combination of computer program
with particular input parameters</li>
</ul></section><section><h2 class="section-heading" id="accessing-the-software-and-input">Accessing the software and input<a class="anchor" aria-label="anchor" href="#accessing-the-software-and-input"></a>
</h2>
<hr class="half-width">
<p>We will be returning to the same example used in <a href="13-scheduler.html">lesson 4</a>. If you didn’t get a chance to
grab the program then, you can do so now by following the below
instructions.</p>
<div id="required-files" class="callout prereq">
<div class="callout-square">
<i class="callout-icon" data-feather="check"></i>
</div>
<span class="callout-header">Prerequisite</span>
<div id="required-files" class="callout-inner">
<h3 class="callout-title">Required Files</h3>
<div class="callout-content">
<p>The program used in this example can be retrieved using wget or a
browser and copied to the remote.</p>
<p><strong>Using wget</strong>:</p>
<div class="codewrapper sourceCode" id="cb1">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a><span class="ex">userid@ln03:~</span><span class="op">&gt;</span> wget https://epcced.github.io/2025-10-14-archer2-intro-hpc/files/pi-mpi.py</span></code></pre>
</div>
<p><strong>Download via web browser</strong>:</p>
<p><a href="https://epcced.github.io/2025-10-14-archer2-intro-hpc/files/pi-mpi.py" class="external-link">https://epcced.github.io/2025-10-14-archer2-intro-hpc/files/pi-mpi.py</a></p>
</div>
</div>
</div>
</section><section><h2 class="section-heading" id="baseline-running-in-serial">Baseline: running in serial<a class="anchor" aria-label="anchor" href="#baseline-running-in-serial"></a>
</h2>
<hr class="half-width">
<p>Before starting to benchmark an application to understand what
resources are best to use, you need a <em>baseline</em> performance
result. In more formal benchmarking, your baseline is usually the
minimum number of cores or nodes you can run on. However, for
understanding how best to use resources, as we are doing here, your
baseline could be the performance on any number of cores or nodes that
you can measure the change in performance from.</p>
<p>Our <code>pi-mpi.py</code> application is small enough that we can
run a serial (i.e. using a single core) job for our baseline performance
so that is where we will start</p>
<div id="run-a-single-core-job" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<span class="callout-header">Challenge</span>
<div id="run-a-single-core-job" class="callout-inner">
<h3 class="callout-title">Run a single core job</h3>
<div class="callout-content">
<p>Write a job submission script that runs the <code>pi-mpi.py</code>
application on a single core. You will need to take an initial guess for
how much walltime to request to give the job time to complete.</p>
<p>Submit the job and check the contents of the STDOUT file to see if
the application worked or not.</p>
</div>
</div>
</div>
<div id="accordionSolution1" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution1" aria-expanded="false" aria-controls="collapseSolution1">
  <h4 class="accordion-header" id="headingSolution1"> Show me the solution </h4>
</button>
<div id="collapseSolution1" class="accordion-collapse collapse" aria-labelledby="headingSolution1" data-bs-parent="#accordionSolution1">
<div class="accordion-body">
<p>Creating a file called <code>submit-pi-mpi.slurm</code>:</p>
<div class="codewrapper sourceCode" id="cb2">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb2-1"><a href="#cb2-1" tabindex="-1"></a><span class="co">#!/bin/bash</span></span>
<span id="cb2-2"><a href="#cb2-2" tabindex="-1"></a><span class="co">#SBATCH --partition=standard</span></span>
<span id="cb2-3"><a href="#cb2-3" tabindex="-1"></a><span class="co">#SBATCH --qos=short</span></span>
<span id="cb2-4"><a href="#cb2-4" tabindex="-1"></a></span>
<span id="cb2-5"><a href="#cb2-5" tabindex="-1"></a><span class="co">#SBATCH --job-name=pi-mpi</span></span>
<span id="cb2-6"><a href="#cb2-6" tabindex="-1"></a><span class="co">#SBATCH --nodes=1</span></span>
<span id="cb2-7"><a href="#cb2-7" tabindex="-1"></a><span class="co">#SBATCH --tasks-per-node=1</span></span>
<span id="cb2-8"><a href="#cb2-8" tabindex="-1"></a><span class="co">#SBATCH --time=00:15:00</span></span>
<span id="cb2-9"><a href="#cb2-9" tabindex="-1"></a></span>
<span id="cb2-10"><a href="#cb2-10" tabindex="-1"></a><span class="ex">module</span> load cray-python </span>
<span id="cb2-11"><a href="#cb2-11" tabindex="-1"></a><span class="ex">srun</span> python pi-mpi.py 100000000</span></code></pre>
</div>
<p>Submit with to the batch queue with:</p>
<div class="codewrapper sourceCode" id="cb3">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb3-1"><a href="#cb3-1" tabindex="-1"></a><span class="ex">sbatch</span> submit-pi-mpi.slurm</span></code></pre>
</div>
<p>OR run application using a single process (i.e. in serial) with a
blocking <code>srun</code> command:</p>
<div class="codewrapper sourceCode" id="cb4">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb4-1"><a href="#cb4-1" tabindex="-1"></a><span class="ex">module</span> load cray-python</span>
<span id="cb4-2"><a href="#cb4-2" tabindex="-1"></a><span class="ex">srun</span> <span class="at">--partition</span><span class="op">=</span>standard <span class="at">--qos</span><span class="op">=</span>short <span class="at">--time</span><span class="op">=</span>00:15:00 python pi-mpi.py 100000000</span></code></pre>
</div>
<p>Output in the job log should look something like:</p>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>Generating 100000000 samples.
Rank 0 generating 100000000 samples on host nid001810.
Numpy Pi:  3.141592653589793
My Estimate of Pi:  3.14165996
1 core(s), 100000000 samples, 2288.818359 MiB memory, 3.789277 seconds, -0.002142% error
Total run time=3.7914833110000927s</code></pre>
</div>
</div>
</div>
</div>
</div>
<p>Once your job has run, look at the output to identify any performance
information. Most HPC programs should print out timing or performance
(usually somewhere near the bottom of the summary output) and
<code>pi-mpi.py</code> is no exception. You should see two lines in the
output that look something like:</p>
<div class="codewrapper sourceCode" id="cb6">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb6-1"><a href="#cb6-1" tabindex="-1"></a><span class="ex">1</span> core<span class="er">(</span><span class="ex">s</span><span class="kw">)</span><span class="ex">,</span> 100000000 samples, 2288.818359 MiB memory, 3.789277 seconds, <span class="at">-0.002142%</span> error</span>
<span id="cb6-2"><a href="#cb6-2" tabindex="-1"></a><span class="ex">Total</span> run time=3.7914833110000927s</span></code></pre>
</div>
<p>You can also get an estimate of the overall run time from the final
job statistics from Slurm. This can be a quick way to see roughly what
the runtime was, useful if you want to know quickly if a job was faster
or not than a previous job (as you do not have to find the output file
to look up the performance).</p>
<p>However, the number is not as accurate as the performance recorded by
the application itself and also includes static overheads from running
the job (such as loading modules and startup time) that can skew the
timings.</p>
<p>To do this on <code>Slurm</code> use <code>sacct -l -j</code> with
the job ID, e.g.:</p>
<div class="codewrapper sourceCode" id="cb7">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb7-1"><a href="#cb7-1" tabindex="-1"></a><span class="ex">userid@ln03:/work/ta215/ta215/userid</span><span class="op">&gt;</span> sacct <span class="at">-l</span> <span class="at">-j</span> 12345</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>
JOBID USER         ACCOUNT     NAME           ST REASON START_TIME         T...
36856 yourUsername yourAccount example-job.sh R  None   2017-07-01T16:47:02 ...</code></pre>
</div>
<p>This gives a <strong>lot</strong> of information, so you can trim the
output down with some formatting:</p>
<div class="codewrapper sourceCode" id="cb9">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb9-1"><a href="#cb9-1" tabindex="-1"></a><span class="ex">sacct</span> <span class="at">-j</span> 12345 <span class="at">--format</span><span class="op">=</span>JobID,Elapsed,ReqCPUFreq,ConsumedEnergy</span></code></pre>
</div>
</section><section><h2 class="section-heading" id="running-in-parallel-and-benchmarking-performance">Running in parallel and benchmarking performance<a class="anchor" aria-label="anchor" href="#running-in-parallel-and-benchmarking-performance"></a>
</h2>
<hr class="half-width">
<p>We have now managed to run the <code>pi-mpi.py</code> application
using a single core and have a baseline performance we can use to judge
how well we are using resources on the system.</p>
<p>Note that we also now have a good estimate of how long the
application takes to run so we can provide a better setting for the
walltime for future jobs we submit. Lets now look at how the runtime
varies with core count.</p>
<div id="benchmarking-the-parallel-performance" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<span class="callout-header">Challenge</span>
<div id="benchmarking-the-parallel-performance" class="callout-inner">
<h3 class="callout-title">Benchmarking the parallel performance</h3>
<div class="callout-content">
<p>Modify your job script to run on multiple cores and evaluate the
performance of <code>pi-mpi.py</code> on a variety of different core
counts and use multiple runs to complete a table like the one below.</p>
<p>If you examine the log file you will see that it contains two
timings:</p>
<ul>
<li>Total time taken by the entire program</li>
<li>Time taken solely by the calculation i.e. measures only the time
spent performing the main computation..</li>
</ul>
<p>The final step, calculation Pi from the Monte-Carlo counts, is not
parallelised, meaning it runs on a single processor. This creates a
serial overhead that does not speed up when more cores are used.</p>
<p>In contracts, the Monte Carlo calculation itself is perfectly
parallel <em>in theory</em>, since each processor works independently on
its own set of random numbers. Therefore, as you increase the number of
cores, this part should ideally run faster.</p>
<p>You can work out <strong>Calculation core</strong> time by
multiplying <strong>Calculation time</strong> by the number of
cores.</p>
<table class="table">
<colgroup>
<col width="14%">
<col width="26%">
<col width="26%">
<col width="31%">
</colgroup>
<thead><tr class="header">
<th>Cores</th>
<th>Overall run time (s)</th>
<th>Calculation time (s)</th>
<th>Calculation core (s)</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>1 (serial)</td>
<td></td>
<td></td>
<td></td>
</tr>
<tr class="even">
<td>2</td>
<td></td>
<td></td>
<td></td>
</tr>
<tr class="odd">
<td>4</td>
<td></td>
<td></td>
<td></td>
</tr>
<tr class="even">
<td>8</td>
<td></td>
<td></td>
<td></td>
</tr>
<tr class="odd">
<td>16</td>
<td></td>
<td></td>
<td></td>
</tr>
<tr class="even">
<td>32</td>
<td></td>
<td></td>
<td></td>
</tr>
<tr class="odd">
<td>64</td>
<td></td>
<td></td>
<td></td>
</tr>
<tr class="even">
<td>128</td>
<td></td>
<td></td>
<td></td>
</tr>
<tr class="odd">
<td>256</td>
<td></td>
<td></td>
<td></td>
</tr>
</tbody>
</table>
<p>Look at your results – do they make sense?</p>
<p>Based on how the code is structured, you would expect the calculation
performance to scale linearly with the number of cores. In other words,
as you add more cores, the calculation should finish proportionally
faster.</p>
<p>If that’s true, the Calculation core time should stay roughly
constant.</p>
<p>Do your results show this expected behaviour?</p>
</div>
</div>
</div>
<div id="accordionSolution2" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution2" aria-expanded="false" aria-controls="collapseSolution2">
  <h4 class="accordion-header" id="headingSolution2"> Show me the solution </h4>
</button>
<div id="collapseSolution2" class="accordion-collapse collapse" aria-labelledby="headingSolution2" data-bs-parent="#accordionSolution2">
<div class="accordion-body">
<p>The table below shows example timings for runs on ARCHER2</p>
<table class="table">
<colgroup>
<col width="13%">
<col width="25%">
<col width="25%">
<col width="36%">
</colgroup>
<thead><tr class="header">
<th align="right">Cores</th>
<th align="right">Overall run time (s)</th>
<th align="right">Calculation time (s)</th>
<th align="right">Calculation core seconds</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="right">1</td>
<td align="right">3.931</td>
<td align="right">3.854</td>
<td align="right">3.854</td>
</tr>
<tr class="even">
<td align="right">2</td>
<td align="right">2.002</td>
<td align="right">1.930</td>
<td align="right">3.859</td>
</tr>
<tr class="odd">
<td align="right">4</td>
<td align="right">1.048</td>
<td align="right">0.972</td>
<td align="right">3.888</td>
</tr>
<tr class="even">
<td align="right">8</td>
<td align="right">0.572</td>
<td align="right">0.495</td>
<td align="right">3.958</td>
</tr>
<tr class="odd">
<td align="right">16</td>
<td align="right">0.613</td>
<td align="right">0.536</td>
<td align="right">8.574</td>
</tr>
<tr class="even">
<td align="right">32</td>
<td align="right">0.360</td>
<td align="right">0.278</td>
<td align="right">8.880</td>
</tr>
<tr class="odd">
<td align="right">64</td>
<td align="right">0.249</td>
<td align="right">0.163</td>
<td align="right">10.400</td>
</tr>
<tr class="even">
<td align="right">128</td>
<td align="right">0.170</td>
<td align="right">0.083</td>
<td align="right">10.624</td>
</tr>
<tr class="odd">
<td align="right">256</td>
<td align="right">0.187</td>
<td align="right">0.135</td>
<td align="right">34.560</td>
</tr>
</tbody>
</table>
<p>Was our prediction correct?</p>
</div>
</div>
</div>
</div>
</section><section><h2 class="section-heading" id="understanding-the-performance">Understanding the performance<a class="anchor" aria-label="anchor" href="#understanding-the-performance"></a>
</h2>
<hr class="half-width">
<p>Now we have some data showing the performance of our application we
need to try and draw some useful conclusions as to what the most
efficient set of resources are to use for our jobs. To do this we
introduce two metrics:</p>
<ul>
<li>
<strong>Actual speedup:</strong> The ratio of the baseline runtime
(or runtime on the lowest core count) to the runtime at the specified
core count. <em>(i.e. baseline runtime divided by runtime at the
specified core count)</em>.</li>
<li>
<strong>Ideal speedup:</strong> The expected speedup if the
application showed perfect scaling. i.e. if you double the number of
cores, the application should run twice as fast.</li>
<li>
<strong>Parallel efficiency:</strong> The fraction of ideal speedup
actually obtained for a given core count. This gives an indication of
how well you are exploiting the additional resources you are using.</li>
</ul>
<p>We will now use our performance results to compute these three
metrics for the <code>pi-mpi.py</code> application and use the metrics
to evaluate the performance and make some decisions about the most
effective use of resources.</p>
<div id="computing-the-speedup-and-parallel-efficiency" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<span class="callout-header">Challenge</span>
<div id="computing-the-speedup-and-parallel-efficiency" class="callout-inner">
<h3 class="callout-title">Computing the speedup and parallel
efficiency</h3>
<div class="callout-content">
<p>Use your <em>overall run times</em> from above to fill in a table
like the one below.</p>
<table class="table">
<colgroup>
<col width="13%">
<col width="25%">
<col width="19%">
<col width="18%">
<col width="23%">
</colgroup>
<thead><tr class="header">
<th>Cores</th>
<th>Overall run time (s)</th>
<th>Actual speedup</th>
<th>Ideal speedup</th>
<th>Parallel efficiency</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>1 (serial)</td>
<td><span class="math inline">\(t_{c1}\)</span></td>
<td>-</td>
<td>1</td>
<td>1</td>
</tr>
<tr class="even">
<td>2</td>
<td><span class="math inline">\(t_{c2}\)</span></td>
<td><span class="math inline">\(s_2 = t_{c1}/t_{c2}\)</span></td>
<td><span class="math inline">\(i_2 = 2\)</span></td>
<td><span class="math inline">\(s_2 / i_2\)</span></td>
</tr>
<tr class="odd">
<td>4</td>
<td><span class="math inline">\(t_{c4}\)</span></td>
<td><span class="math inline">\(s_4 = t_{c1}/t_{c4}\)</span></td>
<td><span class="math inline">\(i_4 = 4\)</span></td>
<td><span class="math inline">\(s_4 / i_4\)</span></td>
</tr>
<tr class="even">
<td>8</td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr class="odd">
<td>16</td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr class="even">
<td>32</td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr class="odd">
<td>64</td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr class="even">
<td>128</td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr class="odd">
<td>256</td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
</tbody>
</table>
<p>Given your results, try to answer the following questions:</p>
<ol style="list-style-type: decimal">
<li>What is the core count where you get the <strong>most</strong>
efficient use of resources, irrespective of run time?</li>
<li>What is the core count where you get the fastest solution,
irrespective of efficiency?</li>
<li>What do you think a good core count choice would be for this
application that balances time to solution and efficiency? Why did you
choose this option?</li>
</ol>
</div>
</div>
</div>
<div id="accordionSolution6" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution6" aria-expanded="false" aria-controls="collapseSolution6">
  <h4 class="accordion-header" id="headingSolution6"> Show me the solution </h4>
</button>
<div id="collapseSolution6" class="accordion-collapse collapse" aria-labelledby="headingSolution6" data-bs-parent="#accordionSolution6">
<div class="accordion-body">
<p>The table below gives example results for ARCHER2 based on the
example runtimes given in the solution above.</p>
<table class="table">
<colgroup>
<col width="13%">
<col width="25%">
<col width="18%">
<col width="17%">
<col width="24%">
</colgroup>
<thead><tr class="header">
<th align="right">Cores</th>
<th align="right">Overall run time (s)</th>
<th align="right">Actual speedup</th>
<th align="right">Ideal speedup</th>
<th align="right">Parallel efficiency</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="right">1</td>
<td align="right">3.931</td>
<td align="right">1.000</td>
<td align="right">1.000</td>
<td align="right">1.000</td>
</tr>
<tr class="even">
<td align="right">2</td>
<td align="right">2.002</td>
<td align="right">1.963</td>
<td align="right">2.000</td>
<td align="right">0.982</td>
</tr>
<tr class="odd">
<td align="right">4</td>
<td align="right">1.048</td>
<td align="right">3.751</td>
<td align="right">4.000</td>
<td align="right">0.938</td>
</tr>
<tr class="even">
<td align="right">8</td>
<td align="right">0.572</td>
<td align="right">6.872</td>
<td align="right">8.000</td>
<td align="right">0.859</td>
</tr>
<tr class="odd">
<td align="right">16</td>
<td align="right">0.613</td>
<td align="right">6.408</td>
<td align="right">16.000</td>
<td align="right">0.401</td>
</tr>
<tr class="even">
<td align="right">32</td>
<td align="right">0.360</td>
<td align="right">10.928</td>
<td align="right">32.000</td>
<td align="right">0.342</td>
</tr>
<tr class="odd">
<td align="right">64</td>
<td align="right">0.249</td>
<td align="right">15.767</td>
<td align="right">64.000</td>
<td align="right">0.246</td>
</tr>
<tr class="even">
<td align="right">128</td>
<td align="right">0.170</td>
<td align="right">23.122</td>
<td align="right">128.000</td>
<td align="right">0.181</td>
</tr>
<tr class="odd">
<td align="right">256</td>
<td align="right">0.187</td>
<td align="right">21.077</td>
<td align="right">256.000</td>
<td align="right">0.082</td>
</tr>
</tbody>
</table>
<div class="section level4">
<h4 id="what-is-the-core-count-where-you-get-the-most-efficient-use-of-resources">What is the core count where you get the <strong>most</strong>
efficient use of resources?<a class="anchor" aria-label="anchor" href="#what-is-the-core-count-where-you-get-the-most-efficient-use-of-resources"></a>
</h4>
<div id="accordionSolution3" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution3" aria-expanded="false" aria-controls="collapseSolution3">
  <h4 class="accordion-header" id="headingSolution3"> Show me the solution </h4>
</button>
<div id="collapseSolution3" class="accordion-collapse collapse" aria-labelledby="headingSolution3" data-bs-parent="#accordionSolution3">
<div class="accordion-body">
<p>Just using a single core is the cheapest in terms of resources costs
and is the most efficient (and always will be unless your speedup is
better than perfect – “super-linear” speedup).</p>
<p>However, it may not be possible to run on small numbers of cores
depending on how much memory you need or other technical constraints,
and will often be slow!</p>
<p><strong>Note:</strong> On most high-end systems, nodes are not shared
between users. This means you are charged for <strong>all</strong> the
CPU-cores on a node regardless of whether you actually use them.
Typically we would be running on many hundreds of CPU-cores not a few
tens, so the real question in practice is: <em>what is the optimal
number of nodes to use?</em></p>
</div>
</div>
</div>
</div>
</div>
<div class="section level4">
<h4 id="what-is-the-core-count-where-you-get-the-fastest-solution-irrespective-of-efficiency">What is the core count where you get the fastest solution,
irrespective of efficiency?<a class="anchor" aria-label="anchor" href="#what-is-the-core-count-where-you-get-the-fastest-solution-irrespective-of-efficiency"></a>
</h4>
<div id="accordionSolution4" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution4" aria-expanded="false" aria-controls="collapseSolution4">
  <h4 class="accordion-header" id="headingSolution4"> Show me the solution </h4>
</button>
<div id="collapseSolution4" class="accordion-collapse collapse" aria-labelledby="headingSolution4" data-bs-parent="#accordionSolution4">
<div class="accordion-body">
<p>128 cores gives the fastest time to solution.</p>
<p>The fastest time to solution does not often make the most efficient
use of resources so to use this option, you may end up wasting your
resources. Occasionally, when there is time pressure to run the
calculations, this may be a valid approach to running applications.</p>
</div>
</div>
</div>
</div>
</div>
<div class="section level4">
<h4 id="what-do-you-think-a-good-core-count-choice-would-be-for-this-application-to-use">What do you think a good core count choice would be for this
application to use?<a class="anchor" aria-label="anchor" href="#what-do-you-think-a-good-core-count-choice-would-be-for-this-application-to-use"></a>
</h4>
<div id="accordionSolution5" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution5" aria-expanded="false" aria-controls="collapseSolution5">
  <h4 class="accordion-header" id="headingSolution5"> Show me the solution </h4>
</button>
<div id="collapseSolution5" class="accordion-collapse collapse" aria-labelledby="headingSolution5" data-bs-parent="#accordionSolution5">
<div class="accordion-body">
<p>8 cores is probably a good number of cores to use with a parallel
efficiency of 86%.</p>
<p>Usually, the best choice is one that delivers good parallel
efficiency with an acceptable time to solution.</p>
<p>Note that <em>acceptable time to solution</em> differs depending on
circumstances so this is something that the individual researcher will
have to assess.</p>
<p>Good parallel efficiency is often considered to be 70% or greater
though many researchers will be happy to run in a regime with parallel
efficiency greater than 60%. As noted above, running with worse parallel
efficiency may also be useful if the time to solution is an overriding
factor.</p>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</section><section><h2 class="section-heading" id="tips">Tips<a class="anchor" aria-label="anchor" href="#tips"></a>
</h2>
<hr class="half-width">
<p>Here are a few tips to help you use resources effectively and
efficiently on HPC systems:</p>
<ul>
<li>Know what your priority is: do you want the results as fast as
possible or are you happy to wait longer but get more research for the
resources you have been allocated?</li>
<li>Use your real research application to benchmark but try to shorten
the run so you can turn around your benchmarking runs in a short
timescale. Ideally, it should run for 10-30 minutes; short enough to run
quickly but long enough so the performance is not dominated by static
startup overheads (though this is application dependent). Ways to do
this potentially include, for example: using a smaller number of time
steps, restricting the number of SCF cycles, restricting the number of
optimisation steps.</li>
<li>Use basic benchmarking to help define the best resource use for your
application. One useful strategy: take the core count you are using as
the baseline, halve the number of cores/nodes and rerun and then double
the number of cores/nodes from your baseline and rerun. Use the three
data points to assess your efficiency and the impact of different
core/node counts.</li>
</ul>
<div id="keypoints1" class="callout keypoints">
<div class="callout-square">
<i class="callout-icon" data-feather="key"></i>
</div>
<span class="callout-header">Key Points</span>
<div class="callout-inner">
<div class="callout-content">
<ul>
<li>Benchmarking is an essential practice for understanding your
workload and using resources efficiently</li>
<li>Efficient usage is not just about getting the time-to-solution as
low as possible</li>
</ul>
</div>
</div>
</div>
<!--
Place links that you need to refer to multiple times across pages here. Delete
any links that you are not going to use.

use like [gitbash][gitbash]
 -->
</section></section><section id="aio-18-responsibility"><p>Content from <a href="18-responsibility.html">Using shared resources responsibly</a></p>
<hr>
<p>Last updated on 2025-10-13 |

        <a href="https://github.com/EPCCed/2025-10-14-archer2-intro-hpc/edit/main/episodes/18-responsibility.Rmd" class="external-link">Edit this page <i aria-hidden="true" data-feather="edit"></i></a></p>
<div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right" data-expand="Expand All Solutions " data-collapse="Collapse All Solutions "> Expand All Solutions <i aria-hidden="true" data-feather="plus"></i></button>
        </div>
<div class="overview card">
<h2 class="card-header">Overview</h2>
<div class="row g-0">
<div class="col-md-4">
<div class="card-body">
<div class="inner">
<h3 class="card-title">Questions</h3>
<ul>
<li>How can I be a responsible user?</li>
<li>How can I protect my data?</li>
<li>How can I best get large amounts of data off an HPC system?</li>
</ul>
</div>
</div>
</div>
<div class="col-md-8">
<div class="card-body">
<div class="inner bordered">
<h3 class="card-title">Objectives</h3>
<ul>
<li>Learn how to be a considerate shared system citizen.</li>
<li>Understand how to protect your critical data.</li>
<li>Appreciate the challenges with transferring large amounts of data
off HPC systems.</li>
<li>Understand how to convert many files to a single archive file using
tar.</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<p>One of the major differences between using remote HPC resources and
your own system (e.g. your laptop) is that remote resources are shared.
How many users the resource is shared between at any one time varies
from system to system but it is unlikely you will ever be the only user
logged into or using such a system.</p>
<p>The widespread usage of scheduling systems where users submit jobs on
HPC resources is a natural outcome of the shared nature of these
resources. There are other things you, as an upstanding member of the
community, need to consider.</p>
<section><h2 class="section-heading" id="be-kind-to-the-login-nodes">Be Kind to the Login Nodes<a class="anchor" aria-label="anchor" href="#be-kind-to-the-login-nodes"></a>
</h2>
<hr class="half-width">
<p>The login node is often busy managing all of the logged in users,
creating and editing files and compiling software. If the machine runs
out of memory or processing capacity, it will become very slow and
unusable for everyone. While the machine is meant to be used, be sure to
do so responsibly — in ways that will not adversely impact other users’
experience.</p>
<p>Login nodes are used to launch jobs. Cluster policies vary, but they
may also be used for figuring out workflows, and in some cases, may host
advanced cluster-specific debugging or development tools. The cluster
may have modules that need to be loaded, possibly in a certain order,
and paths or library versions that differ from your laptop, and doing an
interactive test run on the head node is a quick and reliable way to
discover and fix these issues.</p>
<div id="login-nodes-are-a-shared-resource" class="callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<span class="callout-header">Callout</span>
<div id="login-nodes-are-a-shared-resource" class="callout-inner">
<h3 class="callout-title">Login Nodes Are a Shared Resource</h3>
<div class="callout-content">
<p>Remember, the login node is shared with all other users and your
actions could cause issues for other people. Think carefully about the
potential implications of issuing commands that may use large amounts of
resource.</p>
<p>Unsure? Ask your friendly systems administrator (“sysadmin”) or
service desk if the thing you’re contemplating is suitable for the login
node, or if there’s another mechanism to get it done safely.</p>
<p>You can contact the ARCHER2 Service Desk at <a href="mailto:support@archer2.ac.uk">support@archer2.ac.uk</a></p>
</div>
</div>
</div>
<p>You can always use the commands <code>top</code> to list the
processes that are running on the login node along with the amount of
CPU and memory they are using. If this check reveals that the login node
is somewhat idle, you can safely use it for your non-routine processing
task. If something goes wrong — the process takes too long, or doesn’t
respond — you can use the <code>kill</code> command along with the
<em>PID</em> to terminate the process.</p>
<div id="login-node-etiquette" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<span class="callout-header">Challenge</span>
<div id="login-node-etiquette" class="callout-inner">
<h3 class="callout-title">Login Node Etiquette</h3>
<div class="callout-content">
<p>Which of these commands would be a routine task to run on the login
node?</p>
<ol style="list-style-type: decimal">
<li><code>python physics_sim.py</code></li>
<li><code>make</code></li>
<li><code>create_directories.sh</code></li>
<li><code>molecular_dynamics_2</code></li>
<li><code>tar -xzf R-3.3.0.tar.gz</code></li>
</ol>
</div>
</div>
</div>
<div id="accordionSolution1" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution1" aria-expanded="false" aria-controls="collapseSolution1">
  <h4 class="accordion-header" id="headingSolution1"> Show me the solution </h4>
</button>
<div id="collapseSolution1" class="accordion-collapse collapse" aria-labelledby="headingSolution1" data-bs-parent="#accordionSolution1">
<div class="accordion-body">
<p>Building software, creating directories, and unpacking software are
common and acceptable tasks for the login node: options #2
(<code>make</code>), #3 (<code>mkdir</code>), and #5 (<code>tar</code>)
are probably OK. Note that script names do not always reflect their
contents: before launching #3, please
<code>less create_directories.sh</code> and make sure it’s not a Trojan
horse. Running resource-intensive applications is frowned upon. Unless
you are sure it will not affect other users, do not run jobs like #1
(<code>python</code>) or #4 (custom MD code). If you’re unsure, ask your
friendly sysadmin for advice.</p>
</div>
</div>
</div>
</div>
<p>If you experience performance issues with a login node you should
report it to the system staff (usually via the helpdesk) for them to
investigate.</p>
</section><section><h2 class="section-heading" id="test-before-scaling">Test Before Scaling<a class="anchor" aria-label="anchor" href="#test-before-scaling"></a>
</h2>
<hr class="half-width">
<p>Remember that you are generally charged for usage on shared systems.
A simple mistake in a job script can end up costing a large amount of
resource budget. Imagine a job script with a mistake that makes it sit
doing nothing for 24 hours on 1000 cores or one where you have requested
2000 cores by mistake and only use 100 of them!</p>
<p>This problem can be compounded when people write scripts that
automate job submission (for example, when running the same calculation
or analysis over lots of different parameters or files). When this
happens it hurts both you (as you waste lots of charged resource) and
other users (who are blocked from accessing the idle compute nodes).</p>
<p>On very busy resources you may wait many days in a queue for your job
to fail within 10 seconds of starting due to a trivial typo in the job
script. This is extremely frustrating! Most systems provide dedicated
resources for testing that have short wait times to help you avoid this
issue.</p>
<div id="test-job-submission-scripts-that-use-large-amounts-of-resources" class="callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<span class="callout-header">Callout</span>
<div id="test-job-submission-scripts-that-use-large-amounts-of-resources" class="callout-inner">
<h3 class="callout-title">Test Job Submission Scripts That Use Large
Amounts of Resources</h3>
<div class="callout-content">
<p>Before submitting a large run of jobs, submit one as a test first to
make sure everything works as expected.</p>
<p>Before submitting a very large or very long job submit a short
truncated test to ensure that the job starts as expected.</p>
</div>
</div>
</div>
</section><section><h2 class="section-heading" id="have-a-backup-plan">Have a Backup Plan<a class="anchor" aria-label="anchor" href="#have-a-backup-plan"></a>
</h2>
<hr class="half-width">
<p>Although many HPC systems keep backups, it does not always cover all
the file systems available and may only be for disaster recovery
purposes (<em>i.e.</em> for restoring the whole file system if lost
rather than an individual file or directory you have deleted by
mistake). Protecting critical data from corruption or deletion is
primarily your responsibility: keep your own backup copies.</p>
<p>Version control systems (such as Git) often have free, cloud-based
offerings (e.g., GitHub and GitLab) that are generally used for storing
source code. Even if you are not writing your own programs, these can be
very useful for storing job scripts, analysis scripts and small input
files.</p>
<p>For larger amounts of data, you should make sure you have a robust
system in place for taking copies of critical data off the HPC system
wherever possible to backed-up storage. Tools such as <code>rsync</code>
can be very useful for this.</p>
<p>Your access to the shared HPC system will generally be time-limited
so you should ensure you have a plan for transferring your data off the
system before your access finishes. The time required to transfer large
amounts of data should not be underestimated and you should ensure you
have planned for this early enough (ideally, before you even start using
the system for your research).</p>
<p>In all these cases, the service desk of the system you are using
should be able to provide useful guidance on your options for data
transfer for the volumes of data you will be using.</p>
<div id="your-data-is-your-responsibility" class="callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<span class="callout-header">Callout</span>
<div id="your-data-is-your-responsibility" class="callout-inner">
<h3 class="callout-title">Your Data Is Your Responsibility</h3>
<div class="callout-content">
<p>Make sure you understand what the backup policy is on the file
systems on the system you are using and what implications this has for
your work if you lose your data on the system. Plan your backups of
critical data and how you will transfer data off the system throughout
the project.</p>
<p>On ARCHER2, the home file systems are backed up so you can restore
data you deleted by mistake. A copy of the data on home file system is
also kept off site for disaster recovery purposes. The work file systems
<strong>are not backed up in any way.</strong></p>
</div>
</div>
</div>
</section><section><h2 class="section-heading" id="transferring-data">Transferring Data<a class="anchor" aria-label="anchor" href="#transferring-data"></a>
</h2>
<hr class="half-width">
<p>As mentioned earlier, many users run into the challenge of
transferring large amounts of data off HPC systems at some point (this
is more often in transferring data off than onto systems but the advice
below applies in either case).</p>
<p>Data transfer speed may be limited by many different factors so the
best data transfer mechanism to use depends on the type of data being
transferred and where the data is going. The components between your
data’s source and destination have varying levels of performance, and in
particular, may have different capabilities with respect to
<strong>bandwidth</strong> and <strong>latency</strong>.</p>
<ul>
<li>
<strong>Bandwidth</strong> is generally the raw amount of data per
unit time a device is capable of transmitting or receiving. It’s a
common and generally well-understood metric.</li>
<li>
<strong>Latency</strong> is a bit more subtle. For data transfers,
it may be thought of as the amount of time it takes to get data out of
storage and into a transmittable form. Latency issues are the reason
it’s advisable to execute data transfers by moving a small number of
large files, rather than the converse.</li>
</ul>
<p>Some of the key components and their associated issues are:</p>
<ul>
<li>
<strong>Disk speed</strong>: File systems on HPC systems are often
highly parallel, consisting of a very large number of high performance
disk drives. This allows them to support a very high data bandwidth.
Unless the remote system has a similar parallel file system you may find
your transfer speed limited by disk performance at that end.</li>
<li>
<strong>Meta-data performance</strong>: <em>Meta-data
operations</em> such as opening and closing files or listing the owner
or size of a file are much less parallel than read/write operations. If
your data consists of a very large number of small files you may find
your transfer speed is limited by meta-data operations. Meta-data
operations performed by other users of the system can also interact
strongly with those you perform so reducing the number of such
operations you use (by combining multiple files into a single file) may
reduce variability in your transfer rates and increase transfer
speeds.</li>
<li>
<strong>Network speed</strong>: Data transfer performance can be
limited by network speed. More importantly it is limited by the slowest
section of the network between source and destination. If you are
transferring to your laptop/workstation, this is likely to be its
connection (either via LAN or WiFi).</li>
<li>
<strong>Firewall speed</strong>: Most modern networks are protected
by some form of firewall that filters out malicious traffic. This
filtering has some overhead and can result in a reduction in data
transfer performance. The needs of a general purpose network that hosts
email/web-servers and desktop machines are quite different from a
research network that needs to support high volume data transfers. If
you are trying to transfer data to or from a host on a general purpose
network you may find the firewall for that network will limit the
transfer rate you can achieve.</li>
</ul>
<p>As discussed in a previous episode, if you have related data that
consists of a large number of small files it is strongly recommended to
pack the files into a larger <em>archive</em> file for long term storage
and transfer. A single large file makes more efficient use of the file
system and is easier to move, copy and transfer because significantly
fewer metadata operations are required.</p>
<p>Archive files can be created using tools like <code>tar</code> and
<code>zip</code>. We have already met <code>tar</code> when we talked
about data transfer earlier.</p>
<div id="consider-the-best-way-to-transfer-data" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<span class="callout-header">Challenge</span>
<div id="consider-the-best-way-to-transfer-data" class="callout-inner">
<h3 class="callout-title">Consider the Best Way to Transfer Data</h3>
<div class="callout-content">
<p>If you are transferring large amounts of data you will need to think
about what may affect your transfer performance. It is always useful to
run some tests that you can use to extrapolate how long it will take to
transfer your data. Say you have a “data” folder containing 10,000 or so
files, a healthy mix of small and large ASCII and binary data. Which of
the following would be the best way to transfer them to ARCHER2?</p>
<ol style="list-style-type: decimal">
<li>Using <code>scp</code>?</li>
</ol>
<div class="codewrapper sourceCode" id="cb1">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a><span class="ex">[user@laptop</span> ~]$ scp <span class="at">-r</span> data userid@login.archer2.ac.uk:~/</span></code></pre>
</div>
<ol start="2" style="list-style-type: decimal">
<li>Using <code>rsync</code>?</li>
</ol>
<div class="codewrapper sourceCode" id="cb2">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb2-1"><a href="#cb2-1" tabindex="-1"></a><span class="ex">[user@laptop</span> ~]$ rsync <span class="at">-ra</span> data userid@login.archer2.ac.uk:~/</span></code></pre>
</div>
<ol start="3" style="list-style-type: decimal">
<li>Using <code>rsync</code> with compression?</li>
</ol>
<div class="codewrapper sourceCode" id="cb3">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb3-1"><a href="#cb3-1" tabindex="-1"></a><span class="ex">[user@laptop</span> ~]$ rsync <span class="at">-raz</span> data userid@login.archer2.ac.uk:~/</span></code></pre>
</div>
<ol start="4" style="list-style-type: decimal">
<li>Creating a <code>tar</code> archive first for
<code>rsync</code>?</li>
</ol>
<div class="codewrapper sourceCode" id="cb4">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb4-1"><a href="#cb4-1" tabindex="-1"></a><span class="ex">[user@laptop</span> ~]$ tar <span class="at">-cvf</span> data.tar data</span>
<span id="cb4-2"><a href="#cb4-2" tabindex="-1"></a><span class="ex">[user@laptop</span> ~]$ rsync <span class="at">-raz</span> data.tar userid@login.archer2.ac.uk:~/</span></code></pre>
</div>
<ol start="5" style="list-style-type: decimal">
<li>Creating a compressed <code>tar</code> archive for
<code>rsync</code>?</li>
</ol>
<div class="codewrapper sourceCode" id="cb5">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb5-1"><a href="#cb5-1" tabindex="-1"></a><span class="ex">[user@laptop</span> ~]$ tar <span class="at">-cvzf</span> data.tar.gz data</span>
<span id="cb5-2"><a href="#cb5-2" tabindex="-1"></a><span class="ex">[user@laptop</span> ~]$ rsync <span class="at">-ra</span> data.tar.gz userid@login.archer2.ac.uk:~/</span></code></pre>
</div>
</div>
</div>
</div>
<div id="accordionSolution2" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution2" aria-expanded="false" aria-controls="collapseSolution2">
  <h4 class="accordion-header" id="headingSolution2"> Show me the solution </h4>
</button>
<div id="collapseSolution2" class="accordion-collapse collapse" aria-labelledby="headingSolution2" data-bs-parent="#accordionSolution2">
<div class="accordion-body">
<p>Lets go through each option</p>
<ol style="list-style-type: decimal">
<li>
<code>scp</code> will recursively copy the directory. This works,
but without compression.</li>
<li>
<code>rsync -ra</code> works like <code>scp -r</code>, but preserves
file information like creation times. This is marginally better.</li>
<li>
<code>rsync -raz</code> adds compression, which will save some
bandwidth. If you have a strong CPU at both ends of the line, and you’re
on a slow network, this is a good choice.</li>
<li>This command first uses <code>tar</code> to merge everything into a
single file, then <code>rsync -z</code> to transfer it with compression.
With this large <em>number</em> of files, metadata overhead can hamper
your transfer, so this is a good idea.</li>
<li>This command uses <code>tar -z</code> to compress the archive, then
<code>rsync</code> to transfer it. This may perform similarly to #4, but
in most cases (for large datasets), it’s the best combination of high
throughput and low latency (making the most of your time and network
connection).</li>
</ol>
</div>
</div>
</div>
</div>
<div id="keypoints1" class="callout keypoints">
<div class="callout-square">
<i class="callout-icon" data-feather="key"></i>
</div>
<span class="callout-header">Key Points</span>
<div class="callout-inner">
<div class="callout-content">
<ul>
<li>Login nodes are a shared resource - be a good citizen!</li>
<li>Your data on the system is your responsibility.</li>
<li>Plan and test your large-scale work to prevent inefficient use of
resources</li>
<li>It is often best to convert many files to a single archive file
before transferring.</li>
<li>Again, don’t run stuff on the login node.</li>
</ul>
</div>
</div>
</div>
<!--
Place links that you need to refer to multiple times across pages here. Delete
any links that you are not going to use.

use like [gitbash][gitbash]
 -->
</section></section>
</div>
    </main>
</div>
<!-- END  : inst/pkgdown/templates/content-extra.html -->

      </div>
<!--/div.row-->
      		<footer class="row footer mx-md-3"><hr>
<div class="col-md-6">
        <p>This lesson is subject to the <a href="CODE_OF_CONDUCT.html">Code of Conduct</a></p>
        <p>

        <a href="https://github.com/EPCCed/2025-10-14-archer2-intro-hpc/edit/main/README.md" class="external-link">Edit on GitHub</a>

	
        | <a href="https://github.com/EPCCed/2025-10-14-archer2-intro-hpc/blob/main/CONTRIBUTING.md" class="external-link">Contributing</a>
        | <a href="https://github.com/EPCCed/2025-10-14-archer2-intro-hpc/" class="external-link">Source</a></p>
				<p><a href="https://github.com/EPCCed/2025-10-14-archer2-intro-hpc/blob/main/CITATION.cff" class="external-link">Cite</a> | <a href="mailto:support@archer2.ac.uk">Contact</a> | <a href="https://carpentries.org/about/" class="external-link">About</a></p>
			</div>
			<div class="col-md-6">

        <p>Materials licensed under <a href="LICENSE.html">CC-BY 4.0</a> by the authors</p>

        <p>Template licensed under <a href="https://creativecommons.org/licenses/by-sa/4.0/" class="external-link">CC-BY 4.0</a> by <a href="https://carpentries.org/" class="external-link">The Carpentries</a></p>
        <p>Built with <a href="https://github.com/carpentries/sandpaper/tree/0.17.1" class="external-link">sandpaper (0.17.1)</a>, <a href="https://github.com/carpentries/pegboard/tree/0.7.9" class="external-link">pegboard (0.7.9)</a>, and <a href="https://github.com/carpentries/varnish/tree/1.0.7" class="external-link">varnish (1.0.7)</a></p>
			</div>
		</footer>
</div> <!-- / div.container -->
	<div id="to-top">
		<a href="#top">
      <i class="search-icon" data-feather="arrow-up" role="img" aria-label="Back To Top"></i><br><!-- <span class="d-none d-sm-none d-md-none d-lg-none d-xl-block">Back</span> To Top --><span class="d-none d-sm-none d-md-none d-lg-none d-xl-block">Back</span> To Top
		</a>
	</div>
  <script type="application/ld+json">
    {
  "@context": "https://schema.org",
  "@type": "LearningResource",
  "@id": "https://EPCCed.github.io/2025-10-14-archer2-intro-hpc/aio.html",
  "inLanguage": "en",
  "dct:conformsTo": "https://bioschemas.org/profiles/LearningResource/1.0-RELEASE",
  "description": "A Carpentries Lesson teaching foundational data and coding skills to researchers worldwide",
  "keywords": "software, data, lesson, The Carpentries, HPC, EPCC",
  "name": "All in One View",
  "creativeWorkStatus": "active",
  "url": "https://EPCCed.github.io/2025-10-14-archer2-intro-hpc/aio.html",
  "identifier": "https://EPCCed.github.io/2025-10-14-archer2-intro-hpc/aio.html",
  "dateCreated": "2025-10-14",
  "dateModified": "2025-10-13",
  "datePublished": "2025-10-13"
}

  </script><script>
		feather.replace();
	</script>
</body>
</html><!-- END:   inst/pkgdown/templates/layout.html-->

